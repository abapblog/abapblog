{"id":1483,"date":"2013-04-08T18:40:10","date_gmt":"2013-04-08T14:40:10","guid":{"rendered":"http:\/\/abap-blog.ru\/?p=1483"},"modified":"2021-03-02T10:04:57","modified_gmt":"2021-03-02T06:04:57","slug":"adbc-abap-database-connectivity","status":"publish","type":"post","link":"https:\/\/abap-blog.ru\/database-work\/adbc-abap-database-connectivity\/","title":{"rendered":"ADBC &#8212; ABAP Database Connectivity"},"content":{"rendered":"<p>ADBC \u2013 \u043e\u0431\u044a\u0435\u043a\u0442\u043d\u043e-\u043e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 API, \u0434\u043b\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u043c \u043d\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e SQL \u0432 ABAP. \u041c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d \u0432 \u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043a\u043e\u0433\u0434\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043d\u0430\u0442\u0438\u0432\u043d\u043e\u043c\u0443 SQL, \u0442.\u043a. \u0432\u044b\u0437\u043e\u0432 \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043c\u0430\u043d\u0434\u044b EXEC SQL \u043d\u0435 \u043f\u043e\u0434\u0440\u0430\u0437\u0443\u043c\u0435\u0432\u0430\u0435\u0442 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438.<\/p>\n<p>\u041a\u043b\u0430\u0441\u0441\u044b, \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0435 ADBC \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0442\u0441\u044f \u0441 CL_SQL_* \u0438 CX_SQL_* (\u043f\u0430\u043a\u0435\u0442 SDB_ADBC). \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0438\u0437 \u043d\u0438\u0445:<\/p>\n<p><!--more--><\/p>\n<ul>\n<li>CL_SQL_STATEMENT \u2013 \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f SQL \u043a\u043e\u043c\u0430\u043d\u0434<\/li>\n<li>CL_SQL_PREPARED_STATEMENT \u2013 \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0437\u0430\u0440\u0430\u043d\u0435\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 SQL \u043a\u043e\u043c\u0430\u043d\u0434, \u0441 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c\u044e \u043f\u043e\u0434\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432<\/li>\n<li>CL_SQL_CONNECTION\u00a0\u00a0&#8212; \u0434\u043b\u044f \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f\u043c\u0438 \u043a \u0411\u0414<\/li>\n<li>CX_SQL_EXCEPTION\u00a0\u2013 \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u043a\u043b\u0430\u0441\u0441 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439<\/li>\n<\/ul>\n<p>ADBC \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043c\u0430\u043d\u0434\u0430\u043d\u0442\u043e\u0432 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0442\u0435\u043a\u0443\u0449\u0435\u0439 \u0441\u0435\u0441\u0441\u0438\u0438, \u043f\u043e\u043b\u0435 \u043c\u0430\u043d\u0434\u0430\u043d\u0442 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u044f\u0432\u043d\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043e (sy-mandt).\u00a0 \u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u043f\u043e\u0437\u0430\u0431\u043e\u0442\u0438\u0442\u044c\u0441\u044f \u043e \u0442\u043e\u043c, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u043e \u0434\u0430\u043d\u043d\u044b\u0435 \u0438\u0437 \u0434\u0440\u0443\u0433\u0438\u0445 \u043c\u0430\u043d\u0434\u0430\u043d\u0442\u043e\u0432.<\/p>\n<h3>\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 SQL \u043a\u043e\u043c\u0430\u043d\u0434 \u0447\u0435\u0440\u0435\u0437 CL_SQL_STATEMENT<\/h3>\n<p>\u041a\u043b\u0430\u0441\u0441 CL_SQL_STATEMENT \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043c\u0435\u0442\u043e\u0434\u044b \u0443\u0440\u043e\u0432\u043d\u044f \u0438\u043d\u0441\u0442\u0430\u043d\u0446\u0438\u0438 \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u0438 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0439.<\/p>\n<p>\u0418\u043d\u0441\u0442\u0430\u043d\u0446\u0438\u044e \u043a\u043b\u0430\u0441\u0441\u0430 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 CREATE OBJECT, \u043f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0432 \u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u043e\u0431\u044a\u0435\u043a\u0442 \u043a\u043b\u0430\u0441\u0441\u0430 CL_SQL_CONNECTION, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442\u0441\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u043a \u0411\u0414. \u0415\u0441\u043b\u0438 \u043d\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0441\u0442\u0430\u043d\u0434\u0430\u0440\u0442\u043d\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a \u0411\u0414 (\u0441\u043c. \u0442\u0440. DBACOCKPIT).<\/p>\n<p><b>DDL \u0438 <\/b><b>DML \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f<\/b><\/p>\n<p>\u041a\u043b\u0430\u0441\u0441 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u044b \u0434\u043b\u044f \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f DDL (\u044f\u0437\u044b\u043a \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u0445) \u0438 DML (\u044f\u0437\u044b\u043a \u043c\u0430\u043d\u0438\u043f\u0443\u043b\u044f\u0446\u0438\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438) \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0439:<\/p>\n<ul>\n<li>EXECUTE_DDL \u2013 \u0434\u043b\u044f \u0442\u0430\u043a\u0438\u0445 \u043a\u043e\u043c\u0430\u043d\u0434 \u043a\u0430\u043a: CREATE, DROP \u0438\u043b\u0438 ALTER.<\/li>\n<li>EXECUTE_UPDATE \u2013 \u0434\u043b\u044f \u0442\u0430\u043a\u0438\u0445 \u043a\u043e\u043c\u0430\u043d\u0434 \u043a\u0430\u043a: INSERT, UPDATE \u0438\u043b\u0438 DELETE.<\/li>\n<\/ul>\n<p>\u041e\u0431\u0430 \u043c\u0435\u0442\u043e\u0434\u0430 \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u2013 STATEMENT \u0442\u0438\u043f\u0430 string. \u0414\u0430\u043d\u043d\u044b\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0447\u0435\u0441\u043a\u0438 \u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u043e\u0435 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0435. \u041c\u0435\u0442\u043e\u0434 EXECUTE_UPDATE \u0442\u0430\u043a \u0436\u0435 \u0438\u043c\u0435\u0435\u0442 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u043c\u044b\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 ROWS_PROCESSED, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0437\u0430\u043f\u043e\u043b\u043d\u044f\u0435\u0442\u0441\u044f \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0442\u0440\u043e\u043a \u0442\u0430\u0431\u043b\u0438\u0446\u044b, \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u043d\u044b\u0445 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0435\u043c.<\/p>\n<p>\u0412 DML \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f, \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0435 \u0432 \u0431\u0430\u0437\u0443 \u0434\u0430\u043d\u043d\u044b\u0445, \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d\u044b, \u0434\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u043c \u00ab?\u00bb. \u0414\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0447\u0442\u043e\u0431\u044b \u0432\u0441\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0431\u044b\u043b\u0438 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u044b, \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u043c\u0435\u0442\u043e\u0434 SET_PARAM, \u0441 \u0443\u043a\u0430\u0437\u0430\u043d\u0438\u0435\u043c \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u043f\u0435\u0440\u0435\u043c\u0435\u043d\u043d\u0443\u044e. \u041f\u0440\u0438 \u044d\u0442\u043e\u043c \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043f\u043e\u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e, \u0441\u043b\u0435\u0432\u0430 \u043d\u0430\u043f\u0440\u0430\u0432\u043e \u0432 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0438. \u041f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f, \u0432\u0441\u0435 \u043f\u0440\u0438\u0441\u0432\u043e\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 \u0442\u0435\u0440\u044f\u044e\u0442\u0441\u044f.<\/p>\n<p>\u0421\u043b\u0435\u0434\u0443\u0435\u0442 \u0437\u043d\u0430\u0442\u044c, \u0447\u0442\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 DDL \u0434\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0442\u0430\u0431\u043b\u0438\u0446 (\u0432\u043c\u0435\u0441\u0442\u043e SE11) \u043a\u0440\u0430\u0439\u043d\u0435 \u043d\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u0435\u0442\u0441\u044f, \u0442.\u043a. \u043a\u0440\u043e\u043c\u0435 \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0445 \u0442\u0430\u0431\u043b\u0438\u0446 \u0432 \u0411\u0414, SAP \u0441\u043e\u0437\u0434\u0430\u0435\u0442 \u0437\u0430\u043f\u0438\u0441\u0438 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0430\u0445 \u0441 \u043c\u0435\u0442\u0430\u0434\u0430\u043d\u043d\u044b\u043c\u0438 (DD02L, DD03L \u0438 \u0434\u0440.), \u0438\u0437-\u0437\u0430 \u0447\u0435\u0433\u043e \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u043c \u0442\u0430\u043a\u0438\u043c \u0441\u043f\u043e\u0441\u043e\u0431\u043e\u043c \u0442\u0430\u0431\u043b\u0438\u0446\u0430\u043c \u0431\u0443\u0434\u0435\u0442 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d. \u0414\u043b\u044f \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0442\u0430\u0431\u043b\u0438\u0446 \u043b\u0443\u0447\u0448\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0424\u041c: DD_CREATE_TABLE.<\/p>\n<p><b>\u0417\u0430\u043f\u0440\u043e\u0441\u044b<\/b><\/p>\n<p>\u0421 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u043c\u0435\u0442\u043e\u0434\u0430 EXECUTE_QUERY \u043c\u043e\u0436\u043d\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0437\u0430\u043f\u0440\u043e\u0441 \u043a \u0411\u0414. \u0422\u0430\u043a \u0436\u0435 \u043a\u0430\u043a \u0438 \u043f\u0440\u0435\u0434\u044b\u0434\u0443\u0449\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u044b, \u043e\u043d \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 STATEMENT, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d \u0441\u0438\u043d\u0442\u0430\u043a\u0441\u0438\u0447\u0435\u0441\u043a\u0438 \u0432\u0435\u0440\u043d\u044b\u043c SELECT \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0435\u043c. \u041c\u043e\u0436\u043d\u043e, \u043a\u0430\u043a \u0438 \u0434\u043b\u044f \u0432\u044b\u0448\u0435\u043e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0442\u043e\u0434\u043e\u0432, \u0437\u0430\u0434\u0430\u0432\u0430\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043c\u0435\u0442\u043e\u0434 SET_PARAM.<\/p>\n<p>\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430, \u043c\u0435\u0442\u043e\u0434 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 RESULT_SET, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0441\u0441\u044b\u043b\u043a\u043e\u0439 \u043d\u0430 \u043a\u043b\u0430\u0441\u0441 CL_SQL_RESULT_SET. \u041c\u0435\u0442\u043e\u0434\u044b \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430\u043c SQL \u0437\u0430\u043f\u0440\u043e\u0441\u0430.<\/p>\n<p>\u0414\u043b\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0441\u043b\u0443\u0436\u0430\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u044b \u043a\u043b\u0430\u0441\u0441\u0430 CL_SQL_RESULT_SET:<\/p>\n<ul>\n<li>SET_PARAM, NEXT, \u0438 CLOSE. \u0414\u0430\u043d\u043d\u044b\u0435 \u043c\u0435\u0442\u043e\u0434\u044b \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0438\u0432\u0430\u044e\u0442 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0438\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u044b\u043c \u0441\u0442\u0440\u043e\u043a\u0430\u043c \u0438 \u043a\u043e\u043b\u043e\u043d\u043a\u0430\u043c \u0434\u0430\u043d\u043d\u044b\u0445 \u0438\u0437 \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430.\u00a0 \u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u0434\u043e\u0441\u0442\u0443\u043f \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u0441\u043b\u0435\u0432\u0430 \u043d\u0430 \u043f\u0440\u0430\u0432\u043e. \u041c\u0435\u0442\u043e\u0434 NEXT \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0438\u0442 \u043a \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0435\u0439 \u0441\u0442\u0440\u043e\u043a\u0435 \u043d\u0430\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445, \u0435\u0441\u043b\u0438 \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 1 \u2013 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u0441\u0447\u0438\u0442\u0430\u043d\u0430, 0 \u2013 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0441\u0442\u0440\u043e\u043a\u0430 \u043d\u0435 \u0441\u0447\u0438\u0442\u0430\u043d\u0430 (\u0434\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442 \u043a\u043e\u043d\u0435\u0446 \u043d\u0430\u0431\u043e\u0440\u0430 \u0434\u0430\u043d\u043d\u044b\u0445). \u0427\u0442\u0435\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0437\u0430\u043a\u0430\u043d\u0447\u0438\u0432\u0430\u0442\u044c\u0441\u044f \u0432\u044b\u0437\u043e\u0432\u043e\u043c \u043c\u0435\u0442\u043e\u0434\u0430 CLOSE.<\/li>\n<li>SET_PARAM_STRUCT, NEXT, \u0438 CLOSE. \u0414\u043e\u0441\u0442\u0443\u043f \u0430\u043d\u0430\u043b\u043e\u0433\u0438\u0447\u0435\u043d \u0432\u044b\u0448\u0435\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u043c\u0443 \u0441\u043f\u043e\u0441\u043e\u0431\u0443, \u043d\u043e \u0432\u043c\u0435\u0441\u0442\u043e \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043a \u0438\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u044b\u043c \u0441\u0442\u043e\u043b\u0431\u0446\u0430\u043c, \u043f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0446\u0435\u043b\u0438\u043a\u043e\u043c \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u0441\u0442\u0440\u043e\u043a\u0438.<\/li>\n<li>SET_PARAM_TABLE, NEXT_PACKAGE, \u0438 CLOSE. \u041c\u0435\u0442\u043e\u0434 NEXT_PACKAGE \u0441\u0447\u0438\u0442\u044b\u0432\u0430\u0435\u0442 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u043e\u0435 \u0432 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u0435 UPTO \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0435 \u0441\u0442\u0440\u043e\u043a \u0442\u0430\u0431\u043b\u0438\u0446\u044b. \u0415\u0441\u043b\u0438 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043d\u0435 \u0437\u0430\u0434\u0430\u043d, \u0441\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u0432\u0441\u0435 \u0441\u0442\u0440\u043e\u043a\u0438. \u041f\u0440\u0438 \u043a\u0430\u0436\u0434\u043e\u043c \u043d\u043e\u0432\u043e\u043c \u0432\u044b\u0437\u043e\u0432\u0435 \u044d\u0442\u043e\u0433\u043e \u043c\u0435\u0442\u043e\u0434\u0430, \u0432 \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u0443\u044e \u0442\u0430\u0431\u043b\u0438\u0446\u0443 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u043d\u043e\u0432\u044b\u0435 \u0437\u0430\u043f\u0438\u0441\u0438, \u0441\u0442\u0430\u0440\u044b\u0435 \u043d\u0435 \u0443\u0434\u0430\u043b\u044f\u044e\u0442\u0441\u044f.<\/li>\n<\/ul>\n<p><b>\u0425\u0440\u0430\u043d\u0438\u043c\u044b\u0435 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b<\/b><\/p>\n<p>\u0414\u043b\u044f \u0437\u0430\u043f\u0443\u0441\u043a\u0430 \u0445\u0440\u0430\u043d\u0438\u043c\u044b\u0445 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043c\u0435\u0442\u043e\u0434 EXECUTE_PROCEDURE. \u041c\u0435\u0442\u043e\u0434 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 PROC_NAME \u0442\u0438\u043f\u0430 string, \u0432 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u0442\u0441\u044f \u0438\u043c\u044f \u0445\u0440\u0430\u043d\u0438\u043c\u043e\u0439 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b. \u041a\u0430\u043a \u0438 \u0434\u043b\u044f \u0432\u044b\u0448\u0435\u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0445 \u043c\u0435\u0442\u043e\u0434\u043e\u0432, \u043c\u043e\u0436\u043d\u043e \u0437\u0430\u0434\u0430\u0432\u0430\u0442\u044c \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0431\u0443\u0434\u0443\u0442 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u044b \u0432 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u0443. \u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b, \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0435 \u0432 \u0425\u041f, \u043c\u043e\u0433\u0443\u0442 \u0438\u043c\u0435\u0442\u044c \u0440\u0430\u0437\u043d\u044b\u0435 \u0442\u0438\u043f\u044b \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f, \u0437\u0430\u0434\u0430\u0435\u0442\u0441\u044f \u0447\u0435\u0440\u0435\u0437 \u043d\u0435\u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043c\u0435\u0442\u043e\u0434\u0430 SET_PARAM \u2013 INOUT. \u0417\u043d\u0430\u0447\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u0430 \u0437\u0430\u043f\u043e\u043b\u043d\u044f\u044e\u0442\u0441\u044f \u043a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u0430\u043c\u0438 \u0438\u0437 \u043a\u043b\u0430\u0441\u0441\u0430 CL_SQL_STATEMENT: C_PARAM_IN (\u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e), C_PARAM_OUT, \u0438 C_PARAM_INOUT.<\/p>\n<p>\u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0434\u0430\u043d\u043d\u044b\u043c \u043a\u043b\u0430\u0441\u0441\u043e\u043c:<\/p>\n<pre class=\"lang:abap decode:true\">REPORT demo_adbc_ddl_dml_binding.\r\n\r\nPARAMETERS  p_name TYPE c LENGTH 10 DEFAULT 'mytab'.\r\nSELECTION-SCREEN SKIP.\r\nPARAMETERS: p_create RADIOBUTTON GROUP grp,\r\n            p_insert RADIOBUTTON GROUP grp,\r\n            p_select RADIOBUTTON GROUP grp,\r\n            p_drop   RADIOBUTTON GROUP grp.\r\nSELECTION-SCREEN SKIP.\r\nPARAMETERS  p_key TYPE i DEFAULT 1.\r\n\r\nCLASS adbc DEFINITION.\r\n  PUBLIC SECTION.\r\n    CLASS-METHODS main.\r\n  PRIVATE SECTION.\r\n    CLASS-DATA: dbname TYPE string,\r\n                sql TYPE REF TO cl_sql_statement,\r\n                wa1 TYPE c LENGTH 10,\r\n                wa2 TYPE c LENGTH 10,\r\n                err TYPE REF TO cx_sql_exception .\r\n    CLASS-METHODS: create RAISING cx_sql_exception,\r\n                   insert RAISING cx_sql_exception,\r\n                   select RAISING cx_sql_exception,\r\n                   drop   RAISING cx_sql_exception.\r\nENDCLASS.\r\n\r\nCLASS adbc IMPLEMENTATION.\r\n  METHOD main.\r\n    dbname = 'ABAP_DOCU_DEMO_' &amp;&amp; p_name.\r\n    TRY.\r\n        CREATE OBJECT sql.\r\n        IF p_create = 'X'.\r\n          create( ).\r\n          MESSAGE 'Create was successful' TYPE 'S'.\r\n        ELSEIF p_insert = 'X'.\r\n          insert( ).\r\n          MESSAGE 'Insert was successful' TYPE 'S'.\r\n        ELSEIF p_select = 'X'.\r\n          select( ).\r\n          MESSAGE 'Select was successful' TYPE 'S'.\r\n        ELSEIF p_drop   = 'X'.\r\n          drop( ).\r\n          MESSAGE 'Drop was successful' TYPE 'S'.\r\n        ENDIF.\r\n      CATCH cx_sql_exception INTO err.\r\n        MESSAGE err TYPE 'I' DISPLAY LIKE 'E'.\r\n    ENDTRY.\r\n  ENDMETHOD.\r\n  METHOD create.\r\n    sql-&gt;execute_ddl(\r\n      `CREATE TABLE ` &amp;&amp; dbname   &amp;&amp;\r\n      `( val1 char(10) NOT NULL,` &amp;&amp;\r\n      `  val2 char(10) NOT NULL,` &amp;&amp;\r\n      `  PRIMARY KEY (val1) )` ).\r\n  ENDMETHOD.\r\n  METHOD insert.\r\n    DATA dref TYPE REF TO data.\r\n    DO 100 TIMES.\r\n      GET REFERENCE OF wa1 INTO dref.\r\n      sql-&gt;set_param( dref ).\r\n      GET REFERENCE OF wa2 INTO dref.\r\n      sql-&gt;set_param( dref ).\r\n      wa1 = sy-index.\r\n      wa2 = sy-index ** 2.\r\n      sql-&gt;execute_update(\r\n       `INSERT INTO ` &amp;&amp; dbname &amp;&amp; ` VALUES (?,?)` ).\r\n    ENDDO.\r\n  ENDMETHOD.\r\n  METHOD select.\r\n    DATA: result TYPE REF TO cl_sql_result_set,\r\n          msg    TYPE c LENGTH 30,\r\n          key    TYPE c LENGTH 10,\r\n          dref   TYPE REF TO data,\r\n          rc     TYPE i.\r\n    key = p_key.\r\n    GET REFERENCE OF key INTO dref.\r\n    sql-&gt;set_param( dref ).\r\n    result = sql-&gt;execute_query(\r\n      `SELECT val1, val2 ` &amp;&amp;\r\n      `FROM ` &amp;&amp; dbname &amp;&amp; ` ` &amp;&amp;\r\n      `WHERE val1 = ?` ).\r\n    GET REFERENCE OF wa1 INTO dref.\r\n    result-&gt;set_param( dref ).\r\n    GET REFERENCE OF wa2 INTO dref.\r\n    result-&gt;set_param( dref ).\r\n    rc = result-&gt;next( ).\r\n    IF rc &gt; 0.\r\n      WRITE: 'Result:' TO msg,\r\n             wa1 TO msg+10,\r\n             wa2 TO msg+20.\r\n    ELSE.\r\n      msg = 'No entry found'.\r\n    ENDIF.\r\n    result-&gt;close( ).\r\n    MESSAGE msg TYPE 'I'.\r\n  ENDMETHOD.\r\n  METHOD drop.\r\n    sql-&gt;execute_ddl(\r\n     `DROP TABLE ` &amp;&amp; dbname ).\r\n  ENDMETHOD.\r\nENDCLASS.\r\n\r\nSTART-OF-SELECTION.\r\n  adbc=&gt;main( ).<\/pre>\n<p>\u041f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0430, \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u044e\u0449\u0430\u044f \u0437\u0430\u043f\u0440\u043e\u0441 \u0438 \u0441\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0449\u0430\u044f \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442 \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0443:<\/p>\n<pre class=\"lang:abap decode:true\">REPORT demo_adbc_query.\r\n\r\nPARAMETERS p_carrid TYPE sflight-carrid.\r\n\r\nCLASS demo DEFINITION.\r\n  PUBLIC SECTION.\r\n    CLASS-METHODS main.\r\n  PRIVATE SECTION.\r\n    CLASS-DATA: BEGIN OF result_line,\r\n                  carrid TYPE sflight-carrid,\r\n                  connid TYPE sflight-connid,\r\n                  fldate TYPE sflight-fldate,\r\n                END OF result_line,\r\n                result_tab LIKE TABLE OF result_line.\r\n    CLASS-METHODS display.\r\nENDCLASS.\r\n\r\nCLASS demo IMPLEMENTATION.\r\n  METHOD main.\r\n    DATA:  sql     TYPE REF TO cl_sql_statement,\r\n           result  TYPE REF TO cl_sql_result_set,\r\n           err     TYPE REF TO cx_sql_exception,\r\n           cols    TYPE adbc_column_tab,\r\n           dref    TYPE REF TO data.\r\n    APPEND 'CARRID' TO cols.\r\n    APPEND 'CONNID' TO cols.\r\n    APPEND 'FLDATE' TO cols.\r\n    CREATE OBJECT sql.\r\n    GET REFERENCE OF result_tab INTO dref.\r\n    TRY.\r\n        result = sql-&gt;execute_query(\r\n         `SELECT carrid, connid, fldate ` &amp;&amp;\r\n         `FROM sflight ` &amp;&amp;\r\n         `WHERE mandt  = ` &amp;&amp; `'` &amp;&amp; sy-mandt &amp;&amp; `' AND` &amp;&amp;\r\n         `      carrid = ` &amp;&amp; `'` &amp;&amp; p_carrid &amp;&amp; `'` ).\r\n        result-&gt;set_param_table( itab_ref = dref\r\n                                 corresponding_fields = cols ).\r\n        IF result-&gt;next_package( ) &gt; 0.\r\n          SORT result_tab BY carrid connid fldate.\r\n          display( ).\r\n        ENDIF.\r\n      CATCH cx_sql_exception INTO err.\r\n        MESSAGE err TYPE 'I' DISPLAY LIKE 'E'.\r\n    ENDTRY.\r\n  ENDMETHOD.\r\n  METHOD display.\r\n    DATA alv TYPE REF TO cl_salv_table.\r\n    DATA err TYPE REF TO cx_salv_msg.\r\n    TRY.\r\n        cl_salv_table=&gt;factory(\r\n          IMPORTING r_salv_table = alv\r\n          CHANGING  t_table      = result_tab ).\r\n        alv-&gt;display( ).\r\n      CATCH cx_salv_msg INTO err.\r\n        MESSAGE err TYPE 'I' DISPLAY LIKE 'E'.\r\n    ENDTRY.\r\n  ENDMETHOD.\r\nENDCLASS.\r\n\r\nSTART-OF-SELECTION.\r\n  demo=&gt;main( ).<\/pre>\n<p>\u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0445\u0440\u0430\u043d\u0438\u043c\u043e\u0439 \u043f\u0440\u043e\u0446\u0435\u0434\u0443\u0440\u044b:<\/p>\n<pre class=\"lang:abap decode:true\">REPORT demo_adbc_stored_procedure.\r\n\r\nSELECTION-SCREEN BEGIN OF SCREEN 100.\r\nPARAMETERS incprice TYPE sflight-price.\r\nSELECTION-SCREEN END OF SCREEN 100.\r\n\r\nCLASS demo DEFINITION.\r\n  PUBLIC SECTION.\r\n    CLASS-METHODS main.\r\n  PRIVATE SECTION.\r\n    CLASS-METHODS call_screen.\r\nENDCLASS.\r\n\r\nCLASS demo IMPLEMENTATION.\r\n  METHOD main.\r\n    DATA:  sql     TYPE REF TO cl_sql_statement,\r\n           err     TYPE REF TO cx_sql_exception,\r\n           dref    TYPE REF TO data.\r\n    call_screen( ).\r\n    CREATE OBJECT sql.\r\n    TRY.\r\n        sql-&gt;execute_ddl(\r\n          `CREATE OR REPLACE PROCEDURE increase_price (x IN NUMBER) IS `\r\n           &amp;&amp; `BEGIN `\r\n           &amp;&amp; `UPDATE sflight SET price = price + x`\r\n           &amp;&amp; `               WHERE mandt = '` &amp;&amp; sy-mandt &amp;&amp; `'; `\r\n           &amp;&amp; `END;` ).\r\n        GET REFERENCE OF incprice INTO dref.\r\n        sql-&gt;set_param( data_ref = dref\r\n                        inout    = cl_sql_statement=&gt;c_param_in ).\r\n        sql-&gt;execute_procedure( proc_name = 'increase_price' ).\r\n      CATCH cx_sql_exception INTO err.\r\n        MESSAGE err TYPE 'I' DISPLAY LIKE 'E'.\r\n    ENDTRY.\r\n  ENDMETHOD.\r\n  METHOD call_screen.\r\n    IF sy-dbsys &lt;&gt; 'ORACLE'.\r\n      MESSAGE 'Example is only for Oracle SQL'\r\n              TYPE 'I' DISPLAY LIKE 'E'.\r\n      LEAVE PROGRAM.\r\n    ENDIF.\r\n    CALL SELECTION-SCREEN 100.\r\n    IF sy-subrc &lt;&gt; 0.\r\n      LEAVE PROGRAM.\r\n    ENDIF.\r\n  ENDMETHOD.\r\nENDCLASS.\r\n\r\nSTART-OF-SELECTION.\r\n  demo=&gt;main( ).<\/pre>\n<h3>\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u0435 \u0437\u0430\u0440\u0430\u043d\u0435\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 SQL \u043a\u043e\u043c\u0430\u043d\u0434<\/h3>\n<p>\u041a\u043b\u0430\u0441\u0441 CL_SQL_PREPARED_STATEMENT \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u0437\u0430\u0440\u0430\u043d\u0435\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0435 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f, \u043f\u0440\u0438 \u044d\u0442\u043e\u043c \u043c\u0435\u043d\u044f\u044f \u0438\u0445 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u043f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438. \u0414\u0430\u043d\u043d\u044b\u0439 \u043a\u043b\u0430\u0441\u0441 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043d\u0430\u0441\u043b\u0435\u0434\u043d\u0438\u043a\u043e\u043c \u043e\u0442 CL_SQL_STATEMENT.<\/p>\n<p>SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u0442\u0441\u044f \u0432 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440 \u043a\u043b\u0430\u0441\u0441\u0430, \u0447\u0435\u0440\u0435\u0437 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 STATEMENT. \u041a\u0430\u043a \u0438 \u0434\u043b\u044f \u043c\u0435\u0442\u043e\u0434\u043e\u0432 \u043a\u043b\u0430\u0441\u0441\u0430 CL_SQL_STATEMENT \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u044b \u043c\u0435\u0442\u043e\u0434\u044b \u0434\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u043e\u0432 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f.<\/p>\n<p>\u041f\u043e\u0441\u043b\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u041b\u0415\u0420 \u0411\u0414, \u043e\u0431\u044a\u0435\u043a\u0442 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0432\u043d\u043e\u0432\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d. \u0415\u0441\u043b\u0438 \u0434\u0430\u043d\u043d\u044b\u0439 \u043e\u0431\u044a\u0435\u043a\u0442 \u0431\u043e\u043b\u0435\u0435 \u043d\u0435 \u043d\u0443\u0436\u0435\u043d, \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u043c\u0435\u0442\u043e\u0434 close, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043e\u0441\u0432\u043e\u0431\u043e\u0434\u0438\u0442 \u0437\u0430\u043d\u044f\u0442\u044b\u0435 \u0440\u0435\u0441\u0443\u0440\u0441\u044b.<\/p>\n<p>\u041f\u0440\u0438\u043c\u0435\u0440 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0449\u0435\u0439 \u0434\u0430\u043d\u043d\u044b\u0439 \u043a\u043b\u0430\u0441\u0441:<\/p>\n<pre class=\"lang:abap decode:true\">REPORT demo_adbc_prepared_statement.\r\n\r\nCLASS demo DEFINITION.\r\n  PUBLIC SECTION.\r\n    CLASS-METHODS main.\r\n  PRIVATE SECTION.\r\n    CLASS-DATA: BEGIN OF result_line,\r\n                  carrid TYPE sflight-carrid,\r\n                  connid TYPE sflight-connid,\r\n                END OF result_line,\r\n                result_tab LIKE TABLE OF result_line.\r\n    CLASS-METHODS display.\r\nENDCLASS.\r\n\r\nCLASS demo IMPLEMENTATION.\r\n  METHOD main.\r\n    DATA:  sql        TYPE REF TO cl_sql_prepared_statement,\r\n           result     TYPE REF TO cl_sql_result_set,\r\n           err        TYPE REF TO cx_sql_exception,\r\n           cols       TYPE adbc_column_tab,\r\n           carrid     TYPE sflight-carrid,\r\n           carrid_tab TYPE TABLE OF sflight-carrid,\r\n           dref1      TYPE REF TO data,\r\n           dref2      TYPE REF TO data.\r\n    APPEND 'CARRID' TO cols.\r\n    APPEND 'CONNID' TO cols.\r\n    APPEND 'AA' TO carrid_tab.\r\n    APPEND 'LH' TO carrid_tab.\r\n    APPEND 'UA' TO carrid_tab.\r\n    TRY.\r\n        CREATE OBJECT sql\r\n          EXPORTING\r\n            statement = `SELECT carrid, connid `      &amp;&amp;\r\n                        `FROM spfli `                 &amp;&amp;\r\n                        `WHERE mandt = '` &amp;&amp; sy-mandt &amp;&amp;\r\n                        `' AND carrid = ?`.\r\n        GET REFERENCE OF carrid       INTO dref1.\r\n        GET REFERENCE OF result_line INTO dref2.\r\n        sql-&gt;set_param( dref1 ).\r\n        LOOP AT carrid_tab INTO carrid.\r\n          result = sql-&gt;execute_query( ).\r\n          result-&gt;set_param_struct( struct_ref = dref2\r\n                                    corresponding_fields = cols ).\r\n          WHILE result-&gt;next( ) &gt; 0.\r\n            APPEND result_line TO result_tab.\r\n          ENDWHILE.\r\n        ENDLOOP.\r\n        sql-&gt;close( ).\r\n        display( ).\r\n      CATCH cx_sql_exception INTO err.\r\n        MESSAGE err TYPE 'I' DISPLAY LIKE 'E'.\r\n    ENDTRY.\r\n  ENDMETHOD.\r\n  METHOD display.\r\n    DATA alv TYPE REF TO cl_salv_table.\r\n    DATA err TYPE REF TO cx_salv_msg.\r\n    TRY.\r\n        cl_salv_table=&gt;factory(\r\n          IMPORTING r_salv_table = alv\r\n          CHANGING  t_table      = result_tab ).\r\n        alv-&gt;display( ).\r\n      CATCH cx_salv_msg INTO err.\r\n        MESSAGE err TYPE 'I' DISPLAY LIKE 'E'.\r\n    ENDTRY.\r\n  ENDMETHOD.\r\nENDCLASS.\r\n\r\nSTART-OF-SELECTION.\r\n  demo=&gt;main( ).<\/pre>\n<h3>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439<\/h3>\n<p>SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0435 \u043a\u043b\u0430\u0441\u0441\u0430\u043c\u0438 CL_SQL_STATEMENT\u00a0 \u0438 CL_SQL_PREPARED_STATEMENT \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442 \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0433\u043b\u0430\u0432\u043d\u043e\u0439 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0439. \u041f\u0440\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e\u0441\u0442\u0438 \u043c\u043e\u0436\u043d\u043e \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u0438 \u0434\u0440\u0443\u0433\u043e\u0435 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435, \u0435\u0441\u043b\u0438 \u043e\u043d\u043e \u043d\u0430\u0441\u0442\u0440\u043e\u0435\u043d\u043e (\u0442\u0440. DBACOCKPIT).<\/p>\n<p>\u0421\u0442\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u043c\u0435\u0442\u043e\u0434 GET_CONNECTION \u043f\u0440\u0438 \u0443\u0434\u0430\u0447\u043d\u043e\u043c \u0441\u043e\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0438 \u0441 \u0430\u043b\u044c\u0442\u0435\u0440\u043d\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u0411\u0414, \u0432\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u043a\u043b\u0430\u0441\u0441\u0430 CL_SQL_CONNECTION, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432 \u0434\u0430\u043b\u044c\u043d\u0435\u0439\u0448\u0435\u043c \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d \u043f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432\u00a0 CL_SQL_STATEMENT\u00a0 \u0438 CL_SQL_PREPARED_STATEMENT \u0447\u0435\u0440\u0435\u0437 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043a\u043e\u043d\u0441\u0442\u0440\u0443\u043a\u0442\u043e\u0440\u0430 &#8212; CON_REF. \u0415\u0441\u043b\u0438 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u043a\u043e\u043d\u0442\u0440\u043e\u043b\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0434\u043b\u044f \u0411\u0414 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e, \u043e\u0431\u044a\u0435\u043a\u0442 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0441\u043e\u0437\u0434\u0430\u043d \u0447\u0435\u0440\u0435\u0437 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 CREATE OBJECT.<\/p>\n<p>\u0414\u043b\u044f \u0437\u0430\u043a\u0440\u044b\u0442\u0438\u044f \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043c\u0435\u0442\u043e\u0434 CLOSE. \u041f\u0440\u0438 \u044d\u0442\u043e\u043c \u043e\u0431\u044a\u0435\u043a\u0442\u044b, \u0441\u043e\u0437\u0434\u0430\u043d\u043d\u044b\u0435 \u0441 \u044d\u0442\u0438\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435\u043c, \u043d\u0435 \u043c\u043e\u0433\u0443\u0442 \u0431\u044b\u0442\u044c \u0434\u0430\u043b\u0435\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u044b, \u0435\u0441\u043b\u0438 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043d\u0435 \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u043b\u043e\u0441\u044c \u043a \u0433\u043b\u0430\u0432\u043d\u043e\u0439 \u0411\u0414 (\u0411\u0414 \u043f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e).<\/p>\n<p>\u0414\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u041b\u0415\u0420 \u0411\u0414 \u0432 \u0434\u0430\u043d\u043d\u043e\u043c \u043a\u043b\u0430\u0441\u0441\u0435 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u043c\u0435\u0442\u043e\u0434\u044b: COMMIT \u2013 \u0434\u043b\u044f \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f, ROLLBACK \u2013 \u0434\u043b\u044f \u043e\u0442\u043c\u0435\u043d\u044b. \u041f\u0440\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440\u0430 \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u041b\u0415\u0420 \u0411\u0414 \u043e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u043d\u0435\u044f\u0432\u043d\u043e.<\/p>\n<h3>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439<\/h3>\n<p>\u0414\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0439 \u0432 ADBC \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u043a\u043b\u0430\u0441\u0441 CX_SQL_EXCEPTION. \u041a\u0440\u043e\u043c\u0435 \u0442\u0435\u043a\u0441\u0442\u0430 \u0438\u0441\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f, \u0432 \u0434\u0430\u043d\u043d\u043e\u043c \u043a\u043b\u0430\u0441\u0441\u0435 \u043f\u0440\u0438\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u044e\u0442 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0435 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u044b:<\/p>\n<table border=\"1\" cellpadding=\"0\">\n<tbody>\n<tr>\n<td><b>\u0410\u0442\u0440\u0438\u0431\u0443\u0442<\/b><\/td>\n<td><b>\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435<\/b><\/td>\n<\/tr>\n<tr>\n<td>DB_ERROR<\/td>\n<td>&#171;X&#187;, \u0415\u0441\u043b\u0438 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043d\u0435 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e \u0421\u0423\u0411\u0414. SQL_CODE \u0438 SQL_MESSAGE \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442 \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u0443\u044e \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044e.<\/td>\n<\/tr>\n<tr>\n<td>DBOBJECT_EXISTS<\/td>\n<td>&#171;X&#187;, \u0415\u0441\u043b\u0438 \u0432\u044b \u043f\u044b\u0442\u0430\u0435\u0442\u0435\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442. DB_ERROR \u0442\u0430\u043a \u0436\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 &#171;X&#187;.<\/td>\n<\/tr>\n<tr>\n<td>DBOBJECT_NOT_EXISTS<\/td>\n<td>&#171;X&#187;, \u0415\u0441\u043b\u0438 \u0432\u044b \u043f\u044b\u0442\u0430\u0435\u0442\u0435\u0441\u044c \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043e\u0431\u044a\u0435\u043a\u0442\u0443, \u043a\u043e\u0442\u043e\u0440\u043e\u0433\u043e \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442. DB_ERROR \u0442\u0430\u043a \u0434\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 &#171;X&#187;.<\/td>\n<\/tr>\n<tr>\n<td>DUPLICATE_KEY<\/td>\n<td>&#171;X&#187;, \u0415\u0441\u043b\u0438 DML \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u043d\u0430\u0440\u0443\u0448\u0430\u0435\u0442 \u0443\u043d\u0438\u043a\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043a\u043b\u044e\u0447\u0430. DB_ERROR \u0442\u0430\u043a \u0434\u0435 \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 &#171;X&#187;.<\/td>\n<\/tr>\n<tr>\n<td>INTERNAL_ERROR<\/td>\n<td>\u0412\u043d\u0443\u0442\u0440\u0435\u043d\u043d\u044f\u044f \u043e\u0448\u0438\u0431\u043a\u0430 \u0421\u0423\u0411\u0414, \u0434\u043b\u044f \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441\u043c\u043e\u0442\u0440\u0438\u0442\u0435 \u0436\u0443\u0440\u043d\u0430\u043b\u044b \u0421\u0423\u0411\u0414.<\/td>\n<\/tr>\n<tr>\n<td>INVALID_CURSOR<\/td>\n<td>&#171;X&#187;, \u0435\u0441\u043b\u0438 \u0432\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0435 \u043d\u0435 \u0430\u043a\u0442\u0438\u0432\u043d\u044b\u0439 \u043a\u0443\u0440\u0441\u043e\u0440 \u0411\u0414.<\/td>\n<\/tr>\n<tr>\n<td>SQL_CODE<\/td>\n<td>\u041a\u043e\u0434 \u043e\u0448\u0438\u0431\u043a\u0438 \u0432 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0438, \u0415\u0441\u043b\u0438 DB_ERROR &#8212; &#171;X&#187;.<\/td>\n<\/tr>\n<tr>\n<td>SQL_MESSAGE<\/td>\n<td>\u0420\u0430\u0441\u0448\u0438\u0444\u0440\u043e\u0432\u043a\u0430 \u043a\u043e\u0434\u0430 \u043e\u0448\u0438\u0431\u043a\u0438 \u0432 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u0438, \u0435\u0441\u043b\u0438 DB_ERROR &#8212; &#171;X&#187;.<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>SAP <a href=\"http:\/\/help.sap.com\/abapdocu_731\/en\/abenadbc.htm\">\u0441\u043f\u0440\u0430\u0432\u043a\u0430<\/a> \u043d\u0430 \u0442\u0435\u043c\u0443 ADBC.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>ADBC \u2013 \u043e\u0431\u044a\u0435\u043a\u0442\u043d\u043e-\u043e\u0440\u0438\u0435\u043d\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0435 API, \u0434\u043b\u044f \u0432\u0437\u0430\u0438\u043c\u043e\u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0441 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u043e\u043c \u043d\u0430\u0442\u0438\u0432\u043d\u043e\u0433\u043e SQL \u0432 ABAP. \u041c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d \u0432 \u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435, \u043a\u043e\u0433\u0434\u0430 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u043d\u0430\u0442\u0438\u0432\u043d\u043e\u043c\u0443 SQL, \u0442.\u043a. \u0432\u044b\u0437\u043e\u0432 \u0447\u0435\u0440\u0435\u0437 \u043a\u043e\u043c\u0430\u043d\u0434\u044b EXEC SQL \u043d\u0435 \u043f\u043e\u0434\u0440\u0430\u0437\u0443\u043c\u0435\u0432\u0430\u0435\u0442 \u0434\u0438\u043d\u0430\u043c\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438. \u041a\u043b\u0430\u0441\u0441\u044b, \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0449\u0438\u0435 ADBC \u043d\u0430\u0447\u0438\u043d\u0430\u044e\u0442\u0441\u044f \u0441 CL_SQL_* \u0438 CX_SQL_* (\u043f\u0430\u043a\u0435\u0442 SDB_ADBC). \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u0435 \u0438\u0437 \u043d\u0438\u0445:<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":[],"categories":[307],"tags":[254],"_links":{"self":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts\/1483"}],"collection":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/comments?post=1483"}],"version-history":[{"count":5,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts\/1483\/revisions"}],"predecessor-version":[{"id":1487,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts\/1483\/revisions\/1487"}],"wp:attachment":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/media?parent=1483"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/categories?post=1483"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/tags?post=1483"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}