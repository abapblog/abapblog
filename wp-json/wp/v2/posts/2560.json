{"id":2560,"date":"2015-07-07T16:44:46","date_gmt":"2015-07-07T12:44:46","guid":{"rendered":"http:\/\/abap-blog.ru\/?p=2560"},"modified":"2021-03-02T10:12:12","modified_gmt":"2021-03-02T06:12:12","slug":"slabye-ssylki-v-abap","status":"publish","type":"post","link":"https:\/\/abap-blog.ru\/osnovy-abap\/oop\/slabye-ssylki-v-abap\/","title":{"rendered":"\u0421\u043b\u0430\u0431\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 \u0432 ABAP"},"content":{"rendered":"<p>\u041f\u043e\u043d\u044f\u0442\u0438\u0435 \u0441\u043b\u0430\u0431\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0438 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u0445 \u0438\u00a0\u044f\u0437\u044b\u043a\u0430\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u0433\u0434\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f\u00a0\u0441\u0431\u043e\u0440\u043a\u0430 \u043c\u0443\u0441\u043e\u0440\u0430\u00a0\u2014 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0438\u0437\u00a0\u043f\u0430\u043c\u044f\u0442\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043f\u0440\u0435\u043a\u0440\u0430\u0442\u0438\u043b\u043e\u0441\u044c \u0438 \u0431\u043e\u043b\u0435\u0435 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0432\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e. \u0414\u0430\u043b\u0435\u0435 \u0432 \u0441\u0442\u0430\u0442\u044c\u0435 \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0441\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u0430 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0441\u043b\u0430\u0431\u044b\u0445 \u0441\u0441\u044b\u043b\u043e\u043a \u0432 ABAP.<\/p>\n<p><!--more--><\/p>\n<p>\u0414\u043b\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432, \u043f\u043e\u0434\u043b\u0435\u0436\u0430\u0449\u0438\u0445 \u0441\u0431\u043e\u0440\u043a\u0435 \u043c\u0443\u0441\u043e\u0440\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f \u0442\u043e\u0442 \u0438\u043b\u0438 \u0438\u043d\u043e\u0439 \u0432\u0430\u0440\u0438\u0430\u043d\u0442 \u0430\u043b\u0433\u043e\u0440\u0438\u0442\u043c\u0430 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u0434\u043e\u0441\u0442\u0438\u0436\u0438\u043c\u043e\u0441\u0442\u0438 \u2014 \u0434\u043e\u0441\u0442\u0438\u0436\u0438\u043c\u044b\u043c \u0441\u0447\u0438\u0442\u0430\u0435\u0442\u0441\u044f \u043e\u0431\u044a\u0435\u043a\u0442, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0432 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0445\u043e\u0442\u044f \u0431\u044b \u043e\u0434\u043d\u0430 \u0441\u0441\u044b\u043b\u043a\u0430. \u041a\u043e\u0433\u0434\u0430 \u0432 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0435 \u043d\u0435 \u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c \u043d\u0438 \u043e\u0434\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u043e\u0431\u044a\u0435\u043a\u0442, \u0442\u043e \u0435\u0441\u0442\u044c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043f\u0440\u0435\u043a\u0440\u0430\u0442\u0438\u043b\u043e\u0441\u044c, \u0442\u0430\u043a\u043e\u0439 \u043e\u0431\u044a\u0435\u043a\u0442 \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0443\u0434\u0430\u043b\u0451\u043d \u0432 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0438\u0439 \u043f\u043e\u0434\u0445\u043e\u0434\u044f\u0449\u0438\u0439 \u043c\u043e\u043c\u0435\u043d\u0442.<\/p>\n<p>\u0421\u0431\u043e\u0440\u0449\u0438\u043a \u043c\u0443\u0441\u043e\u0440\u0430 \u0432 <a href=\"http:\/\/help.sap.com\/abapdocu_740\/en\/abengarbage_collector_glosry.htm\">ABAP<\/a> \u0443\u0441\u0442\u0440\u043e\u0435\u043d \u0442\u0430\u043a\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c, \u0447\u0442\u043e \u043e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0430\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442 \u0438\u0437 \u043f\u0430\u043c\u044f\u0442\u0438 \u0442\u043e\u0433\u0434\u0430, \u043a\u043e\u0433\u0434\u0430 \u043d\u0430 \u043d\u0435\u0433\u043e \u043d\u0435\u0442 \u0441\u0441\u044b\u043b\u043a\u0438, \u0438 \u0435\u0441\u043b\u0438 \u043c\u0435\u0442\u043e\u0434\u044b \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043d\u0435 \u043f\u043e\u0434\u043f\u0438\u0441\u0430\u043d\u044b \u043d\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u0438\u043d\u043e\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430, \u0441\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0435\u0449\u0435 \u0436\u0438\u0432\u0430. \u0421\u0430\u043c \u043f\u043e \u0441\u0435\u0431\u0435 \u043e\u043d \u0432\u044b\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u00ab\u043f\u0435\u0440\u0438\u043e\u0434\u0438\u0447\u0435\u0441\u043a\u0438\u00bb \u0441\u0440\u0435\u0434\u043e\u0439 \u0438\u0441\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f, \u043d\u043e \u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u0432\u044b\u0437\u0432\u0430\u043d \u0438 \u0432\u0440\u0443\u0447\u043d\u0443\u044e \u0447\u0435\u0440\u0435\u0437 \u0432\u044b\u0437\u043e\u0432 \u043c\u0435\u0442\u043e\u0434\u0430:<\/p>\n<pre class=\"lang:abap decode:true\">cl_abap_memory_utilities=&gt;do_garbage_collection( ).<\/pre>\n<p>\u041e\u043f\u0438\u0441\u0430\u043d\u043d\u044b\u0439 \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c \u043e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0435\u043d\u0438\u044f \u043f\u0430\u043c\u044f\u0442\u0438 \u043c\u043e\u0436\u0435\u0442 \u0432 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u044f\u0445 \u043f\u043e\u0440\u043e\u0436\u0434\u0430\u0442\u044c\u00a0\u0443\u0442\u0435\u0447\u043a\u0438 \u043f\u0430\u043c\u044f\u0442\u0438\u00a0\u0438\u0437-\u0437\u0430 \u00ab\u0437\u0430\u0431\u044b\u0442\u044b\u0445\u00bb \u0441\u0441\u044b\u043b\u043e\u043a, \u043a\u043e\u0433\u0434\u0430 \u0441\u0441\u044b\u043b\u043a\u0438 \u043d\u0430 \u0441\u043e\u0437\u0434\u0430\u0432\u0430\u0435\u043c\u044b\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u044b \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u044e\u0442\u0441\u044f \u0432 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u043c\u0435\u0441\u0442\u0430\u0445, \u0438 \u043f\u0440\u0438 \u043f\u0440\u0435\u043a\u0440\u0430\u0449\u0435\u043d\u0438\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0441\u0442 \u043d\u0435 \u0443\u0434\u0430\u043b\u044f\u0435\u0442 \u0438\u0445 \u0432\u0441\u0435. \u0412\u043e \u0438\u0437\u0431\u0435\u0436\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0441\u0442 \u0432\u044b\u043d\u0443\u0436\u0434\u0435\u043d \u043f\u0440\u0438\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0442\u044c\u0441\u044f \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0436\u0451\u0441\u0442\u043a\u043e\u0439 \u0434\u0438\u0441\u0446\u0438\u043f\u043b\u0438\u043d\u044b \u0432 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 \u0441\u0441\u044b\u043b\u043e\u043a, \u0447\u0442\u043e \u043d\u0435 \u0432\u0441\u0435\u0433\u0434\u0430 \u0443\u0434\u043e\u0431\u043d\u043e.<\/p>\n<p>\u0427\u0442\u043e\u0431\u044b \u0438\u0437\u0431\u0435\u0436\u0430\u0442\u044c \u043f\u043e\u0434\u043e\u0431\u043d\u044b\u0445 \u043f\u0440\u043e\u0431\u043b\u0435\u043c, \u044f\u0437\u044b\u043a \u0438\u043b\u0438\u00a0\u0441\u0440\u0435\u0434\u0430 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\u00a0\u043c\u043e\u0433\u0443\u0442 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0442\u044c \u0442\u0430\u043a \u043d\u0430\u0437\u044b\u0432\u0430\u0435\u043c\u044b\u0435\u00a0\u0441\u043b\u0430\u0431\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438. \u0422\u0430\u043a\u0438\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0442\u0430\u043a \u0436\u0435, \u043a\u0430\u043a \u0438 \u043e\u0431\u044b\u0447\u043d\u044b\u0435, \u043d\u043e \u043d\u0435 \u0432\u043b\u0438\u044f\u044e\u0442 \u043d\u0430 \u0441\u0431\u043e\u0440\u043a\u0443 \u043c\u0443\u0441\u043e\u0440\u0430, \u043f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u043d\u0435 \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u044e\u0442\u0441\u044f \u043c\u0435\u0445\u0430\u043d\u0438\u0437\u043c\u043e\u043c \u043f\u043e\u0434\u0441\u0447\u0451\u0442\u0430 \u0441\u0441\u044b\u043b\u043e\u043a.<\/p>\n<p>\u0412 ABAP \u0441\u043b\u0430\u0431\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u044c \u0447\u0435\u0440\u0435\u0437 \u043a\u043b\u0430\u0441\u0441 <a href=\"http:\/\/help.sap.com\/abapdocu_740\/en\/abencl_abap_weak_reference.htm\">CL_ABAP_WEAK_REFERENCE<\/a>, \u0434\u0435\u043b\u0430\u0435\u0442\u0441\u044f \u044d\u0442\u043e \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u043c \u043e\u0431\u0440\u0430\u0437\u043e\u043c:<\/p>\n<pre class=\"lang:abap decode:true\">CLASS lcl_test DEFINITION.\r\nENDCLASS.\r\n\r\nCLASS lcl_test IMPLEMENTATION.\r\nENDCLASS.\r\n\r\nDATA:\r\n  lo_weak_reference   TYPE REF TO cl_abap_weak_reference,\r\n  lo_strong_reference TYPE REF TO lcl_test.\r\n\r\n\" \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0441\u0438\u043b\u044c\u043d\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443\r\nCREATE OBJECT lo_strong_reference.\r\n\r\n\" \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043d\u0430 \u0435\u0451 \u043e\u0441\u043d\u043e\u0432\u0435 \u0441\u043b\u0430\u0431\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443\r\nCREATE OBJECT lo_weak_reference\r\n  EXPORTING\r\n    oref = lo_strong_reference.\r\n\r\n\" \u041e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0430\u0435\u043c \u0441\u0438\u043b\u044c\u043d\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443\r\nCLEAR lo_strong_reference.\r\n\r\n\" \u0415\u0441\u043b\u0438 \u0443\u0431\u0440\u0430\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439, \u0431\u0443\u0434\u0435\u0442 \u0432\u044b\u0437\u0432\u0430\u043d \u0441\u0431\u043e\u0440\u0449\u0438\u043a \u043c\u0443\u0441\u043e\u0440\u0430,\r\n\" \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0430\u0439\u0434\u0435\u0442 \u043e\u0431\u044a\u0435\u043a\u0442 \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u043d\u0435\u0442 \u0441\u0438\u043b\u044c\u043d\u043e\u0439\r\n\" \u0441\u0441\u044b\u043b\u043a\u0438 \u0438 \u0443\u0434\u0430\u043b\u0438\u0442 \u0435\u0433\u043e \u0438\u0437 \u043f\u0430\u043c\u044f\u0442\u0438, \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043f\u043e \u0441\u043b\u0430\u0431\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435 \u043d\u0435 \u043f\u043e\u043b\u0443\u0447\u0438\u0442\u0441\u044f.\r\n\" cl_abap_memory_utilities=&gt;do_garbage_collection( ).\r\n\r\n\" \u041f\u043e\u043b\u0443\u0447\u0430\u0435\u043c \u0441\u0438\u043b\u044c\u043d\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u0441\u043b\u0430\u0431\u043e\u0439\r\nlo_strong_reference ?= lo_weak_reference-&gt;get( ).\r\n\r\nIF lo_strong_reference IS NOT BOUND.\r\n  \" \u0421\u0431\u043e\u0440\u0449\u0438\u043a \u043c\u0443\u0441\u043e\u0440\u0430 \u0443\u0436\u0435 \u043c\u043e\u0433 \u0443\u0441\u043f\u0435\u0442\u044c \u043e\u0447\u0438\u0441\u0442\u0438\u0442\u044c \u043f\u0430\u043c\u044f\u0442\u044c,\r\n  \" \u043f\u043e \u0441\u043b\u0430\u0431\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u0438\u043b\u044c\u043d\u0443\u044e \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c,\r\n  \" \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0431\u044a\u0435\u043a\u0442 \u0437\u0430\u043d\u043e\u0432\u043e.\r\n  CREATE OBJECT lo_strong_reference.\r\n  WRITE: '\u0412\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u043d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c, \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u0431\u044a\u0435\u043a\u0442 \u0437\u0430\u043d\u043e\u0432\u043e.'.\r\nELSE.\r\n  WRITE: '\u041e\u0431\u044a\u0435\u043a\u0442 \u0431\u044b\u043b \u043f\u043e\u043b\u0443\u0447\u0435\u043d \u043f\u043e \u0441\u043b\u0430\u0431\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435.'.\r\nENDIF.<\/pre>\n<p>\u0421\u043b\u0430\u0431\u044b\u0435 \u0441\u0441\u044b\u043b\u043a\u0438 \u0447\u0430\u0441\u0442\u043e \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f \u0434\u043b\u044f \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u043a\u044d\u0448\u0430, \u0442\u0430\u043a\u043e\u0439 \u043a\u044d\u0448 \u043d\u0435 \u0442\u0440\u0435\u0431\u0443\u0435\u0442 \u0442\u0449\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0433\u043e \u043e\u0442\u0441\u043b\u0435\u0436\u0438\u0432\u0430\u043d\u0438\u044f \u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0439 \u043f\u0430\u043c\u044f\u0442\u0438, \u0435\u0441\u043b\u0438 \u043d\u0430 \u044d\u0442\u0430\u043f\u0435 \u0440\u0430\u0431\u043e\u0442\u044b \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u044b \u043f\u0430\u043c\u044f\u0442\u0438 \u0431\u0443\u0434\u0435\u0442 \u043d\u0435 \u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e, \u043a\u044d\u0448 \u0431\u0443\u0434\u0435\u0442 \u043e\u0447\u0438\u0449\u0435\u043d \u0441\u0431\u043e\u0440\u0449\u0438\u043a\u043e\u043c \u043c\u0443\u0441\u043e\u0440\u0430 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0438, \u043f\u0440\u0438\u0447\u0435\u043c \u043e\u0447\u0438\u0441\u0442\u043a\u0430 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u043f\u043e \u0447\u0430\u0441\u0442\u044f\u043c:<\/p>\n<pre class=\"lang:abap decode:true \">CLASS lcl_weak_cache DEFINITION.\r\n  PUBLIC SECTION.\r\n    CLASS-METHODS:\r\n      set IMPORTING iv_id TYPE csequence\r\n                    io_reference TYPE REF TO object,\r\n      get IMPORTING iv_id TYPE csequence\r\n          RETURNING VALUE(ro_reference) TYPE REF TO object.\r\n  PRIVATE SECTION.\r\n    TYPES:\r\n      BEGIN OF ty_cache_line,\r\n            id TYPE string,\r\n            object TYPE REF TO cl_abap_weak_reference,\r\n           END OF ty_cache_line .\r\n    TYPES:\r\n      ty_cache_table TYPE HASHED TABLE OF ty_cache_line WITH UNIQUE KEY id .\r\n\r\n    CLASS-DATA gt_cache TYPE ty_cache_table .\r\nENDCLASS.                    \"lcl_weak_cache DEFINITION\r\n\r\nCLASS lcl_weak_cache IMPLEMENTATION.\r\n  METHOD set.\r\n    DATA:\r\n      ls_cache TYPE ty_cache_line.\r\n\r\n    DELETE gt_cache WHERE id = iv_id.\r\n\r\n    ls_cache-id = iv_id.\r\n\r\n    CREATE OBJECT ls_cache-object\r\n      EXPORTING\r\n        oref = io_reference.\r\n\r\n    INSERT ls_cache INTO TABLE gt_cache.\r\n  ENDMETHOD.                    \"set\r\n\r\n  METHOD get.\r\n    FIELD-SYMBOLS:\r\n      &lt;ls_cache&gt; TYPE ty_cache_line.\r\n\r\n    READ TABLE gt_cache WITH TABLE KEY id = iv_id ASSIGNING &lt;ls_cache&gt;.\r\n    CHECK sy-subrc EQ 0.\r\n    ro_reference = &lt;ls_cache&gt;-object-&gt;get( ).\r\n  ENDMETHOD.                    \"get\r\nENDCLASS.                    \"lcl_weak_cache IMPLEMENTATION\r\n\r\nCLASS lcl_cached_object DEFINITION.\r\n  PUBLIC SECTION.\r\n    METHODS:\r\n      constructor.\r\nENDCLASS.                    \"lcl_cached_object DEFINITION\r\n\r\nCLASS lcl_cached_object IMPLEMENTATION.\r\n  METHOD constructor.\r\n    \" \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430\r\n  ENDMETHOD.                    \"constructor\r\nENDCLASS.                    \"lcl_cached_object IMPLEMENTATION\r\n\r\nDATA:\r\n  go_cached_object TYPE REF TO lcl_cached_object,\r\n  gv_index TYPE string.\r\n\r\nSTART-OF-SELECTION.\r\n  DO 1000000 TIMES.\r\n    gv_index = sy-index.\r\n    CONDENSE gv_index NO-GAPS.\r\n    CREATE OBJECT go_cached_object.\r\n    lcl_weak_cache=&gt;set( iv_id = gv_index\r\n                         io_reference = go_cached_object ).\r\n    CLEAR go_cached_object.\r\n  ENDDO.\r\n\r\n  go_cached_object ?= lcl_weak_cache=&gt;get( `2` ).\r\n  IF go_cached_object IS NOT BOUND.\r\n    WRITE '\u041e\u0431\u044a\u0435\u043a\u0442 \u043f\u043e\u0434 \u043d\u043e\u043c\u0435\u0440\u043e\u043c 2 \u043d\u0435 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d.'.\r\n    go_cached_object ?= lcl_weak_cache=&gt;get( `999999` ).\r\n    CHECK go_cached_object IS BOUND.\r\n    WRITE '\u041e\u0431\u044a\u0435\u043a\u0442 \u043f\u043e\u0434 \u043d\u043e\u043c\u0435\u0440\u043e\u043c 999999 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u043f\u043e \u0441\u043b\u0430\u0431\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435'.\r\n  ENDIF.\r\n<\/pre>\n<p><a href=\"http:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/1.png\"><img loading=\"lazy\" class=\"alignnone size-full wp-image-2561\" src=\"http:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/1.png\" alt=\"1\" width=\"900\" height=\"34\" srcset=\"https:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/1.png 900w, https:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/1-300x11.png 300w\" sizes=\"(max-width: 900px) 100vw, 900px\" \/><\/a><\/p>\n<p>\u0415\u0441\u043b\u0438 \u043f\u0435\u0440\u0435\u0434 \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435\u043c \u043e\u0431\u044a\u0435\u043a\u0442\u0430 999999 \u0432\u044b\u0437\u0432\u0430\u0442\u044c \u0441\u0431\u043e\u0440\u0449\u0438\u043a \u043c\u0443\u0441\u043e\u0440\u0430 \u0432\u0440\u0443\u0447\u043d\u0443\u044e, \u0432\u0435\u0441\u044c \u043a\u044d\u0448 \u0431\u0443\u0434\u0435\u0442 \u043e\u0447\u0438\u0449\u0435\u043d (\u0432 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u043c \u0440\u0435\u0436\u0438\u043c\u0435 \u043e\u0442\u0447\u0438\u0449\u0430\u0435\u0442\u0441\u044f \u043f\u043e \u0447\u0430\u0441\u0442\u044f\u043c) \u0438 \u043e\u0431\u044a\u0435\u043a\u0442 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d \u043f\u043e \u0441\u043b\u0430\u0431\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0435.<\/p>\n<p>\u0412 \u0434\u0430\u043d\u043d\u043e\u043c \u043f\u0440\u0438\u043c\u0435\u0440\u0435 \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043a\u044d\u0448\u0430 \u0431\u043e\u043b\u044c\u0448\u0438\u043d\u0441\u0442\u0432\u043e \u0441\u043b\u0430\u0431\u044b\u0445 \u0441\u0441\u044b\u043b\u043e\u043a \u0443\u0436\u0435 \u043d\u0435 \u0434\u0430\u0441\u0442 \u0443\u043a\u0430\u0437\u0430\u0442\u0435\u043b\u044c \u043d\u0430 \u0441\u0438\u043b\u044c\u043d\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443, \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442 \u044d\u0442\u043e \u0438\u0437-\u0437\u0430 \u0442\u043e\u0433\u043e \u0447\u0442\u043e \u043f\u0440\u0438 \u043f\u043e\u043f\u044b\u0442\u043a\u0435 \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0441\u043b\u0430\u0431\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u043f\u0443\u0449\u0435\u043d \u0441\u0431\u043e\u0440\u0449\u0438\u043a \u043c\u0443\u0441\u043e\u0440\u0430 \u0438 \u043f\u0430\u043c\u044f\u0442\u044c \u043e\u0442\u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0440\u0430\u043d\u0435\u0435 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432 \u0431\u0443\u0434\u0435\u0442 \u043e\u0441\u0432\u043e\u0431\u043e\u0436\u0434\u0435\u043d\u0430.<\/p>\n<p>\u0427\u0442\u043e\u0431\u044b \u0432\u0435\u0441\u044c \u043a\u044d\u0448 \u0431\u044b\u043b \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f \u043c\u043e\u0436\u043d\u043e \u0440\u0430\u0441\u0448\u0438\u0440\u0438\u0442\u044c \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u043a\u044d\u0448\u0430 \u043d\u0430 \u0441\u0438\u043b\u044c\u043d\u0443\u044e \u0441\u0441\u044b\u043b\u043a\u0443 \u0438 \u0447\u0438\u0441\u0442\u0438\u0442\u044c \u0435\u0451 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u043c \u043c\u0435\u0442\u043e\u0434\u043e\u043c \u043f\u043e\u0441\u043b\u0435 \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f:<\/p>\n<pre class=\"lang:abap decode:true\">CLASS lcl_weak_cache DEFINITION.\r\n  PUBLIC SECTION.\r\n    CLASS-METHODS:\r\n      set IMPORTING iv_id TYPE csequence\r\n                    io_reference TYPE REF TO object,\r\n      get IMPORTING iv_id TYPE csequence\r\n          RETURNING value(ro_reference) TYPE REF TO object,\r\n      clear.\r\n  PRIVATE SECTION.\r\n    TYPES:\r\n      BEGIN OF ty_cache_line,\r\n            id TYPE string,\r\n            object TYPE REF TO object,\r\n            weak   TYPE REF TO cl_abap_weak_reference,\r\n           END OF ty_cache_line .\r\n    TYPES:\r\n      ty_cache_table TYPE HASHED TABLE OF ty_cache_line WITH UNIQUE KEY id .\r\n\r\n    CLASS-DATA gt_cache TYPE ty_cache_table .\r\nENDCLASS.                    \"lcl_weak_cache DEFINITION\r\n\r\nCLASS lcl_weak_cache IMPLEMENTATION.\r\n  METHOD set.\r\n    DATA:\r\n      ls_cache TYPE ty_cache_line.\r\n\r\n    DELETE gt_cache WHERE id = iv_id.\r\n\r\n    ls_cache-id = iv_id.\r\n    ls_cache-object = io_reference.\r\n\r\n    CREATE OBJECT ls_cache-weak\r\n      EXPORTING\r\n        oref = ls_cache-object.\r\n\r\n    INSERT ls_cache INTO TABLE gt_cache.\r\n  ENDMETHOD.                    \"set\r\n\r\n  METHOD get.\r\n    FIELD-SYMBOLS:\r\n      &lt;ls_cache&gt; TYPE ty_cache_line.\r\n\r\n    READ TABLE gt_cache WITH TABLE KEY id = iv_id ASSIGNING &lt;ls_cache&gt;.\r\n    CHECK sy-subrc EQ 0.\r\n\r\n    ro_reference = &lt;ls_cache&gt;-weak-&gt;get( ).\r\n  ENDMETHOD.                    \"get\r\n\r\n  METHOD clear.\r\n    FIELD-SYMBOLS:\r\n      &lt;ls_cache&gt; TYPE ty_cache_line.\r\n\r\n    LOOP AT gt_cache ASSIGNING &lt;ls_cache&gt;.\r\n      CLEAR &lt;ls_cache&gt;-object.\r\n    ENDLOOP.\r\n  ENDMETHOD.                    \"to_weak\r\nENDCLASS.                    \"lcl_weak_cache IMPLEMENTATION\r\n\r\nCLASS lcl_cached_object DEFINITION.\r\n  PUBLIC SECTION.\r\n    METHODS:\r\n      constructor.\r\nENDCLASS.                    \"lcl_cached_object DEFINITION\r\n\r\nCLASS lcl_cached_object IMPLEMENTATION.\r\n  METHOD constructor.\r\n    \" \u0418\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430\r\n  ENDMETHOD.                    \"constructor\r\nENDCLASS.                    \"lcl_cached_object IMPLEMENTATION\r\n\r\nDATA:\r\n  go_cached_object TYPE REF TO lcl_cached_object,\r\n  gv_index TYPE string.\r\n\r\nSTART-OF-SELECTION.\r\n  DO 99999 TIMES.\r\n    gv_index = sy-index.\r\n    CONDENSE gv_index NO-GAPS.\r\n    CREATE OBJECT go_cached_object.\r\n    lcl_weak_cache=&gt;set( iv_id = gv_index\r\n                         io_reference = go_cached_object ).\r\n    CLEAR go_cached_object.\r\n  ENDDO.\r\n\r\n  lcl_weak_cache=&gt;clear( ).\r\n\r\n  go_cached_object ?= lcl_weak_cache=&gt;get( `1` ).<\/pre>\n<p>\u041a\u0430\u043a \u0440\u0430\u043d\u0435\u0435 \u0443\u0436\u0435 \u0443\u043f\u043e\u043c\u0438\u043d\u0430\u043b\u043e\u0441\u044c, \u043e\u0431\u044a\u0435\u043a\u0442 \u0431\u0443\u0434\u0435\u0442 \u0443\u0434\u0430\u043b\u0435\u043d \u0442\u043e\u0433\u0434\u0430 \u0441\u0431\u043e\u0440\u0449\u0438\u043a\u043e\u043c \u043c\u0443\u0441\u043e\u0440\u0430, \u043a\u043e\u0433\u0434\u0430 \u043d\u0430 \u043d\u0435\u0433\u043e \u043d\u0435\u0442 \u0441\u0438\u043b\u044c\u043d\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0438 \u0438 \u043c\u0435\u0442\u043e\u0434\u044b \u044d\u0442\u043e\u0433\u043e \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u044b \u0432 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0435\u0449\u0435 \u0436\u0438\u0432. \u0414\u0430\u043b\u0435\u0435 \u0440\u0430\u0441\u0441\u043c\u043e\u0442\u0440\u0438\u043c \u043f\u0440\u0438\u043c\u0435\u0440, \u0433\u0434\u0435 \u044d\u0442\u043e \u043f\u0440\u043e\u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f:<\/p>\n<pre class=\"lang:abap decode:true \">CLASS lcl_class_a DEFINITION.\r\n  PUBLIC SECTION.\r\n    EVENTS:\r\n      some_event EXPORTING value(some_data) TYPE string.\r\nENDCLASS.                    \"lcl_class_a DEFINITION\r\n\r\nCLASS lcl_class_a IMPLEMENTATION.\r\nENDCLASS.                    \"lcl_class_a IMPLEMENTATION\r\n\r\nCLASS lcl_class_b DEFINITION.\r\n  PUBLIC SECTION.\r\n    METHODS:\r\n      handler FOR EVENT some_event OF lcl_class_a.\r\nENDCLASS.                    \"lcl_class_b DEFINITION\r\n\r\nCLASS lcl_class_b IMPLEMENTATION.\r\n  METHOD handler.\r\n  ENDMETHOD.                    \"handler\r\nENDCLASS.                    \"lcl_class_b IMPLEMENTATION\r\n\r\nSTART-OF-SELECTION.\r\n\r\n  DATA:\r\n    lo_a TYPE REF TO lcl_class_a,\r\n    lo_b TYPE REF TO lcl_class_b.\r\n\r\n  CREATE OBJECT lo_a.\r\n  CREATE OBJECT lo_b.\r\n\r\n  SET HANDLER lo_b-&gt;handler FOR lo_a.\r\n  CLEAR lo_b.\r\n\r\n  cl_abap_memory_utilities=&gt;do_garbage_collection( ).\r\n\r\n  BREAK-POINT.<\/pre>\n<p>\u041f\u0435\u0440\u0435\u0439\u0434\u044f \u0432 \u043e\u0442\u043b\u0430\u0434\u0447\u0438\u043a\u0435 \u0432 \u0438\u043d\u0441\u0442\u0440\u0443\u043c\u0435\u043d\u0442 \u0430\u043d\u0430\u043b\u0438\u0437\u0430 \u043f\u0430\u043c\u044f\u0442\u0438 \u043c\u044b \u0443\u0432\u0438\u0434\u0438\u043c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0443\u044e \u043a\u0430\u0440\u0442\u0438\u043d\u0443:<\/p>\n<p><a href=\"http:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/2.png\"><img loading=\"lazy\" class=\"alignnone size-full wp-image-2566\" src=\"http:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/2.png\" alt=\"2\" width=\"860\" height=\"257\" srcset=\"https:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/2.png 860w, https:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/2-300x90.png 300w\" sizes=\"(max-width: 860px) 100vw, 860px\" \/><\/a><\/p>\n<p>\u041a\u0430\u043a \u0432\u0438\u0434\u043d\u043e \u0438\u0437 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0438, \u043e\u0431\u044a\u0435\u043a\u0442 \u043f\u0430\u043c\u044f\u0442\u0438, \u0441\u0441\u044b\u043b\u0430\u044e\u0449\u0438\u0439\u0441\u044f \u043d\u0430 \u044d\u043a\u0437\u0435\u043c\u043f\u043b\u044f\u0440 \u043a\u043b\u0430\u0441\u0441\u0430 b \u0436\u0438\u0432, \u043d\u0435\u0441\u043c\u043e\u0442\u0440\u044f \u043d\u0430 \u0442\u043e, \u0447\u0442\u043e \u0431\u044b\u043b \u0432\u044b\u0437\u0432\u0430\u043d \u0441\u0431\u043e\u0440\u0449\u0438\u043a \u043c\u0443\u0441\u043e\u0440\u0430.<\/p>\n<p>\u0414\u043e\u0431\u0430\u0432\u0438\u0432 \u0434\u0435\u0430\u043a\u0442\u0438\u0432\u0430\u0446\u0438\u044e \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0438 \u043d\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u0435, \u043c\u044b \u0443\u0431\u0435\u0434\u0438\u043c\u0441\u044f, \u0447\u0442\u043e \u043e\u043f\u0438\u0441\u0430\u043d\u043d\u043e\u0435 \u0440\u0430\u043d\u0435\u0435 \u043f\u0440\u0430\u0432\u0438\u043b\u043e \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u0438 \u043e\u0431\u044a\u0435\u043a\u0442 \u0431\u0443\u0434\u0435\u0442 \u0443\u0434\u0430\u043b\u0435\u043d, \u0435\u0441\u043b\u0438 \u0432 \u043d\u0435\u043c \u043d\u0435\u0442 \u043f\u043e\u0434\u043f\u0438\u0441\u043a\u0438 \u043d\u0430 \u0441\u043e\u0431\u044b\u0442\u0438\u044f \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043a\u043b\u0430\u0441\u0441\u0430 \u00ab\u0410\u00bb:<\/p>\n<p><a href=\"http:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/3.png\"><img loading=\"lazy\" class=\"alignnone size-full wp-image-2567\" src=\"http:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/3.png\" alt=\"3\" width=\"868\" height=\"255\" srcset=\"https:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/3.png 868w, https:\/\/abap-blog.ru\/wp-content\/uploads\/2015\/07\/3-300x88.png 300w\" sizes=\"(max-width: 868px) 100vw, 868px\" \/><\/a><\/p>\n","protected":false},"excerpt":{"rendered":"<p>\u041f\u043e\u043d\u044f\u0442\u0438\u0435 \u0441\u043b\u0430\u0431\u043e\u0439 \u0441\u0441\u044b\u043b\u043a\u0438 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0432 \u0441\u0438\u0441\u0442\u0435\u043c\u0430\u0445 \u0438\u00a0\u044f\u0437\u044b\u043a\u0430\u0445 \u043f\u0440\u043e\u0433\u0440\u0430\u043c\u043c\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, \u0433\u0434\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f\u00a0\u0441\u0431\u043e\u0440\u043a\u0430 \u043c\u0443\u0441\u043e\u0440\u0430\u00a0\u2014 \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u0438\u0437\u00a0\u043f\u0430\u043c\u044f\u0442\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 \u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u043f\u0440\u0435\u043a\u0440\u0430\u0442\u0438\u043b\u043e\u0441\u044c \u0438 \u0431\u043e\u043b\u0435\u0435 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0432\u043e\u0437\u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e. \u0414\u0430\u043b\u0435\u0435 \u0432 \u0441\u0442\u0430\u0442\u044c\u0435 \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0441\u0441\u043c\u043e\u0442\u0440\u0435\u043d\u0430 \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u044f \u0441\u043b\u0430\u0431\u044b\u0445 \u0441\u0441\u044b\u043b\u043e\u043a \u0432 ABAP.<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":[],"categories":[318],"tags":[],"_links":{"self":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts\/2560"}],"collection":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/comments?post=2560"}],"version-history":[{"count":5,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts\/2560\/revisions"}],"predecessor-version":[{"id":2568,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts\/2560\/revisions\/2568"}],"wp:attachment":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/media?parent=2560"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/categories?post=2560"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/tags?post=2560"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}