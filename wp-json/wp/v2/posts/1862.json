{"id":1862,"date":"2014-03-03T08:57:07","date_gmt":"2014-03-03T04:57:07","guid":{"rendered":"http:\/\/abap-blog.ru\/?p=1862"},"modified":"2021-03-02T10:10:17","modified_gmt":"2021-03-02T06:10:17","slug":"sdelat-snimok-ekrana","status":"publish","type":"post","link":"https:\/\/abap-blog.ru\/osnovy-abap\/sdelat-snimok-ekrana\/","title":{"rendered":"\u0421\u0434\u0435\u043b\u0430\u0442\u044c \u0441\u043d\u0438\u043c\u043e\u043a \u044d\u043a\u0440\u0430\u043d\u0430"},"content":{"rendered":"<pre class=\"lang:abap decode:true \">DATA:\r\n  gv_mime_type TYPE string,\r\n  gv_image     TYPE xstring,\r\n  gt_tabimg    TYPE STANDARD TABLE OF x,\r\n  gv_path      TYPE string,\r\n  gv_full_path TYPE string,\r\n  gv_useraction TYPE i,\r\n  gv_name      TYPE string.\r\n\r\ncl_gui_frontend_services=&gt;get_screenshot(\r\n  IMPORTING\r\n    mime_type_str        = gv_mime_type\r\n    image                = gv_image\r\n  EXCEPTIONS\r\n    access_denied        = 1\r\n    cntl_error           = 2\r\n    error_no_gui         = 3\r\n    not_supported_by_gui = 4\r\n    OTHERS               = 5\r\n).\r\nIF sy-subrc &lt;&gt; 0.\r\n  MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno\r\n             WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.\r\nENDIF.\r\n\r\ncl_gui_frontend_services=&gt;file_save_dialog(\r\n  EXPORTING\r\n    window_title              = '\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435'\r\n    default_extension         = 'png'\r\n    default_file_name         = 'screenshot'\r\n    prompt_on_overwrite       = 'X'\r\n  CHANGING\r\n    path                      = gv_path\r\n    filename                  = gv_name\r\n    fullpath                  = gv_full_path\r\n    user_action               = gv_useraction\r\n  EXCEPTIONS\r\n    cntl_error                = 1\r\n    error_no_gui              = 2\r\n    not_supported_by_gui      = 3\r\n    invalid_default_file_name = 4\r\n    OTHERS                    = 5\r\n).\r\n\r\nIF sy-subrc &lt;&gt; 0.\r\n  MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno\r\n             WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.\r\nENDIF.\r\n\r\nIF gv_useraction = cl_gui_frontend_services=&gt;action_ok.\r\n\r\n  CALL FUNCTION 'SCMS_XSTRING_TO_BINARY'\r\n    EXPORTING\r\n      buffer     = gv_image\r\n    TABLES\r\n      binary_tab = gt_tabimg.\r\n\r\n  cl_gui_frontend_services=&gt;gui_download(\r\n    EXPORTING\r\n      filename                  = gv_full_path\r\n      filetype                  = 'BIN'\r\n    CHANGING\r\n      data_tab                  = gt_tabimg\r\n    EXCEPTIONS\r\n      OTHERS                    = 99\r\n  ).\r\n\r\nENDIF.<\/pre>\n<p><a href=\"http:\/\/help.sap.com\/saphelp_snc700_ehp01\/helpdata\/en\/42\/6b0314c312415b9e668e02cc31420f\/content.htm?frameset=\/en\/42\/6b0314c312415b9e668e02cc31420f\/frameset.htm\" target=\"_blank\" rel=\"noopener\">\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\u0430\u0446\u0438\u044f<\/a>\u00a0\u043f\u043e \u043c\u0435\u0442\u043e\u0434\u0443.<\/p>\n","protected":false},"excerpt":{"rendered":"<p>DATA: gv_mime_type TYPE string, gv_image TYPE xstring, gt_tabimg TYPE STANDARD TABLE OF x, gv_path TYPE string, gv_full_path TYPE string, gv_useraction TYPE i, gv_name TYPE string. cl_gui_frontend_services=&gt;get_screenshot( IMPORTING mime_type_str = gv_mime_type image = gv_image EXCEPTIONS access_denied = 1 cntl_error = 2 error_no_gui = 3 not_supported_by_gui = 4 OTHERS = 5 ). IF sy-subrc &lt;&gt; 0. MESSAGE [&hellip;]<\/p>\n","protected":false},"author":1,"featured_media":0,"comment_status":"open","ping_status":"closed","sticky":false,"template":"","format":"standard","meta":[],"categories":[305],"tags":[286,287],"_links":{"self":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts\/1862"}],"collection":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/comments?post=1862"}],"version-history":[{"count":6,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts\/1862\/revisions"}],"predecessor-version":[{"id":6512,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/posts\/1862\/revisions\/6512"}],"wp:attachment":[{"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/media?parent=1862"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/categories?post=1862"},{"taxonomy":"post_tag","embeddable":true,"href":"https:\/\/abap-blog.ru\/wp-json\/wp\/v2\/tags?post=1862"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}