<!DOCTYPE html>
<html lang="ru-RU" id="html">
<head>
		<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="profile" href="../../xfn/11.html">
	<link rel="pingback" href="https://abap-blog.ru/xmlrpc.php">
	<title>ABAP Blog | Оконные функции в ABAP</title>

		<!-- All in One SEO 4.1.4.4 -->
		<meta name="description" content="Начиная с версии ABAP 7.54 в ABAP SQL появились так называемые оконные выражения. Оконные выражения — SQL выражения определяемые с помощью дополнения OVER в запросе, позволяют определить окна, как подмножества итогового результата запроса и выполнять над ним оконные функции. Оконные функции можно сравнить с агрегатными функциями, но, в отличие от обычной агрегатной функции, при использовании […]">
		<meta name="robots" content="max-image-preview:large">
		<meta name="keywords" content="работа с бд">
		<link rel="canonical" href="index.htm">
		<script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"https:\/\/abap-blog.ru\/#website","url":"https:\/\/abap-blog.ru\/","name":"ABAP Blog","description":"\u0412\u0441\u0435 \u043e \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0432 \u0440\u0435\u0448\u0435\u043d\u0438\u044f\u0445 \u043e\u0442 SAP","inLanguage":"ru-RU","publisher":{"@id":"https:\/\/abap-blog.ru\/#person"}},{"@type":"Person","@id":"https:\/\/abap-blog.ru\/#person","name":"Astrafox","image":{"@type":"ImageObject","@id":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/#personImage","url":"https:\/\/secure.gravatar.com\/avatar\/907cc9d3a027be8998658f18c0a7fa4e?s=96&d=retro&r=g","width":96,"height":96,"caption":"Astrafox"}},{"@type":"BreadcrumbList","@id":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"https:\/\/abap-blog.ru\/#listItem","position":1,"item":{"@type":"WebPage","@id":"https:\/\/abap-blog.ru\/","name":"\u0413\u043b\u0430\u0432\u043d\u0430\u044f","description":"\u0412\u0441\u0435 \u043e \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0432 SAP \u0440\u0435\u0448\u0435\u043d\u0438\u044f\u0445: ABAP, HANA, UI5, OData, Fiori.","url":"https:\/\/abap-blog.ru\/"},"nextItem":"https:\/\/abap-blog.ru\/database-work\/#listItem"},{"@type":"ListItem","@id":"https:\/\/abap-blog.ru\/database-work\/#listItem","position":2,"item":{"@type":"WebPage","@id":"https:\/\/abap-blog.ru\/database-work\/","name":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0411\u0414","description":"\u041d\u0430\u0447\u0438\u043d\u0430\u044f \u0441 \u0432\u0435\u0440\u0441\u0438\u0438 ABAP 7.54 \u0432 ABAP SQL \u043f\u043e\u044f\u0432\u0438\u043b\u0438\u0441\u044c \u0442\u0430\u043a \u043d\u0430\u0437\u044b\u0432\u0430\u0435\u043c\u044b\u0435 \u043e\u043a\u043e\u043d\u043d\u044b\u0435 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f. \u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u2014 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c\u044b\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f OVER \u0432 \u0437\u0430\u043f\u0440\u043e\u0441\u0435, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043e\u043a\u043d\u0430, \u043a\u0430\u043a \u043f\u043e\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 \u0438\u0442\u043e\u0433\u043e\u0432\u043e\u0433\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043d\u0430\u0434 \u043d\u0438\u043c \u043e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438. \u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043c\u043e\u0436\u043d\u043e \u0441\u0440\u0430\u0432\u043d\u0438\u0442\u044c \u0441 \u0430\u0433\u0440\u0435\u0433\u0430\u0442\u043d\u044b\u043c\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u044f\u043c\u0438, \u043d\u043e, \u0432 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 \u043e\u0431\u044b\u0447\u043d\u043e\u0439 \u0430\u0433\u0440\u0435\u0433\u0430\u0442\u043d\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0438, \u043f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 [\u2026]","url":"https:\/\/abap-blog.ru\/database-work\/"},"nextItem":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/#listItem","previousItem":"https:\/\/abap-blog.ru\/#listItem"},{"@type":"ListItem","@id":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/#listItem","position":3,"item":{"@type":"WebPage","@id":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/","name":"\u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0432 ABAP","description":"\u041d\u0430\u0447\u0438\u043d\u0430\u044f \u0441 \u0432\u0435\u0440\u0441\u0438\u0438 ABAP 7.54 \u0432 ABAP SQL \u043f\u043e\u044f\u0432\u0438\u043b\u0438\u0441\u044c \u0442\u0430\u043a \u043d\u0430\u0437\u044b\u0432\u0430\u0435\u043c\u044b\u0435 \u043e\u043a\u043e\u043d\u043d\u044b\u0435 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f. \u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u2014 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c\u044b\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f OVER \u0432 \u0437\u0430\u043f\u0440\u043e\u0441\u0435, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043e\u043a\u043d\u0430, \u043a\u0430\u043a \u043f\u043e\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 \u0438\u0442\u043e\u0433\u043e\u0432\u043e\u0433\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043d\u0430\u0434 \u043d\u0438\u043c \u043e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438. \u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043c\u043e\u0436\u043d\u043e \u0441\u0440\u0430\u0432\u043d\u0438\u0442\u044c \u0441 \u0430\u0433\u0440\u0435\u0433\u0430\u0442\u043d\u044b\u043c\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u044f\u043c\u0438, \u043d\u043e, \u0432 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 \u043e\u0431\u044b\u0447\u043d\u043e\u0439 \u0430\u0433\u0440\u0435\u0433\u0430\u0442\u043d\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0438, \u043f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 [\u2026]","url":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/"},"previousItem":"https:\/\/abap-blog.ru\/database-work\/#listItem"}]},{"@type":"Person","@id":"https:\/\/abap-blog.ru\/author\/admin\/#author","url":"https:\/\/abap-blog.ru\/author\/admin\/","name":"Astrafox","image":{"@type":"ImageObject","@id":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/#authorImage","url":"https:\/\/secure.gravatar.com\/avatar\/907cc9d3a027be8998658f18c0a7fa4e?s=96&d=retro&r=g","width":96,"height":96,"caption":"Astrafox"}},{"@type":"WebPage","@id":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/#webpage","url":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/","name":"ABAP Blog | \u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0432 ABAP","description":"\u041d\u0430\u0447\u0438\u043d\u0430\u044f \u0441 \u0432\u0435\u0440\u0441\u0438\u0438 ABAP 7.54 \u0432 ABAP SQL \u043f\u043e\u044f\u0432\u0438\u043b\u0438\u0441\u044c \u0442\u0430\u043a \u043d\u0430\u0437\u044b\u0432\u0430\u0435\u043c\u044b\u0435 \u043e\u043a\u043e\u043d\u043d\u044b\u0435 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f. \u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u2014 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c\u044b\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f OVER \u0432 \u0437\u0430\u043f\u0440\u043e\u0441\u0435, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043e\u043a\u043d\u0430, \u043a\u0430\u043a \u043f\u043e\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 \u0438\u0442\u043e\u0433\u043e\u0432\u043e\u0433\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043d\u0430\u0434 \u043d\u0438\u043c \u043e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438. \u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043c\u043e\u0436\u043d\u043e \u0441\u0440\u0430\u0432\u043d\u0438\u0442\u044c \u0441 \u0430\u0433\u0440\u0435\u0433\u0430\u0442\u043d\u044b\u043c\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u044f\u043c\u0438, \u043d\u043e, \u0432 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 \u043e\u0431\u044b\u0447\u043d\u043e\u0439 \u0430\u0433\u0440\u0435\u0433\u0430\u0442\u043d\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0438, \u043f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 [\u2026]","inLanguage":"ru-RU","isPartOf":{"@id":"https:\/\/abap-blog.ru\/#website"},"breadcrumb":{"@id":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/#breadcrumblist"},"author":"https:\/\/abap-blog.ru\/author\/admin\/#author","creator":"https:\/\/abap-blog.ru\/author\/admin\/#author","datePublished":"2021-02-28T10:41:22+04:00","dateModified":"2021-03-21T13:13:55+04:00"},{"@type":"Article","@id":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/#article","name":"ABAP Blog | \u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0432 ABAP","description":"\u041d\u0430\u0447\u0438\u043d\u0430\u044f \u0441 \u0432\u0435\u0440\u0441\u0438\u0438 ABAP 7.54 \u0432 ABAP SQL \u043f\u043e\u044f\u0432\u0438\u043b\u0438\u0441\u044c \u0442\u0430\u043a \u043d\u0430\u0437\u044b\u0432\u0430\u0435\u043c\u044b\u0435 \u043e\u043a\u043e\u043d\u043d\u044b\u0435 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f. \u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u2014 SQL \u0432\u044b\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u043c\u044b\u0435 \u0441 \u043f\u043e\u043c\u043e\u0449\u044c\u044e \u0434\u043e\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f OVER \u0432 \u0437\u0430\u043f\u0440\u043e\u0441\u0435, \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u044e\u0442 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0438\u0442\u044c \u043e\u043a\u043d\u0430, \u043a\u0430\u043a \u043f\u043e\u0434\u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0430 \u0438\u0442\u043e\u0433\u043e\u0432\u043e\u0433\u043e \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0437\u0430\u043f\u0440\u043e\u0441\u0430 \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0442\u044c \u043d\u0430\u0434 \u043d\u0438\u043c \u043e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438. \u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u043c\u043e\u0436\u043d\u043e \u0441\u0440\u0430\u0432\u043d\u0438\u0442\u044c \u0441 \u0430\u0433\u0440\u0435\u0433\u0430\u0442\u043d\u044b\u043c\u0438 \u0444\u0443\u043d\u043a\u0446\u0438\u044f\u043c\u0438, \u043d\u043e, \u0432 \u043e\u0442\u043b\u0438\u0447\u0438\u0435 \u043e\u0442 \u043e\u0431\u044b\u0447\u043d\u043e\u0439 \u0430\u0433\u0440\u0435\u0433\u0430\u0442\u043d\u043e\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u0438, \u043f\u0440\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0438 [\u2026]","inLanguage":"ru-RU","headline":"\u041e\u043a\u043e\u043d\u043d\u044b\u0435 \u0444\u0443\u043d\u043a\u0446\u0438\u0438 \u0432 ABAP","author":{"@id":"https:\/\/abap-blog.ru\/author\/admin\/#author"},"publisher":{"@id":"https:\/\/abap-blog.ru\/#person"},"datePublished":"2021-02-28T10:41:22+04:00","dateModified":"2021-03-21T13:13:55+04:00","articleSection":"\u0420\u0430\u0431\u043e\u0442\u0430 \u0441 \u0411\u0414","mainEntityOfPage":{"@id":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/#webpage"},"isPartOf":{"@id":"https:\/\/abap-blog.ru\/database-work\/window-functions-abap\/#webpage"},"image":{"@type":"ImageObject","@id":"https:\/\/abap-blog.ru\/#articleImage","url":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/img_5eb70b2cd8ccb-1.png","width":495,"height":276}}]}
		</script>
		<script type="text/javascript">
			window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
			ga('create', "UA-150412824-1", { 'cookieDomain': 'abap-blog.ru' } );
			ga('require', 'outboundLinkTracker');
			ga('send', 'pageview');
		</script>
		<script async="" src="../../analytics.js"></script>
		<script async="" src="../../wp-content/plugins/all-in-one-seo-pack/app/Common/Assets/js/autotrack.js?ver=4.1.4.4"></script>
		<!-- All in One SEO -->

<link rel='dns-prefetch' href='../../index-1.htm'>
<link rel='dns-prefetch' href='//fonts.googleapis.com'>
<link rel='dns-prefetch' href='../../index-2.htm'>
<link rel="alternate" type="application/rss+xml" title="ABAP Blog &raquo; Лента" href="../../feed/index.htm.rss">
<link rel="alternate" type="application/rss+xml" title="ABAP Blog &raquo; Лента комментариев" href="../../comments/feed/index.htm.rss">
<link rel="alternate" type="application/rss+xml" title="ABAP Blog &raquo; Лента комментариев к &laquo;Оконные функции в ABAP&raquo;" href="feed/index.htm.rss">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/abap-blog.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.1"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css?ver=2.8.22' media='all'>
<link rel='stylesheet' id='crayon-theme-abapblog-css' href='../../wp-content/uploads/urvanov-syntax-highlighter/themes/abapblog/abapblog.css?ver=2.8.22' media='all'>
<link rel='stylesheet' id='crayon-theme-abapblog-syntax-css' href='../../wp-content/uploads/urvanov-syntax-highlighter/themes/abapblog-syntax/abapblog-syntax.css?ver=2.8.22' media='all'>
<link rel='stylesheet' id='crayon-font-monospace-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/fonts/monospace.css?ver=2.8.22' media='all'>
<link rel='stylesheet' id='wp-block-library-css' href='../../wp-includes/css/dist/block-library/style.min.css?ver=5.8.1' media='all'>
<link rel='stylesheet' id='arve-main-css' href='../../wp-content/plugins/advanced-responsive-video-embedder/build/main.css?ver=b809f4d4c33c91a5ae3a5099af09bdde' media='all'>
<link rel='stylesheet' id='contact-form-7-css' href='../../wp-content/plugins/contact-form-7/includes/css/styles.css?ver=5.5.1' media='all'>
<link rel='stylesheet' id='bg-shce-genericons-css' href='../../wp-content/plugins/show-hidecollapse-expand/assets/css/genericons/genericons.css?ver=5.8.1' media='all'>
<link rel='stylesheet' id='bg-show-hide-css' href='../../wp-content/plugins/show-hidecollapse-expand/assets/css/bg-show-hide.css?ver=5.8.1' media='all'>
<link rel='stylesheet' id='dashicons-css' href='../../wp-includes/css/dashicons.min.css?ver=5.8.1' media='all'>
<link rel='stylesheet' id='tooltip-css' href='../../wp-content/plugins/wp-poll/assets/tool-tip.min.css?ver=5.8.1' media='all'>
<link rel='stylesheet' id='wpp-front-cb-css' href='../../wp-content/plugins/wp-poll/assets/front/css/checkbox.css?ver=5.8.1' media='all'>
<link rel='stylesheet' id='wpp-front-css' href='../../wp-content/plugins/wp-poll/assets/front/css/style.css?ver=5.8.1' media='all'>
<link rel='stylesheet' id='flat-fonts-css' href='../../css.css?family=Lobster%7CRoboto:400,700%7CRoboto+Slab%7CRoboto%20Condensed' media='all'>
<link rel='stylesheet' id='flat-theme-css' href='../../wp-content/themes/flat/assets/css/flat.css?ver=1.7.11' media='all'>
<link rel='stylesheet' id='flat-style-css' href='../../wp-content/themes/flat/style.css?ver=5.8.1' media='all'>
<link rel='stylesheet' id='slb_core-css' href='../../wp-content/plugins/simple-lightbox/client/css/app.css?ver=2.8.1' media='all'>
<link rel='stylesheet' id='decent-comments-widget-css' href='../../wp-content/plugins/decent-comments/css/decent-comments-widget.css' media='all'>
<script src='../../wp-includes/js/jquery/jquery.min.js?ver=3.6.0' id='jquery-core-js'></script>
<script src='../../wp-includes/js/jquery/jquery-migrate.min.js?ver=3.3.2' id='jquery-migrate-js'></script>
<script type='text/javascript' id='urvanov_syntax_highlighter_js-js-extra'>
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.22","is_admin":"0","ajaxurl":"https:\/\/abap-blog.ru\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"\u041d\u0430\u0436\u043c\u0438\u0442\u0435 %s \u0434\u043b\u044f \u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f, %s \u0434\u043b\u044f \u0432\u0441\u0442\u0430\u0432\u043a\u0438","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script src='../../wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js?ver=2.8.22' id='urvanov_syntax_highlighter_js-js'></script>
<script src='../../wp-includes/js/dist/vendor/regenerator-runtime.min.js?ver=0.13.7' id='regenerator-runtime-js'></script>
<script src='../../wp-includes/js/dist/vendor/wp-polyfill.min.js?ver=3.15.0' id='wp-polyfill-js'></script>
<script async="async" src='../../wp-content/plugins/advanced-responsive-video-embedder/build/main.js?ver=b809f4d4c33c91a5ae3a5099af09bdde' id='arve-main-js'></script>
<script src='../../wp-content/plugins/wp-poll/assets/front/js/svgcheckbx.js?ver=5.8.1' id='wpp-front-cb-js'></script>
<script type='text/javascript' id='wpp-front-js-extra'>
/* <![CDATA[ */
var wpp_object = {"ajaxurl":"https:\/\/abap-blog.ru\/wp-admin\/admin-ajax.php","copyText":"Copied !","voteText":"Vote(s)","tempProDownload":"https:\/\/pluginbazar.com\/my-account\/downloads\/","tempProDownloadTxt":"Download Version 1.1.0"};
/* ]]> */
</script>
<script src='../../wp-content/plugins/wp-poll/assets/front/js/scripts.js?ver=5.8.1' id='wpp-front-js'></script>
<script src='../../wp-content/themes/flat/assets/js/flat.js?ver=1.7.11' id='flat-js-js'></script>
<!--[if lt IE 9]>
<script src='https://abap-blog.ru/wp-content/themes/flat/assets/js/html5shiv.min.js?ver=3.7.2' id='html5shiv-js'></script>
<![endif]-->
<link rel="https://api.w.org/" href="../../wp-json/index.htm.json"><link rel="alternate" type="application/json" href="../../wp-json/wp/v2/posts/6331.json"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc.php.xml?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.8.1">
<link rel='shortlink' href='index.htm?p=6331'>
<link rel="alternate" type="application/json+oembed" href="../../wp-json/oembed/1.0/embed-76.json?url=https%3A%2F%2Fabap-blog.ru%2Fdatabase-work%2Fwindow-functions-abap%2F">
<link rel="alternate" type="text/xml+oembed" href="../../wp-json/oembed/1.0/embed-76.xml?url=https%3A%2F%2Fabap-blog.ru%2Fdatabase-work%2Fwindow-functions-abap%2F&#038;format=xml">

<!-- WP Youtube Player 1.7 by unijimpe -->
<style type="text/css">#page:before, .sidebar-offcanvas, #secondary { background-color: #272727; }@media (max-width: 1199px) { #page &gt; .container { background-color: #272727; } }body { background-size: initial; }</style><style type="text/css">#masthead .site-title {font-family:Lobster}body {font-family:Roboto }h1,h2,h3,h4,h5,h6 {font-family:Roboto Slab}#masthead .site-description, .hentry .entry-meta {font-family:Roboto Condensed}</style><style type="text/css" media="screen">body{position:relative}#dynamic-to-top{display:none;overflow:hidden;width:auto;z-index:90;position:fixed;bottom:20px;right:20px;top:auto;left:auto;font-family:sans-serif;font-size:1em;color:#fff;text-decoration:none;text-shadow:0 1px 0 #333;font-weight:bold;padding:17px 16px;border:2px solid #000;background:#4c5055;-webkit-background-origin:border;-moz-background-origin:border;-icab-background-origin:border;-khtml-background-origin:border;-o-background-origin:border;background-origin:border;-webkit-background-clip:padding-box;-moz-background-clip:padding-box;-icab-background-clip:padding-box;-khtml-background-clip:padding-box;-o-background-clip:padding-box;background-clip:padding-box;-webkit-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-ms-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-moz-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-o-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-khtml-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-icab-box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );box-shadow:0 1px 3px rgba( 0, 0, 0, 0.4 ), inset 0 0 0 1px rgba( 0, 0, 0, 0.2 ), inset 0 1px 0 rgba( 255, 255, 255, .4 ), inset 0 10px 10px rgba( 255, 255, 255, .1 );-webkit-border-radius:30px;-moz-border-radius:30px;-icab-border-radius:30px;-khtml-border-radius:30px;border-radius:30px}#dynamic-to-top:hover{background:#4fd650;background:#4c5055 -webkit-gradient( linear, 0% 0%, 0% 100%, from( rgba( 255, 255, 255, .2 ) ), to( rgba( 0, 0, 0, 0 ) ) );background:#4c5055 -webkit-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 -khtml-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 -moz-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 -o-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 -ms-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 -icab-linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 linear-gradient( top, rgba( 255, 255, 255, .2 ), rgba( 0, 0, 0, 0 ) );cursor:pointer}#dynamic-to-top:active{background:#4c5055;background:#4c5055 -webkit-gradient( linear, 0% 0%, 0% 100%, from( rgba( 0, 0, 0, .3 ) ), to( rgba( 0, 0, 0, 0 ) ) );background:#4c5055 -webkit-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 -moz-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 -khtml-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 -o-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 -ms-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 -icab-linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) );background:#4c5055 linear-gradient( top, rgba( 0, 0, 0, .1 ), rgba( 0, 0, 0, 0 ) )}#dynamic-to-top,#dynamic-to-top:active,#dynamic-to-top:focus,#dynamic-to-top:hover{outline:none}#dynamic-to-top span{display:block;overflow:hidden;width:14px;height:12px;background:url( ../../wp-content/plugins/dynamic-to-top/css/images/up.png )no-repeat center center}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-image: url("../../wp-content/uploads/2014/10/escheresque_ste.png"); background-position: left top; background-size: auto; background-repeat: repeat; background-attachment: scroll; }
</style>
		</head>

<body class="post-template-default single single-post postid-6331 single-format-standard custom-background" itemscope="" itemtype="http://schema.org/WebPage">
		<div id="page">
	<div class="container">
		<div class="row row-offcanvas row-offcanvas-left" style="background: #272727;">			
			
			<div id="secondary1" class="col-lg-t" style="background: #272727; display:none">
								<header id="masthead1" class="site-headerex" role="banner">
										<div class="hgroupex">
						<h1 class="site-title display-title"><a href="../../index.htm" title="ABAP Blog" rel="home"><span itemprop="name">ABAP Blog</span></a></h1><h2 itemprop="description" class="site-description">Все о разработке в решениях от SAP</h2>					</div>
									</header>
							</div>


			<div id="secondary" class="col-lg-3" style="display:block">
								<header id="masthead" class="site-header" role="banner">
										<div class="hgroup">
						<h1 class="site-title display-title"><a href="../../index.htm" title="ABAP Blog" rel="home"><span itemprop="name">ABAP Blog</span></a></h1><h2 itemprop="description" class="site-description">Все о разработке в решениях от SAP</h2>					</div>
					<button type="button" class="btn btn-link hidden-lg toggle-sidebar" data-toggle="offcanvas" aria-label="Sidebar"><i class="fa fa-gear"></i></button>
					<button type="button" class="btn btn-link hidden-lg toggle-navigation" aria-label="Navigation Menu"><i class="fa fa-bars"></i></button>
					<nav id="site-navigation" class="navigation main-navigation" role="navigation">
						<ul id="menu-glavnoe-menyu" class="nav-menu"><li id="menu-item-2313" class="fa fa-home menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-has-children menu-item-2313"><a href="../../index.htm">Главная</a>
<ul class="sub-menu">
	<li id="menu-item-2363" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-2363"><a href="../../category/osnovy-abap/index.htm">Основы ABAP</a>
	<ul class="sub-menu">
		<li id="menu-item-2906" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2906"><a href="../../category/osnovy-abap/oop/index.htm">ABAP Objects</a></li>
		<li id="menu-item-2370" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2370"><a href="../../category/osnovy-abap/slovar/index.htm">ABAP Словарь</a></li>
		<li id="menu-item-2367" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2367"><a href="../../category/osnovy-abap/files/index.htm">Работа с файлами</a></li>
		<li id="menu-item-2364" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2364"><a href="../../category/osnovy-abap/sap-dynpro/index.htm">SAP Dynpro</a></li>
		<li id="menu-item-6845" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6845"><a href="../../category/osnovy-abap/vnutrennie-tablicy/index.htm">Внутренние таблицы</a></li>
		<li id="menu-item-6849" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6849"><a href="../../category/osnovy-abap/dinamicheskoe-programmirovanie/index.htm">Динамическое программирование</a></li>
	</ul>
</li>
	<li id="menu-item-2366" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-2366"><a href="../../category/database-work/index.htm">Работа с БД</a>
	<ul class="sub-menu">
		<li id="menu-item-7303" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7303"><a href="../../category/hana/index.htm">HANA</a></li>
	</ul>
</li>
	<li id="menu-item-2368" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-2368"><a href="../../category/network/index.htm">Сетевые технологии</a>
	<ul class="sub-menu">
		<li id="menu-item-6328" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6328"><a href="../../category/network/ui5fiori/index.htm">UI5 &amp; Fiori</a></li>
		<li id="menu-item-6327" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6327"><a href="../../category/network/odata-network/index.htm">OData</a></li>
		<li id="menu-item-2907" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2907"><a href="../../category/network/web-dynpro/index.htm">Web Dynpro</a></li>
	</ul>
</li>
	<li id="menu-item-2369" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2369"><a href="../../category/enhancements/index.htm">Расширения</a></li>
	<li id="menu-item-6329" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6329"><a href="../../category/abap-cloud/index.htm">ABAP Cloud</a></li>
	<li id="menu-item-2365" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2365"><a href="../../category/others/index.htm">Прочее</a></li>
</ul>
</li>
<li id="menu-item-3536" class="fa fa-bell menu-item menu-item-type-post_type menu-item-object-page menu-item-3536"><a href="../../abap-the-best-practice/index.htm">ABAP Best Practice</a></li>
<li id="menu-item-3727" class="fa fa-child menu-item menu-item-type-post_type menu-item-object-page menu-item-3727"><a href="../../vakansii/index.htm">Вакансии ABAP</a></li>
<li id="menu-item-3885" class="fa fa-bookmark menu-item menu-item-type-post_type menu-item-object-page menu-item-3885"><a href="../../abap-notes/index.htm">Быстрые заметки</a></li>
<li id="menu-item-2316" class="fa fa-info-circle menu-item menu-item-type-post_type menu-item-object-page menu-item-2316"><a href="../../about/index.htm">Обо мне</a></li>
</ul>					</nav>
									</header>
				
				<div class="sidebar-offcanvas">
<div id="main-sidebar" class="widget-area" role="complementary">
											<aside id="search-2" class="widget widget_search">
	<form method="get" id="searchform" action="https://abap-blog.ru/">
		<label for="s" class="assistive-text">Поиск</label>
		<input type="text" class="field" name="s" id="s" placeholder="Поиск">
		<input type="submit" class="submit" name="submit" id="searchsubmit" value="Поиск">
	</form>
					</aside>
					<aside id="linkcat-2" class="widget widget_links">
						<h3 class='widget-title'>Ссылки</h3>

	<ul class='xoxo blogroll'>
<li><a href="../../topics/abap.html" target="_blank">ABAP Community</a></li>
<li><a href="../../wiki/display/ABAP/ABAP Development.html" title="Wiki по ABAP" target="_blank">ABAP Development Wiki</a></li>
<li><a href="../../doc/abapdocu_latest_index_htm/latest/en-US/index.htm" title="Последняя версия справки по ABAP" target="_blank">ABAP Help</a></li>
<li><a href="../../doc/abapdocu_cp_index_htm/CLOUD/en-US/index.htm" target="_blank">ABAP Help (Cloud)</a></li>
<li><a href="../../learning-journeys/overview.html?role=Developer" target="_blank">Developer Learning Journeys</a></li>
<li><a href="../../index-3.htm" target="_blank">Open Source Projects</a></li>
<li><a href="../../tutorial-navigator.html" target="_blank">SAP Tutorials</a></li>
<li><a href="https://t.me/abapblog" target="_blank"><img src="../../wp-content/uploads/2020/04/telegram-1.png" alt="Канал в Telegram"> Канал в Telegram</a></li>

	</ul>
					</aside>

					<aside id="endo_wrc_widget-2" class="widget widget_endo_wrc_widget">
						<h3 class='widget-title'>Цитаты</h3>
<p>Я мог бы перечислить все признаки, присущие чистому коду, но существует один важнейший признак, из которого следуют все остальные. Чистый код всегда выглядит так, словно его автор над ним тщательно потрудился. Вы не найдете никаких очевидных возможностей для его улучшения. Все они уже были продуманы автором кода. Попытавшись представить возможные усовершенствования, вы снова придете к тому, с чего все началось: вы рассматриваете код, тщательно продуманный и написанный настоящим мастером, небезразличным к своему ремеслу.</p>
<p><strong>М. Физерс</strong></p>
					</aside>
								<aside id="custom-post-type-recent-posts-3" class="widget widget_recent_entries">
						<h3 class='widget-title'>Новое</h3>
			<ul>
													<li>
										<a href="../../abap-notes/poluchenie-instancii-cl_gui_alv_grid-dlya-salv/index.htm">Получение инстанции cl_gui_alv_grid для SALV</a>
											<span class="post-date">11.09.2021</span>
														</li>
													<li>
										<a href="../../abap-cloud/introduction-to-abap-in-the-cloud/index.htm">Introduction to ABAP in the Cloud</a>
											<span class="post-date">18.08.2021</span>
														</li>
													<li>
										<a href="../../abap-notes/getting-started-with-fpm-bopf-integration/index.htm">Getting Started with FPM BOPF Integration</a>
											<span class="post-date">01.06.2021</span>
														</li>
													<li>
										<a href="../../abap-notes/how-to-use-authority-checks-in-business-object-processing-framework/index.htm">30. How to Use Authority Checks in Business Object Processing Framework</a>
											<span class="post-date">29.05.2021</span>
														</li>
													<li>
										<a href="../../abap-notes/bopf-extensibility/index.htm">29. BOPF Extensibility</a>
											<span class="post-date">29.05.2021</span>
														</li>
													<li>
										<a href="../../abap-notes/bopf-enterprise-procurement-model-epm/index.htm">28. BOPF Enterprise Procurement Model (EPM)</a>
											<span class="post-date">29.05.2021</span>
														</li>
													<li>
										<a href="../../abap-notes/bopf-integration/index.htm">27. BOPF Integration</a>
											<span class="post-date">29.05.2021</span>
														</li>
													<li>
										<a href="../../abap-notes/bopf-business-configuration-objects/index.htm">26. BOPF Business Configuration Objects</a>
											<span class="post-date">29.05.2021</span>
														</li>
													<li>
										<a href="../../abap-notes/bopf-performance/index.htm">25. BOPF Performance</a>
											<span class="post-date">29.05.2021</span>
														</li>
													<li>
										<a href="../../abap-notes/bopf-supportability/index.htm">24. BOPF Supportability</a>
											<span class="post-date">29.05.2021</span>
														</li>
							</ul>
								</aside>
					<aside id="decent_comments_widget-2" class="widget widget_decent_comments_widget">
						<h3 class='widget-title'>Последние комментарии</h3>
<div class="decent-comments"><ul><li><div class="comment"><span class="comment-author">Николай</span><span class="comment-date"> 27.10.2021 в 15:19</span><span class="comment-link"> на <a href="../../osnovy-abap/internal-table-as-data-source-select/index.htm#comment-17857">Внутренние таблицы как источник в SQL запросах</a></span><span class="comment-excerpt">Спасибо за статью. Если нужно сделать агрегацию внутренней таблицы то агрегация через передачу во временную таблицу на БД тоже будет работать медленней чем через loop/collect? Например таблица 100к записей, которая становится 5к после агрегации. </span></div></li><li><div class="comment"><span class="comment-author">Аноним</span><span class="comment-date"> 14.10.2021 в 13:50</span><span class="comment-link"> на <a href="../../osnovy-abap/oop/dekorator-decorator-wrapper/index.htm#comment-17856">Декоратор (Decorator, Wrapper)</a></span><span class="comment-excerpt">Так поведение Decorator не надо будет повторно описывать повторно в других Component. Но это возможно при изменении типа mo_component, например, на object. </span></div></li><li><div class="comment"><span class="comment-author">Александр</span><span class="comment-date"> 11.10.2021 в 06:50</span><span class="comment-link"> на <a href="../../osnovy-abap/oop/dekorator-decorator-wrapper/index.htm#comment-17854">Декоратор (Decorator, Wrapper)</a></span><span class="comment-excerpt">Привет:) Возможно, я не так выразил мысль. Я имел ввиду, какая ценность от класса Decorator, если можно декорировать поведение от Component и от него же наследовать конкретные декораторы? (см. первую UML диаграмму) </span></div></li><li><div class="comment"><span class="comment-author">Astrafox</span><span class="comment-date"> 10.10.2021 в 12:39</span><span class="comment-link"> на <a href="../../osnovy-abap/oop/dekorator-decorator-wrapper/index.htm#comment-17853">Декоратор (Decorator, Wrapper)</a></span><span class="comment-excerpt">Привет! Можно и так, однако конкретный компонент может иметь более широкий интерфейс, нежели тот, что нужен в декораторах. Тут скорее пример не совсем удачный, декорируемое поведение лучше вынести в отдельный интерфейс, реализуемый как компонентом, так и декораторами. </span></div></li><li><div class="comment"><span class="comment-author">Александр</span><span class="comment-date"> 04.10.2021 в 12:51</span><span class="comment-link"> на <a href="../../osnovy-abap/oop/dekorator-decorator-wrapper/index.htm#comment-17850">Декоратор (Decorator, Wrapper)</a></span><span class="comment-excerpt">А какую роль играет базовый класс декоратора lcl_decorator? Что мешает конкретные декораторы наследовать от компонента lcl_concrete_component? Клиентский код и логика выполнения не поменяется. </span></div></li></ul></div>					</aside>
											</div>
				</div>
			</div>

						<div id="primary" class="content-area col-lg-9" itemprop="mainContentOfPage" style="">
							<div id="content" class="site-content" role="main" itemscope="" itemtype="http://schema.org/Article">
			<article id="post-6331" class="post-6331 post type-post status-publish format-standard hentry category-database-work">
	<header class="entry-header">
		<h1 class="entry-title" itemprop="name">Оконные функции в ABAP</h1>
							<div class="entry-meta"><span class="entry-date"><a href="index.htm" rel="bookmark"><time class="entry-date published" datetime="2021-02-28T14:41:22+04:00" itemprop="datepublished">28.02.2021</time></a></span> от <span class="author vcard" itemscope="" itemprop="author" itemtype="http://schema.org/Person"><a class="url fn n" href="../../author/admin/index.htm" rel="author" itemprop="url"><span itemprop="name">Astrafox</span></a></span><span class="sep">&middot;</span><span class="comments-link"><a href="index.htm#respond" itemprop="discussionUrl">Нет комментариев</a></span></div>
			</header>
		
	
	<div class="entry-content" itemprop="articleBody">
				<p><a href="../../wp-content/uploads/2021/02/img_5eb70b2cd8ccb-1.png" data-slb-active="1" data-slb-asset="226893909" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignleft wp-image-6338" title="Оконная функция в SQL" src="../../wp-content/uploads/2021/02/img_5eb70b2cd8ccb-1.png" alt="Оконная функция в SQL" width="402" height="224" srcset="../../wp-content/uploads/2021/02/img_5eb70b2cd8ccb-1.png 495w, ../../wp-content/uploads/2021/02/img_5eb70b2cd8ccb-1-300x167.png 300w" sizes="(max-width: 402px) 100vw, 402px"></a></p>
<p>Начиная с версии ABAP 7.54 в ABAP SQL появились так называемые оконные выражения. Оконные выражения &#8212; <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abapsql_expr.htm" target="_blank" rel="noopener">SQL выражения</a> определяемые с помощью дополнения <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abapselect_over.htm" target="_blank" rel="noopener"><strong>OVER</strong> </a>в запросе, позволяют определить окна, как подмножества итогового результата запроса и выполнять над ним оконные функции.</p>
<p>Оконные функции можно сравнить с агрегатными функциями, но, в отличие от обычной агрегатной функции, при использовании оконной функции несколько строк не группируются в одну, а продолжают существовать отдельно. При этом результаты работы оконных функций просто добавляются к результирующей выборке как еще одно поле.</p>
<p>Оконные функции являются частью стандарта SQL и даже если версия языка не позволит вам использовать их непосредственно в ABAP, всегда можно воспользоваться Native SQL (Так, по одной из задач, применение оконной функции внутри AMDP позволило ускорить работу запроса в десятки раз).</p>
<p>Далее на небольших примерах рассмотрим основные оконные функции и то, как с ними работать.</p>
<p><span id="more-6331"></span></p>
<h2>Синтаксис</h2>
<blockquote><p>Описание синтаксиса тут и далее взято из последней доступной версии ABAP &#8212; 7.55</p></blockquote>
<p>Общий синтаксис оконного выражения выглядит следующим образом:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4eccb979218682" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog-syntax urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eccb979218682-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4eccb979218682-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eccb979218682-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4eccb979218682-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eccb979218682-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4eccb979218682-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eccb979218682-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4eccb979218682-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eccb979218682-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4eccb979218682-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eccb979218682-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eccb979218682-1"><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-h"> </span>win<span class="crayon-sy">_</span>func<span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">[</span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp1<span class="crayon-sy">,</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp2<span class="crayon-h"> </span><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-o">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4eccb979218682-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">[</span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>col1<span class="crayon-h"> </span><span class="crayon-o">[</span><span class="crayon-st">ASCENDING</span><span class="crayon-sy">|</span><span class="crayon-st">DESCENDING</span><span class="crayon-o">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eccb979218682-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>col2<span class="crayon-h"> </span><span class="crayon-o">[</span><span class="crayon-st">ASCENDING</span><span class="crayon-sy">|</span><span class="crayon-st">DESCENDING</span><span class="crayon-o">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4eccb979218682-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">[</span><span class="crayon-st">ROWS</span><span class="crayon-h"> </span><span class="crayon-st">BETWEEN</span><span class="crayon-h"> </span><span class="crayon-o">{</span><span class="crayon-st">UNBOUNDED</span><span class="crayon-h"> </span><span class="crayon-st">PRECEDING</span><span class="crayon-o">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eccb979218682-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-o">{</span><span class="crayon-st">CURRENT</span><span class="crayon-h"> </span><span class="crayon-st">ROW</span><span class="crayon-o">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4eccb979218682-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-o">{</span><span class="crayon-o">(</span>n<span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">PRECEDING</span><span class="crayon-o">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eccb979218682-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-o">{</span><span class="crayon-o">(</span>n<span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">FOLLOWING</span><span class="crayon-o">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4eccb979218682-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">AND</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">{</span><span class="crayon-st">UNBOUNDED</span><span class="crayon-h"> </span><span class="crayon-st">FOLLOWING</span><span class="crayon-o">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eccb979218682-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-o">{</span><span class="crayon-st">CURRENT</span><span class="crayon-h"> </span><span class="crayon-st">ROW</span><span class="crayon-o">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4eccb979218682-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-o">{</span><span class="crayon-o">(</span>n<span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">PRECEDING</span><span class="crayon-o">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eccb979218682-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-o">{</span><span class="crayon-o">(</span>n<span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">FOLLOWING</span><span class="crayon-o">}</span><span class="crayon-o">]</span><span class="crayon-o">]</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0026 seconds] -->
<p>Оконное выражение состоит из оконной функции, за которой следует дополнение <strong>OVER</strong>, в круглых скобках которого определяется окно в общем наборе результатов (или подмножество), для которого отрабатывает оконная функция. Внутри окна опционально можно указать:</p>
<ul>
<li><span class="qtext"><strong>PARTITION BY </strong><a class="blue">sql_exp1</a>, <a class="blue">sql_exp2</a> &#8230; Определяет перечень столбцов для группировки. Можно использовать все SQL выражения доступные в ABAP SQL за исключением оконных и агрегатных функций. Если оставить данный раздел пустым, будет обработан весь набор данных запроса.</span></li>
<li><span class="qtext"><strong>ORDER BY</strong>. Определяет как порядок сортировки, так и ограничения над набором данных в окне. Является обязательным для некоторых оконных функций ранжирования/смещения.</span></li>
</ul>
<p>Если оконное выражение используется как поле выбора в запросе с группировкой <strong>GROUP BY</strong>, окна вычисляются над объединённым набором результатов, а результаты агрегатных функций этого запроса могут быть аргументами оконной функции.</p>
<p>Как и с <a href="../common-table-expressions-cte/index.htm" target="_blank" rel="noopener">общими табличными выражениями</a>, они поддерживаются не на всех СУБД, проверку можно выполнить через класс CL_ABAP_DBFEATURES:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ecda777233254" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecda777233254-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecda777233254-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecda777233254-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecda777233254-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecda777233254-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecda777233254-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecda777233254-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecda777233254-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecda777233254-1"><span class="crayon-st">IF</span><span class="crayon-h"> </span>cl<span class="crayon-sy">_</span>abap<span class="crayon-sy">_</span>dbfeatures<span class="crayon-o">=</span><span class="crayon-o">&gt;</span><span class="crayon-e">use_features</span><span class="crayon-o">(</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecda777233254-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">EXPORTING</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecda777233254-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>requested<span class="crayon-sy">_</span>features<span class="crayon-h"> </span><span class="crayon-o">=</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecda777233254-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">VALUE</span><span class="crayon-h"> </span>#<span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">(</span><span class="crayon-h"> </span>cl<span class="crayon-sy">_</span>abap<span class="crayon-sy">_</span>dbfeatures<span class="crayon-o">=</span><span class="crayon-o">&gt;</span>windowing<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-o">.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecda777233254-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-o">.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecda777233254-6"><span class="crayon-st">ELSE</span><span class="crayon-o">.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecda777233254-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-o">.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecda777233254-8"><span class="crayon-st">ENDIF</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>Win_func определяет оконную функцию:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ecdf659821144" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog-syntax urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecdf659821144-18">18</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-1"><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-h"> </span><span class="crayon-st">AVG</span><span class="crayon-o">(</span><span class="crayon-h"> </span>col<span class="crayon-h"> </span><span class="crayon-o">[</span><span class="crayon-st">AS</span><span class="crayon-h"> </span>dtype<span class="crayon-o">]</span><span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">MEDIAN</span><span class="crayon-o">(</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp<span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">MAX</span><span class="crayon-o">(</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp<span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">MIN</span><span class="crayon-o">(</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp<span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">SUM</span><span class="crayon-o">(</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp<span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">STDDEV</span><span class="crayon-o">(</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp<span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">VAR</span><span class="crayon-o">(</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp<span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">CORR</span><span class="crayon-o">(</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp1<span class="crayon-sy">,</span>sql<span class="crayon-sy">_</span>exp2<span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">CORR_SPEARMAN</span><span class="crayon-o">(</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp<span class="crayon-sy">,</span>sql<span class="crayon-sy">_</span>exp2<span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">COUNT</span><span class="crayon-o">(</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp<span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">COUNT</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">COUNT</span><span class="crayon-o">(</span><span class="crayon-o">*</span><span class="crayon-o">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">ROW_NUMBER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">RANK</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">DENSE_RANK</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">NTILE</span><span class="crayon-o">(</span><span class="crayon-h"> </span>n<span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">LEAD</span><span class="crayon-sy">|</span><span class="crayon-st">LAG</span><span class="crayon-o">(</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp1<span class="crayon-o">[</span><span class="crayon-sy">,</span><span class="crayon-h"> </span>diff<span class="crayon-o">[</span><span class="crayon-sy">,</span><span class="crayon-h"> </span>sql<span class="crayon-sy">_</span>exp2<span class="crayon-o">]</span><span class="crayon-o">]</span><span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecdf659821144-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">|</span><span class="crayon-h"> </span><span class="crayon-st">FIRST_VALUE</span><span class="crayon-sy">|</span><span class="crayon-st">LAST_VALUE</span><span class="crayon-o">(</span><span class="crayon-h"> </span>col<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-o">.</span><span class="crayon-o">.</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>Оконные функции могут быть трёх видов:</p>
<ul>
<li><strong>Агрегатные</strong>: AVG, MIN, MAX, SUM и др.,</li>
<li><strong>Функции ранжирования</strong>: ROW_NUMBER, RANK и др.,</li>
<li><strong>Функции смещения или функции значений (value functions)</strong>: LEAD, LAG и др,</li>
<li><strong>Аналитические функции</strong>: PERCENT_RANK, CUME_DIST и др., пока не представлены в ABAP.</li>
</ul>
<h2>Данные для тестирования</h2>
<p>В качестве тестовых данных будем рассматривать стандартную таблицу SFLIGHT и следующий набор данных:</p>
<p><a href="../../wp-content/uploads/2021/02/data.png" data-slb-active="1" data-slb-asset="2012383120" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6548" src="../../wp-content/uploads/2021/02/data.png" alt="" width="400" height="654" srcset="../../wp-content/uploads/2021/02/data.png 400w, ../../wp-content/uploads/2021/02/data-183x300.png 183w" sizes="(max-width: 400px) 100vw, 400px"></a></p>
<h2>Агрегатные функции</h2>
<p>В следующем примере посчитаем максимальную сумму оплаты PAYMENTSUM в разрезе авиакомпаний и рейсов:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ece3052288817" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece3052288817-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece3052288817-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece3052288817-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece3052288817-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece3052288817-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece3052288817-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece3052288817-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece3052288817-1"><span class="crayon-st">SELECT</span><span class="crayon-h"> </span><span class="crayon-st">DISTINCT</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece3052288817-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>connid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece3052288817-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">MAX</span><span class="crayon-o">(</span><span class="crayon-h"> </span>paymentsum<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece3052288817-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>connid<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>max<span class="crayon-sy">_</span>sum</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece3052288817-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">FROM</span><span class="crayon-h"> </span>sflight</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece3052288817-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece3052288817-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>connid<span class="crayon-h"> </span><span class="crayon-st">INTO</span><span class="crayon-h"> </span><span class="crayon-st">TABLE</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-st">DATA</span><span class="crayon-o">(</span>lt<span class="crayon-sy">_</span>sflight<span class="crayon-o">)</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>Результат:</p>
<p><a href="../../wp-content/uploads/2021/02/max_1.png" data-slb-active="1" data-slb-asset="1878011719" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6354" src="../../wp-content/uploads/2021/02/max_1.png" alt="" width="197" height="120"></a></p>
<p>Тут следует еще раз обратить внимание на то, что оконные функции не занимаются группировкой набора данных основного запроса, а формируют значение поля max_sum для каждой строки и чтобы взять только уникальные значения, мы задействовали в основном запросе <strong>DISTINCT</strong>.</p>
<p>В противном случае получили мы максимальную сумму по всем строкам основного запроса:</p>
<p><a href="../../wp-content/uploads/2021/02/without_distinct.png" data-slb-active="1" data-slb-asset="101159774" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6544" src="../../wp-content/uploads/2021/02/without_distinct.png" alt="" width="193" height="493" srcset="../../wp-content/uploads/2021/02/without_distinct.png 193w, ../../wp-content/uploads/2021/02/without_distinct-117x300.png 117w" sizes="(max-width: 193px) 100vw, 193px"></a></p>
<p>При выполнении оконной функции с помощью дополнения <strong>PARTITION BY</strong> мы определили группу, в рамках которой формируются окна, в рамках каждого из окна идёт расчёт максимального значения.</p>
<p>Аналогичным образом мы можем посчитать суммы по всем рейсам:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ece6086508074" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece6086508074-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece6086508074-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece6086508074-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece6086508074-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece6086508074-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece6086508074-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece6086508074-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece6086508074-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece6086508074-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece6086508074-1"><span class="crayon-st">SELECT</span><span class="crayon-h"> </span><span class="crayon-st">DISTINCT</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece6086508074-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece6086508074-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>connid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece6086508074-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">sum</span><span class="crayon-o">(</span><span class="crayon-h"> </span>paymentsum<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece6086508074-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>connid<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>total<span class="crayon-sy">_</span>sum</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece6086508074-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">FROM</span><span class="crayon-h"> </span>sflight</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece6086508074-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece6086508074-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>connid</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece6086508074-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">INTO</span><span class="crayon-h"> </span><span class="crayon-st">TABLE</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-st">DATA</span><span class="crayon-o">(</span>lt<span class="crayon-sy">_</span>sflight<span class="crayon-o">)</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>Результат:</p>
<p><a href="../../wp-content/uploads/2021/02/total_sum.png" data-slb-active="1" data-slb-asset="691566391" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6358" src="../../wp-content/uploads/2021/02/total_sum.png" alt="" width="206" height="119"></a></p>
<p>Используя <strong>агрегатные оконные функции</strong>, без указания <strong>ORDER BY</strong> подсчёт идёт один раз для всего окна (в функциях ранжирования выполняется расчёт для каждой строки, несмотря на пустой <strong>ORDER BY</strong>).  Однако, если указать <strong>ORDER BY</strong> подсчёт в каждой строке будет осуществляться c учётом сортировки по каждой уникальной записи. Таким образом мы можем рассчитывать например какой-нибудь нарастающий итог.</p>
<p>Исходный набор данных по авиакомпании AZ:</p>
<p><a href="../../wp-content/uploads/2021/02/data_fldate.png" data-slb-active="1" data-slb-asset="957483710" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6549" src="../../wp-content/uploads/2021/02/data_fldate.png" alt="" width="311" height="405" srcset="../../wp-content/uploads/2021/02/data_fldate.png 311w, ../../wp-content/uploads/2021/02/data_fldate-230x300.png 230w" sizes="(max-width: 311px) 100vw, 311px"></a></p>
<p>Выполним по этой авиакомпании следующий запрос:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ece9411925120" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece9411925120-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece9411925120-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece9411925120-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece9411925120-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece9411925120-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece9411925120-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece9411925120-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece9411925120-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ece9411925120-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ece9411925120-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece9411925120-1"><span class="crayon-st">SELECT</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece9411925120-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>fldate<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece9411925120-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">sum</span><span class="crayon-o">(</span><span class="crayon-h"> </span>paymentsum<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece9411925120-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece9411925120-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>fldate<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>balance</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece9411925120-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">FROM</span><span class="crayon-h"> </span>sflight</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece9411925120-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">WHERE</span><span class="crayon-h"> </span>carrid<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'AZ'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece9411925120-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ece9411925120-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>fldate</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ece9411925120-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">INTO</span><span class="crayon-h"> </span><span class="crayon-st">TABLE</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-st">DATA</span><span class="crayon-o">(</span>lt<span class="crayon-sy">_</span>sflight<span class="crayon-o">)</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p><a href="../../wp-content/uploads/2021/02/fldate_balance.png" data-slb-active="1" data-slb-asset="377509989" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6552" src="../../wp-content/uploads/2021/02/fldate_balance.png" alt="" width="230" height="150"></a></p>
<p>В данном примере мы сделали окно по авиакомпании, где для каждой новой даты рассчитали баланс по сумме &#8212; PAYMENTSUM, т.е. для каждой строки с уникальной датой посчитали итог от начала окна до текущей в обработке строки. Получили нарастающий итог по каждой дате.</p>
<p>Кстати, оконные функции можно использовать сразу по несколько штук и они не мешают выполнению друг друга:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4eceb280682887" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eceb280682887-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4eceb280682887-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eceb280682887-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4eceb280682887-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eceb280682887-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4eceb280682887-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eceb280682887-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4eceb280682887-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eceb280682887-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4eceb280682887-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4eceb280682887-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eceb280682887-1"><span class="crayon-st">SELECT</span><span class="crayon-h"> </span><span class="crayon-st">DISTINCT</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4eceb280682887-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eceb280682887-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>fldate<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4eceb280682887-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">sum</span><span class="crayon-o">(</span><span class="crayon-h"> </span>paymentsum<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eceb280682887-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4eceb280682887-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>fldate<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>balance<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eceb280682887-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">sum</span><span class="crayon-o">(</span><span class="crayon-h"> </span>paymentsum<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>total</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4eceb280682887-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">FROM</span><span class="crayon-h"> </span>sflight</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eceb280682887-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4eceb280682887-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>fldate</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4eceb280682887-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">INTO</span><span class="crayon-h"> </span><span class="crayon-st">TABLE</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-st">DATA</span><span class="crayon-o">(</span>lt<span class="crayon-sy">_</span>sflight<span class="crayon-o">)</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>В результате получим:</p>
<p><a href="../../wp-content/uploads/2021/02/sum_balance_total.png" data-slb-active="1" data-slb-asset="1752472104" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6366" src="../../wp-content/uploads/2021/02/sum_balance_total.png" alt="" width="309" height="382" srcset="../../wp-content/uploads/2021/02/sum_balance_total.png 309w, ../../wp-content/uploads/2021/02/sum_balance_total-243x300.png 243w" sizes="(max-width: 309px) 100vw, 309px"></a></p>
<h2>Ранжирующие функции</h2>
<p>Ранжирующие функции – это функции, которые ранжируют значение для каждой строки в окне. Например, их можно использовать для того, чтобы присвоить порядковый номер строке или составить рейтинг.</p>
<ul>
<li><strong>ROW_NUMBER</strong> – функция возвращает номер строки и используется для нумерации;</li>
<li><strong>RANK</strong> — функция возвращает ранг каждой строки. В данном случае значения уже анализируются и, в случае нахождения одинаковых, возвращает одинаковый ранг с пропуском следующего значения;</li>
<li><strong>DENSE_RANK</strong> — функция возвращает ранг каждой строки. Но в отличие от функции RANK, она для одинаковых значений возвращает ранг, не пропуская следующий;</li>
</ul>
<p>В качестве самой простой задачи, мы можем выбрать все уникальные коды авиакомпаний и пронумеровать их по порядку:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ecee973946639" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecee973946639-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecee973946639-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecee973946639-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecee973946639-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecee973946639-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecee973946639-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecee973946639-1"><span class="crayon-st">SELECT</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecee973946639-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ROW<span class="crayon-sy">_</span>NUMBER<span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>row<span class="crayon-sy">_</span>number</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecee973946639-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">FROM</span><span class="crayon-h"> </span>sflight</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecee973946639-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">GROUP</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecee973946639-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>row<span class="crayon-sy">_</span>number</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecee973946639-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">INTO</span><span class="crayon-h"> </span><span class="crayon-st">TABLE</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-st">DATA</span><span class="crayon-o">(</span>lt<span class="crayon-sy">_</span>sflight<span class="crayon-o">)</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Результат:</p>
<p><a href="../../wp-content/uploads/2021/02/row_number_1.png" data-slb-active="1" data-slb-asset="486836217" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6346" src="../../wp-content/uploads/2021/02/row_number_1.png" alt="" width="170" height="108"></a></p>
<p>Порядок нумерации может быть изменён как внутри окна, так и относительно результата оконной функции:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ecf0746253824" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf0746253824-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-1"><span class="crayon-st">SELECT</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ROW<span class="crayon-sy">_</span>NUMBER<span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-h"> </span><span class="crayon-st">DESCENDING</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>row<span class="crayon-sy">_</span>number</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">FROM</span><span class="crayon-h"> </span>sflight</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">GROUP</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">INTO</span><span class="crayon-h"> </span><span class="crayon-st">TABLE</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-st">DATA</span><span class="crayon-o">(</span>lt<span class="crayon-sy">_</span>sflight<span class="crayon-o">)</span><span class="crayon-o">.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-8"><span class="crayon-c">" Тоже самое что и:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-10"><span class="crayon-c">*&nbsp;&nbsp;SELECT carrid,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-11"><span class="crayon-c">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ROW_NUMBER( ) OVER( ORDER BY carrid ) AS row_number</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-12"><span class="crayon-c">*&nbsp;&nbsp;FROM sflight</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-13"><span class="crayon-c">*&nbsp;&nbsp;&nbsp;&nbsp;GROUP BY carrid</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-14"><span class="crayon-c">*&nbsp;&nbsp;&nbsp;&nbsp;ORDER BY row_number DESCENDING</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf0746253824-15"><span class="crayon-c">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO TABLE @DATA(lt_sflight).</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p><a href="../../wp-content/uploads/2021/02/row_number_2.png" data-slb-active="1" data-slb-asset="632846744" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6348" src="../../wp-content/uploads/2021/02/row_number_2.png" alt="" width="165" height="102"></a></p>
<p>Усложним пример, добавив в оконную функцию ограничение по коду авиакомпании:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ecf3921199655" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf3921199655-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf3921199655-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf3921199655-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf3921199655-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf3921199655-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf3921199655-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf3921199655-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf3921199655-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf3921199655-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf3921199655-1"><span class="crayon-st">SELECT</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf3921199655-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>connid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf3921199655-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ROW<span class="crayon-sy">_</span>NUMBER<span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>row<span class="crayon-sy">_</span>number</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf3921199655-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">FROM</span><span class="crayon-h"> </span>sflight</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf3921199655-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">GROUP</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf3921199655-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>connid</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf3921199655-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf3921199655-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>row<span class="crayon-sy">_</span>number</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf3921199655-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">INTO</span><span class="crayon-h"> </span><span class="crayon-st">TABLE</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-st">DATA</span><span class="crayon-o">(</span>lt<span class="crayon-sy">_</span>sflight<span class="crayon-o">)</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p>Результат:</p>
<p><a href="../../wp-content/uploads/2021/02/row_number_3.png" data-slb-active="1" data-slb-asset="2114499640" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6350" src="../../wp-content/uploads/2021/02/row_number_3.png" alt="" width="215" height="114"></a></p>
<p>В данном примере мы добавили ограничение окна на поле CARRID, таким образом оконная функция подсчёта строк работает уже над тремя подмножествами запроса по трём имеющимся авиакомпаниям, где для каждой авиакомпании ведёт нумерацию рейсов.</p>
<p>Результат работы оконной функции невозможно отфильтровать в запросе с помощью WHERE, потому что оконные функции выполняются после всей фильтрации и группировки, т.е. с тем, что получилось. Соответственно нельзя добавить в WHERE row_number = 2 и выбрать только вторые строки. Но можно воспользоваться <a href="../common-table-expressions-cte/index.htm" target="_blank" rel="noopener">общими табличными выражениями</a>:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ecf5146241311" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf5146241311-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-1"><span class="crayon-st">WITH</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-2"><span class="crayon-o">+</span>window<span class="crayon-sy">_</span>result<span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span><span class="crayon-o">(</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">SELECT</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>connid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ROW<span class="crayon-sy">_</span>NUMBER<span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>connid<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>row<span class="crayon-sy">_</span>number</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">FROM</span><span class="crayon-h"> </span>sflight</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">GROUP</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>connid</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>connid<span class="crayon-h"> </span><span class="crayon-o">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-13"><span class="crayon-h"> </span><span class="crayon-st">SELECT</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-st">FROM</span><span class="crayon-h"> </span><span class="crayon-o">+</span>window<span class="crayon-sy">_</span>result<span class="crayon-h"> </span><span class="crayon-st">WHERE</span><span class="crayon-h"> </span>row<span class="crayon-sy">_</span>number<span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf5146241311-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">INTO</span><span class="crayon-h"> </span><span class="crayon-st">TABLE</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-st">DATA</span><span class="crayon-o">(</span>lt<span class="crayon-sy">_</span>sflight<span class="crayon-o">)</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>В результате получим только строку где row_number = 2.</p>
<p>Прочие ранжирующие функции можно рассмотреть на примере:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ecf8056878024" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecf8056878024-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-1"><span class="crayon-st">SELECT</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>fldate<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ROW<span class="crayon-sy">_</span>NUMBER<span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>fldate<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>row<span class="crayon-sy">_</span>number<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">RANK</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>fldate<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>rank<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DENSE<span class="crayon-sy">_</span>RANK<span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>fldate<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>dense<span class="crayon-sy">_</span>rank</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">FROM</span><span class="crayon-h"> </span>sflight</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>fldate</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecf8056878024-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">INTO</span><span class="crayon-h"> </span><span class="crayon-st">TABLE</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-st">DATA</span><span class="crayon-o">(</span>lt<span class="crayon-sy">_</span>sflight<span class="crayon-o">)</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p><a href="../../wp-content/uploads/2021/02/ranks.png" data-slb-active="1" data-slb-asset="1707776875" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6389" src="../../wp-content/uploads/2021/02/ranks.png" alt="" width="375" height="486" srcset="../../wp-content/uploads/2021/02/ranks.png 375w, ../../wp-content/uploads/2021/02/ranks-231x300.png 231w" sizes="(max-width: 375px) 100vw, 375px"></a></p>
<p>row_number &#8212; в рамках каждой авиакомпании выставляет номер строки, rank &#8212; выставляет ранг строки (для повторяющихся fldate он одинаковый) с увеличением счётчика, dense_rank &#8212; аналогичен rank( ) но без увеличения счётчика.</p>
<h2>Функции смещения (функции значений)</h2>
<p>Функции смещения – это функции, которые позволяют перемещаться и обращаться к разным строкам в окне, относительно текущей строки, а также обращаться к значениям в начале или в конце окна.</p>
<ul>
<li><strong>LEAD</strong> – функция обращается к данным из следующей строки набора данных. Ее можно использовать, например, для того чтобы сравнить текущее значение строки со следующим.</li>
<li><strong>LAG</strong> – функция обращается к данным из предыдущей строки набора данных. В данном случае функцию можно использовать для того, чтобы сравнить текущее значение строки с предыдущим.</li>
</ul>
<p>Рассмотрим простой пример:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ecfa396414183" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecfa396414183-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecfa396414183-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecfa396414183-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecfa396414183-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecfa396414183-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecfa396414183-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecfa396414183-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecfa396414183-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecfa396414183-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecfa396414183-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecfa396414183-1"><span class="crayon-st">SELECT</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecfa396414183-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>fldate<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecfa396414183-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">LAG</span><span class="crayon-o">(</span><span class="crayon-h"> </span>fldate<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecfa396414183-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>fldate<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>lag<span class="crayon-sy">_</span>date<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecfa396414183-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">LEAD</span><span class="crayon-o">(</span><span class="crayon-h"> </span>fldate<span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecfa396414183-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>fldate<span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span>lead<span class="crayon-sy">_</span>date</div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecfa396414183-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">FROM</span><span class="crayon-h"> </span>sflight</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecfa396414183-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>carrid<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecfa396414183-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>fldate</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecfa396414183-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">INTO</span><span class="crayon-h"> </span><span class="crayon-st">TABLE</span><span class="crayon-h"> </span><span class="crayon-sy">@</span><span class="crayon-st">DATA</span><span class="crayon-o">(</span>lt<span class="crayon-sy">_</span>sflight<span class="crayon-o">)</span><span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>В результате получим:</p>
<p><a href="../../wp-content/uploads/2021/02/lead_lag-1.png" data-slb-active="1" data-slb-asset="781604770" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6396" src="../../wp-content/uploads/2021/02/lead_lag-1.png" alt="" width="316" height="502" srcset="../../wp-content/uploads/2021/02/lead_lag-1.png 316w, ../../wp-content/uploads/2021/02/lead_lag-1-189x300.png 189w" sizes="(max-width: 316px) 100vw, 316px"></a></p>
<p>Как видно из примера, для строк с функцией <strong>LAG</strong> предыдущая строка для первых строк в окне недоступна, значение будет NULL, по при преобразовании к ABAP типу вернётся начальное значение для даты.</p>
<p>Для функции <strong>LEAD</strong> мы использовали дополнение, указывающее на число строк, которые необходимо пропустить после текущей для получения значения (по умолчанию 1). Соответственно для двух последних строк в каждом окне значение даты определить не удалось.</p>
<h2>Ограничения строк</h2>
<p>Начиная с версии ABAP 7.55 появилась дополнительная возможность ограничивать строки обрабатываемые в рамках окна, задавая так называемый фрейм (или рамку). Фрейм определяется относительно текущей строки окна, что позволяет ему перемещаться одновременно с расчётом строк внутри окна. Каждый фрейм имеет начальную и конечную границу, существует три варианта определения границ фрейма:</p>
<ul class="disc">
<li><strong><span class="qtext"><i class="bn">{</i>UNBOUNDED PRECEDING<i class="bn">}</i>/<i class="bn">{</i>UNBOUNDED FOLLOWING<i class="bn">}</i></span></strong></li>
</ul>
<dl>
<dd><span class="qtext">UNBOUNDED PRECEDING</span> начальная граница фрейма определяется начальной строкой окна.</dd>
</dl>
<dl>
<dd><span class="qtext">UNBOUNDED FOLLOWING</span> определяет конечную границу фрейма, как последнюю строку окна.</dd>
</dl>
<ul class="disc">
<li><strong><span class="qtext">CURRENT ROW</span></strong> может определять как конечную, так и начальную границу фрейма (в зависимости от комбинации другими ключевыми словами). .</li>
</ul>
<ul class="disc">
<li><strong><span class="qtext"><i class="bn">{</i>(n) PRECEDING<i class="bn">}</i>/<i class="bn">{</i>(n) FOLLOWING<i class="bn">}</i></span></strong></li>
</ul>
<dl>
<dd><span class="qtext">(n) PRECEDING</span> может использоваться для определения начала и конца фрейма. Определяет что фрейм начинается или заканчивается до N строк относительно текущей строки.</dd>
</dl>
<dl>
<dd><span class="qtext">(n) FOLLOWING </span>может использоваться для определения начала и конца фрейма. Определяет что фрейм начинается или заканчивается после N строк относительно текущей строки.</dd>
</dl>
<p>Т.к. версии 7.55 под рукой у меня нет (Docker образ ABAP Platform 2020 еще в работе :)), рассмотрим <a href="../../blog/uchimsya-primenyat-okonnyye-funktsii/index.htm" target="_blank" rel="noopener">пример из сети</a>:</p><!-- Urvanov Syntax Highlighter v2.8.22 -->

		<div id="urvanov-syntax-highlighter-618a055a4ecfd238495888" class="urvanov-syntax-highlighter-syntax crayon-theme-abapblog urvanov-syntax-highlighter-font-monospace urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-bottom: 12px; clear: none; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecfd238495888-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecfd238495888-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecfd238495888-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-618a055a4ecfd238495888-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-618a055a4ecfd238495888-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecfd238495888-1"><span class="crayon-st">SELECT</span><span class="crayon-h"> </span>Date<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecfd238495888-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Medium<span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecfd238495888-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Conversions<span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-618a055a4ecfd238495888-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">SUM</span><span class="crayon-o">(</span>Conversions<span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">OVER</span><span class="crayon-o">(</span><span class="crayon-h"> </span><span class="crayon-st">PARTITION</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>Date<span class="crayon-h"> </span><span class="crayon-st">ORDER</span><span class="crayon-h"> </span><span class="crayon-st">BY</span><span class="crayon-h"> </span>Conversions<span class="crayon-h"> </span><span class="crayon-st">ROWS</span><span class="crayon-h"> </span><span class="crayon-st">BETWEEN</span><span class="crayon-h"> </span><span class="crayon-st">CURRENT</span><span class="crayon-h"> </span><span class="crayon-st">ROW</span><span class="crayon-h"> </span><span class="crayon-st">AND</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-st">FOLLOWING</span><span class="crayon-h"> </span><span class="crayon-o">)</span><span class="crayon-h"> </span><span class="crayon-st">AS</span><span class="crayon-h"> </span><span class="crayon-s">'Sum'</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-618a055a4ecfd238495888-5"><span class="crayon-st">FROM</span><span class="crayon-h"> </span>Orders<span class="crayon-o">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p>Границы фрейма определены от текущей строки до следующей за ней.</p>
<p><a href="../../wp-content/uploads/2021/02/frame_demo.png" data-slb-active="1" data-slb-asset="1488094311" data-slb-internal="0" data-slb-group="6331"><img loading="lazy" class="alignnone size-full wp-image-6386" src="../../wp-content/uploads/2021/02/frame_demo.png" alt="" width="535" height="308" srcset="../../wp-content/uploads/2021/02/frame_demo.png 535w, ../../wp-content/uploads/2021/02/frame_demo-300x173.png 300w" sizes="(max-width: 535px) 100vw, 535px"></a></p>
<p>В данном случае сумма рассчитывается по текущей и следующей ячейке в окне. А последняя строка в окне имеет то же значение, что и столбец «Conversions», потому что больше не с чем складывать. Комбинируя ключевые слова, вы можете подогнать диапазон работы оконной функции под вашу специфическую задачу.</p>
<p>Благодаря таким ограничениям можно легко находить скользящие средние значения, определяя сколько следующих строк фрейма следует учитывать в агрегатной функции AVG.</p>
<p>В стандарте SQL кроме выражения ROWS есть так же дополнение <strong>RANGE</strong> которое пока не представлено в ABAP. Предложение <strong>RANGE</strong> предназначено также для ограничения набора строк. В отличие от ROWS, оно работает не с физическими строками, а с диапазоном строк в предложении ORDER BY. Это означает, что одинаковые по рангу строки в контексте предложения <strong>ORDER </strong><strong>BY</strong> будут считаться как одна текущая строка для функции <strong>CURRENT </strong><strong>ROW. </strong>Более подробно можете ознакомиться <a href="../../ru/blog/show/window-functions-tsql-part1/index.htm" target="_blank" rel="noopener">в этом материале</a>.</p>
							</div>
		</article>
	
	<nav class="navigation post-navigation" role="navigation" aria-label="Записи">
		<h2 class="screen-reader-text">Навигация по записям</h2>
		<div class="nav-links"><div class="nav-previous"><a href="../../network/odata-network/learn-sap-gateway-course-for-beginners/index.htm" rel="prev"><span class="meta-nav" aria-hidden="true">Назад</span> <span class="screen-reader-text">Предыдущая запись:</span> <span class="post-title">Learn SAP Gateway Course For Beginners</span></a></div><div class="nav-next"><a href="../../osnovy-abap/vnutrennie-tablicy/virtual-sort-abap-tables/index.htm" rel="next"><span class="meta-nav" aria-hidden="true">Далее</span> <span class="screen-reader-text">Следующая запись:</span> <span class="post-title">Виртуальная сортировка внутренних таблиц</span></a></div></div>
	</nav>

<div id="comments" class="comments-area">

	
	
		<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Добавить комментарий <small><a rel="nofollow" id="cancel-comment-reply-link" href="index.htm#respond" style="display:none;">Отменить ответ</a></small></h3><form action="https://abap-blog.ru/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate=""><p class="comment-notes"><span id="email-notes">Ваш адрес email не будет опубликован.</span></p><p class="comment-form-comment"><label for="comment">Комментарий</label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Имя</label> <input id="author" name="author" type="text" value="" size="30" maxlength="245"></p>
<div class="anr_captcha_field"><div id="anr_captcha_field_1" class="anr_captcha_field_div"></div></div><p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Отправить комментарий"> <input type='hidden' name='comment_post_ID' value='6331' id='comment_post_ID'>
<input type='hidden' name='comment_parent' id='comment_parent' value='0'>
</p></form>	</div><!-- #respond -->
	
	
</div>

			</div>
							</div>
					</div>
	</div>
</div>
<script type='text/javascript' id='contact-form-7-js-extra'>
/* <![CDATA[ */
var wpcf7 = {"api":{"root":"https:\/\/abap-blog.ru\/wp-json\/","namespace":"contact-form-7\/v1"}};
/* ]]> */
</script>
<script src='../../wp-content/plugins/contact-form-7/includes/js/index.js?ver=5.5.1' id='contact-form-7-js'></script>
<script src='../../wp-includes/js/jquery/ui/effect.min.js?ver=1.12.1' id='jquery-effects-core-js'></script>
<script src='../../wp-includes/js/jquery/ui/effect-slide.min.js?ver=1.12.1' id='jquery-effects-slide-js'></script>
<script src='../../wp-includes/js/jquery/ui/effect-highlight.min.js?ver=1.12.1' id='jquery-effects-highlight-js'></script>
<script src='../../wp-includes/js/jquery/ui/effect-fold.min.js?ver=1.12.1' id='jquery-effects-fold-js'></script>
<script src='../../wp-includes/js/jquery/ui/effect-blind.min.js?ver=1.12.1' id='jquery-effects-blind-js'></script>
<script src='../../wp-content/plugins/show-hidecollapse-expand/assets/js/bg-show-hide.js?ver=5.8.1' id='bg-show-hide-script-js'></script>
<script src='../../wp-includes/js/comment-reply.min.js?ver=5.8.1' id='comment-reply-js'></script>
<script src='../../wp-content/plugins/dynamic-to-top/js/libs/jquery.easing.js?ver=1.3' id='jquery-easing-js'></script>
<script type='text/javascript' id='dynamic-to-top-js-extra'>
/* <![CDATA[ */
var mv_dynamic_to_top = {"text":"To Top","version":"0","min":"300","speed":"1100","easing":"easeInExpo","margin":"20"};
/* ]]> */
</script>
<script src='../../wp-content/plugins/dynamic-to-top/js/dynamic.to.top.min.js?ver=3.5' id='dynamic-to-top-js'></script>
<script src='../../recaptcha/api.js?render=6LdA3s4UAAAAADBjYG-YFAEz4zKS3lKp1CB_BHMC&#038;ver=3.0' id='google-recaptcha-js'></script>
<script type='text/javascript' id='wpcf7-recaptcha-js-extra'>
/* <![CDATA[ */
var wpcf7_recaptcha = {"sitekey":"6LdA3s4UAAAAADBjYG-YFAEz4zKS3lKp1CB_BHMC","actions":{"homepage":"homepage","contactform":"contactform"}};
/* ]]> */
</script>
<script src='../../wp-content/plugins/contact-form-7/modules/recaptcha/index.js?ver=5.5.1' id='wpcf7-recaptcha-js'></script>
<script src='../../wp-includes/js/wp-embed.min.js?ver=5.8.1' id='wp-embed-js'></script>
<script src='../../wp-content/plugins/simple-lightbox/client/js/prod/lib.core.js?ver=2.8.1' id='slb_core-js'></script>
<script src='../../wp-content/plugins/simple-lightbox/client/js/prod/lib.view.js?ver=2.8.1' id='slb_view-js'></script>
<script src='../../wp-content/plugins/simple-lightbox/themes/baseline/js/prod/client.js?ver=2.8.1' id='slb-asset-slb_baseline-base-js'></script>
<script src='../../wp-content/plugins/simple-lightbox/themes/default/js/prod/client.js?ver=2.8.1' id='slb-asset-slb_default-base-js'></script>
<script src='../../wp-content/plugins/simple-lightbox/template-tags/item/js/prod/tag.item.js?ver=2.8.1' id='slb-asset-item-base-js'></script>
<script src='../../wp-content/plugins/simple-lightbox/template-tags/ui/js/prod/tag.ui.js?ver=2.8.1' id='slb-asset-ui-base-js'></script>
<script src='../../wp-content/plugins/simple-lightbox/content-handlers/image/js/prod/handler.image.js?ver=2.8.1' id='slb-asset-image-base-js'></script>
<script type="text/javascript" id="slb_footer">/* <![CDATA[ */if ( !!window.jQuery ) {(function($){$(document).ready(function(){if ( !!window.SLB && SLB.has_child('View.init') ) { SLB.View.init({"ui_autofit":true,"ui_animate":true,"slideshow_autostart":false,"slideshow_duration":"6","group_loop":true,"ui_overlay_opacity":"0.8","ui_title_default":false,"theme_default":"slb_default","ui_labels":{"loading":"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430","close":"\u0417\u0430\u043a\u0440\u044b\u0442\u044c","nav_next":"\u0412\u043f\u0435\u0440\u0435\u0434","nav_prev":"\u041d\u0430\u0437\u0430\u0434","slideshow_start":"\u0417\u0430\u043f\u0443\u0441\u0442\u0438\u0442\u044c \u0441\u043b\u0430\u0439\u0434\u0448\u043e\u0443","slideshow_stop":"\u041e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0441\u043b\u0430\u0439\u0434\u0448\u043e\u0443","group_status":"\u0418\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 %current%  \u0438\u0437 %total%"}}); }
if ( !!window.SLB && SLB.has_child('View.assets') ) { {$.extend(SLB.View.assets, {"226893909":{"id":6338,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/img_5eb70b2cd8ccb-1.png","title":"img_5eb70b2cd8ccb","caption":"","description":""},"2012383120":{"id":6548,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/data.png","title":"data","caption":"","description":""},"1878011719":{"id":6354,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/max_1.png","title":"max_1","caption":"","description":""},"101159774":{"id":6544,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/without_distinct.png","title":"without_distinct","caption":"","description":""},"691566391":{"id":6358,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/total_sum.png","title":"total_sum","caption":"","description":""},"957483710":{"id":6549,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/data_fldate.png","title":"data_fldate","caption":"","description":""},"377509989":{"id":6552,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/fldate_balance.png","title":"fldate_balance","caption":"","description":""},"1752472104":{"id":6366,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/sum_balance_total.png","title":"sum_balance_total","caption":"","description":""},"486836217":{"id":6346,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/row_number_1.png","title":"row_number_1","caption":"","description":""},"632846744":{"id":6348,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/row_number_2.png","title":"row_number_2","caption":"","description":""},"2114499640":{"id":6350,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/row_number_3.png","title":"row_number_3","caption":"","description":""},"1707776875":{"id":6389,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/ranks.png","title":"ranks","caption":"","description":""},"781604770":{"id":6396,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/lead_lag-1.png","title":"lead_lag","caption":"","description":""},"1488094311":{"id":6386,"type":"image","internal":true,"source":"https:\/\/abap-blog.ru\/wp-content\/uploads\/2021\/02\/frame_demo.png","title":"frame_demo","caption":"","description":""}});} }
/* THM */
if ( !!window.SLB && SLB.has_child('View.extend_theme') ) { SLB.View.extend_theme('slb_baseline',{"name":"\u0411\u0430\u0437\u043e\u0432\u0430\u044f \u043b\u0438\u043d\u0438\u044f","parent":"","styles":[{"handle":"base","uri":"https:\/\/abap-blog.ru\/wp-content\/plugins\/simple-lightbox\/themes\/baseline\/css\/style.css","deps":[]}],"layout_raw":"<div class=\"slb_container\"><div class=\"slb_content\">{{item.content}}<div class=\"slb_nav\"><span class=\"slb_prev\">{{ui.nav_prev}}<\/span><span class=\"slb_next\">{{ui.nav_next}}<\/span><\/div><div class=\"slb_controls\"><span class=\"slb_close\">{{ui.close}}<\/span><span class=\"slb_slideshow\">{{ui.slideshow_control}}<\/span><\/div><div class=\"slb_loading\">{{ui.loading}}<\/div><\/div><div class=\"slb_details\"><div class=\"inner\"><div class=\"slb_data\"><div class=\"slb_data_content\"><span class=\"slb_data_title\">{{item.title}}<\/span><span class=\"slb_group_status\">{{ui.group_status}}<\/span><div class=\"slb_data_desc\">{{item.description}}<\/div><\/div><\/div><div class=\"slb_nav\"><span class=\"slb_prev\">{{ui.nav_prev}}<\/span><span class=\"slb_next\">{{ui.nav_next}}<\/span><\/div><\/div><\/div><\/div>"}); }if ( !!window.SLB && SLB.has_child('View.extend_theme') ) { SLB.View.extend_theme('slb_default',{"name":"\u041f\u043e \u0443\u043c\u043e\u043b\u0447\u0430\u043d\u0438\u044e (\u0441\u0432\u0435\u0442\u043b\u044b\u0439)","parent":"slb_baseline","styles":[{"handle":"base","uri":"https:\/\/abap-blog.ru\/wp-content\/plugins\/simple-lightbox\/themes\/default\/css\/style.css","deps":[]}]}); }})})(jQuery);}/* ]]> */</script>
<script type="text/javascript" id="slb_context">/* <![CDATA[ */if ( !!window.jQuery ) {(function($){$(document).ready(function(){if ( !!window.SLB ) { {$.extend(SLB, {"context":["public","user_guest"]});} }})})(jQuery);}/* ]]> */</script>
			<script type="text/javascript">
				var anr_onloadCallback = function() {
					for ( var i = 0; i < document.forms.length; i++ ) {
						var form = document.forms[i];
						var captcha_div = form.querySelector( '.anr_captcha_field_div' );

						if ( null === captcha_div )
							continue;
						captcha_div.innerHTML = '';
						( function( form ) {
							var anr_captcha = grecaptcha.render( captcha_div,{
								'sitekey' : '6LfmhbAaAAAAABBrfPpMngzFHB6qZ4ATxXd3rvOR',
								'size'  : 'normal',
								'theme' : 'light'
							});
							if ( typeof jQuery !== 'undefined' ) {
								jQuery( document.body ).on( 'checkout_error', function(){
									grecaptcha.reset(anr_captcha);
								});
							}
							if ( typeof wpcf7 !== 'undefined' ) {
								document.addEventListener( 'wpcf7submit', function() {
									grecaptcha.reset(anr_captcha);
								}, false );
							}
						})(form);
					}
				};
			</script>
						<script src="../../recaptcha/api-1.js?onload=anr_onloadCallback&#038;render=explicit" async="" defer="">
			</script>
			</body>
</html>
