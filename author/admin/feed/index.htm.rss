<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	>

<channel>
	<title>Astrafox | ABAP Blog</title>
	<atom:link href="https://abap-blog.ru/author/admin/feed/" rel="self" type="application/rss+xml" />
	<link>https://abap-blog.ru</link>
	<description>Все о разработке в решениях от SAP</description>
	<lastBuildDate>Wed, 18 Aug 2021 03:59:50 +0000</lastBuildDate>
	<language>ru-RU</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.8.1</generator>
	<item>
		<title>Introduction to ABAP in the Cloud</title>
		<link>https://abap-blog.ru/abap-cloud/introduction-to-abap-in-the-cloud/</link>
					<comments>https://abap-blog.ru/abap-cloud/introduction-to-abap-in-the-cloud/#respond</comments>
		
		<dc:creator><![CDATA[Astrafox]]></dc:creator>
		<pubDate>Wed, 18 Aug 2021 03:57:16 +0000</pubDate>
				<category><![CDATA[ABAP Cloud]]></category>
		<guid isPermaLink="false">https://abap-blog.ru/?p=7880</guid>

					<description><![CDATA[<p>На OpenSAP с 15 сентября станет доступен обзорный курс по ABAP в облаке, записаться можно по ссылке. Содержимое: Unit 1: Basic components of SAP Business Technology Platform Unit 2: Introduction to SAP BTP, ABAP environment Unit 3: ABAP RESTful Programming Model Unit 4: SAP Extension Suite and development efficiency Unit 5: Extensibility in SAP S/4HANA [&#8230;]</p>
<p>The post <a href="https://abap-blog.ru/abap-cloud/introduction-to-abap-in-the-cloud/">Introduction to ABAP in the Cloud</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></description>
										<content:encoded><![CDATA[<p>На OpenSAP с 15 сентября станет доступен обзорный курс по ABAP в облаке, записаться можно по <a href="https://open.sap.com/courses/abap1" target="_blank" rel="nofollow noopener">ссылке</a>.</p>
<p>Содержимое:</p>
<ul>
<li>Unit 1: Basic components of SAP Business Technology Platform</li>
<li>Unit 2: Introduction to SAP BTP, ABAP environment</li>
<li>Unit 3: ABAP RESTful Programming Model</li>
<li>Unit 4: SAP Extension Suite and development efficiency</li>
<li>Unit 5: Extensibility in SAP S/4HANA</li>
<li>Unit 6: How to do side-by-side extensions</li>
</ul><p>The post <a href="https://abap-blog.ru/abap-cloud/introduction-to-abap-in-the-cloud/">Introduction to ABAP in the Cloud</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></content:encoded>
					
					<wfw:commentRss>https://abap-blog.ru/abap-cloud/introduction-to-abap-in-the-cloud/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>SAP Business Technology Platform in a Nutshell</title>
		<link>https://abap-blog.ru/abap-cloud/sap-business-technology-platform-in-a-nutshell/</link>
					<comments>https://abap-blog.ru/abap-cloud/sap-business-technology-platform-in-a-nutshell/#respond</comments>
		
		<dc:creator><![CDATA[Astrafox]]></dc:creator>
		<pubDate>Thu, 27 May 2021 13:03:54 +0000</pubDate>
				<category><![CDATA[ABAP Cloud]]></category>
		<guid isPermaLink="false">https://abap-blog.ru/?p=7636</guid>

					<description><![CDATA[<p>На OpenSAP в скором времени стартует обзорный курс по BTP. записаться можно по ссылке. Содержимое: Unit 1: SAP Business Technology Platform: strategy and offering Unit 2: Integration: connecting processes, data, and experiences Unit 3: Data to value: enabling customers to improve with confidence Unit 4: Extensibility: enhancing and customizing the business processes Unit 5: Key [&#8230;]</p>
<p>The post <a href="https://abap-blog.ru/abap-cloud/sap-business-technology-platform-in-a-nutshell/">SAP Business Technology Platform in a Nutshell</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></description>
										<content:encoded><![CDATA[<p>На OpenSAP в скором времени стартует обзорный курс по BTP. записаться можно по <a href="https://open.sap.com/courses/btp1" rel="nofollow ">ссылке</a>.</p>
<p>Содержимое:</p>
<ul>
<li>Unit 1: SAP Business Technology Platform: strategy and offering</li>
<li>Unit 2: Integration: connecting processes, data, and experiences</li>
<li>Unit 3: Data to value: enabling customers to improve with confidence</li>
<li>Unit 4: Extensibility: enhancing and customizing the business processes</li>
<li>Unit 5: Key takeaways: SAP Business Technology Platform in a nutshell</li>
</ul>
<p>Хороший обзор на тему BTP можно почитать <a href="https://blogs.sap.com/2021/05/26/btp-scp-cap-rap...-omg/" rel="nofollow ">тут</a>.</p><p>The post <a href="https://abap-blog.ru/abap-cloud/sap-business-technology-platform-in-a-nutshell/">SAP Business Technology Platform in a Nutshell</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></content:encoded>
					
					<wfw:commentRss>https://abap-blog.ru/abap-cloud/sap-business-technology-platform-in-a-nutshell/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Вебинар на тему Clean Code</title>
		<link>https://abap-blog.ru/osnovy-abap/vebinar-na-temu-clean-code/</link>
					<comments>https://abap-blog.ru/osnovy-abap/vebinar-na-temu-clean-code/#comments</comments>
		
		<dc:creator><![CDATA[Astrafox]]></dc:creator>
		<pubDate>Tue, 25 May 2021 16:30:00 +0000</pubDate>
				<category><![CDATA[Основы ABAP]]></category>
		<guid isPermaLink="false">https://abap-blog.ru/?p=7628</guid>

					<description><![CDATA[<p>Регистрация по ссылке.</p>
<p>The post <a href="https://abap-blog.ru/osnovy-abap/vebinar-na-temu-clean-code/">Вебинар на тему Clean Code</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></description>
										<content:encoded><![CDATA[<p><a href="https://abap-blog.ru/wp-content/uploads/2021/05/CleanCode.png"><img loading="lazy" class="alignnone size-full wp-image-7629" src="https://abap-blog.ru/wp-content/uploads/2021/05/CleanCode.png" alt="" width="1346" height="319" srcset="https://abap-blog.ru/wp-content/uploads/2021/05/CleanCode.png 1346w, https://abap-blog.ru/wp-content/uploads/2021/05/CleanCode-300x71.png 300w, https://abap-blog.ru/wp-content/uploads/2021/05/CleanCode-1024x243.png 1024w, https://abap-blog.ru/wp-content/uploads/2021/05/CleanCode-768x182.png 768w" sizes="(max-width: 1346px) 100vw, 1346px" /></a></p>
<p>Регистрация <a href="https://t.co/9GheNVjAo4?amp=1" target="_blank" rel="noopener">по ссылке</a>.</p><p>The post <a href="https://abap-blog.ru/osnovy-abap/vebinar-na-temu-clean-code/">Вебинар на тему Clean Code</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></content:encoded>
					
					<wfw:commentRss>https://abap-blog.ru/osnovy-abap/vebinar-na-temu-clean-code/feed/</wfw:commentRss>
			<slash:comments>3</slash:comments>
		
		
			</item>
		<item>
		<title>Оценка похожести строк через Fuzzy Search</title>
		<link>https://abap-blog.ru/hana/hana-fuzzy-search/</link>
					<comments>https://abap-blog.ru/hana/hana-fuzzy-search/#respond</comments>
		
		<dc:creator><![CDATA[Astrafox]]></dc:creator>
		<pubDate>Mon, 26 Apr 2021 13:05:19 +0000</pubDate>
				<category><![CDATA[HANA]]></category>
		<guid isPermaLink="false">https://abap-blog.ru/?p=7264</guid>

					<description><![CDATA[<p>Использование функционала поиска в HANA довольно обширная тема, которой посвящена отдельный гайд в документации. В данной же статье хотелось бы рассмотреть её небольшую часть, а именно нечёткий поиск или Fuzzy Search для оценки похожести строк. В целом нечёткий поиск может быть использован в разных сценариях, например: Для облегчения поиска пользователя, когда заранее может быть неизвестно [&#8230;]</p>
<p>The post <a href="https://abap-blog.ru/hana/hana-fuzzy-search/">Оценка похожести строк через Fuzzy Search</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></description>
										<content:encoded><![CDATA[<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/database-search-2361-2.png"><img loading="lazy" class="wp-image-7274 alignright" src="https://abap-blog.ru/wp-content/uploads/2021/04/database-search-2361-2.png" alt="" width="255" height="255" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/database-search-2361-2.png 512w, https://abap-blog.ru/wp-content/uploads/2021/04/database-search-2361-2-300x300.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/database-search-2361-2-150x150.png 150w" sizes="(max-width: 255px) 100vw, 255px" /></a>Использование функционала поиска в HANA довольно обширная тема, которой посвящена <a href="https://help.sap.com/viewer/691cb949c1034198800afde3e5be6570/2.0.05/en-US/ce86ef2fd97610149eaaaa0244ca4d36.html" target="_blank" rel="noopener">отдельный гайд в документации</a>.</p>
<p>В данной же статье хотелось бы рассмотреть её небольшую часть, а именно нечёткий поиск или <a href="https://help.sap.com/viewer/691cb949c1034198800afde3e5be6570/2.0.05/en-US/cc602780bb5710148aa2bf6cab3c015b.html" target="_blank" rel="noopener"><strong>Fuzzy Search</strong></a> для оценки похожести строк.</p>
<p>В целом нечёткий поиск может быть использован в разных сценариях, например:</p>
<ul>
<li>Для облегчения поиска пользователя, когда заранее может быть неизвестно точное наименование материала или номера документа.</li>
<li>Для поиска по заранее определённым столбцам, когда пользователь ищет некоторый адрес вводя индекс или часть названия улицы.</li>
<li>Для сопоставления распознанных данных в каком-нибудь OCR движке (который может иногда выдавать не 100% результат) с тем что лежит в системе.</li>
</ul>
<p><span id="more-7264"></span></p>
<p>В ABAP есть встроенный механизм позволяющий оценить похожесть двух строк &#8212; функция <strong>distance</strong>, которая работает на базе алгоритма подсчёта расстояния <a href="https://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D1%81%D1%81%D1%82%D0%BE%D1%8F%D0%BD%D0%B8%D0%B5_%D0%9B%D0%B5%D0%B2%D0%B5%D0%BD%D1%88%D1%82%D0%B5%D0%B9%D0%BD%D0%B0" target="_blank" rel="noopener">Левенштейна</a>.</p>
<p>Функция возвращает количество операций удаления, вставки и изменения, необходимых для преобразования одной строки в другую. Однако данная функция в отличие от Fuzzy Search не обладает той же гибкостью.</p>
<h3>Fuzzy Search в средствах поиска</h3>
<p>Если Вы работаете в более менее современных системах на базе СУБД HANA, то наверное уже замечали встроенный механизм нечёткого поиска при вводе в средствах поиска, например поиск по имени класса:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/class_search.png"><img loading="lazy" class="alignnone size-full wp-image-7270" src="https://abap-blog.ru/wp-content/uploads/2021/04/class_search.png" alt="" width="756" height="281" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/class_search.png 756w, https://abap-blog.ru/wp-content/uploads/2021/04/class_search-300x112.png 300w" sizes="(max-width: 756px) 100vw, 756px" /></a></p>
<p>В соответствующем СП выставлены параметры нечёткого поиска:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/class_sh_conf.png"><img loading="lazy" class="alignnone size-full wp-image-7271" src="https://abap-blog.ru/wp-content/uploads/2021/04/class_sh_conf.png" alt="" width="803" height="295" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/class_sh_conf.png 803w, https://abap-blog.ru/wp-content/uploads/2021/04/class_sh_conf-300x110.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/class_sh_conf-768x282.png 768w" sizes="(max-width: 803px) 100vw, 803px" /></a></p>
<p>В интерфейсах вызова СП появились соответствующие опции:</p><pre class="urvanov-syntax-highlighter-plain-tag">DATA:
  ls_shlp_descr TYPE shlp_descr,
  lv_rc         LIKE sy-subrc,
  lt_values     TYPE STANDARD TABLE OF ddshretval.

PARAMETERS:
  p_req TYPE string.

START-OF-SELECTION.
  CONSTANTS:
    lc_search_help TYPE shlpname VALUE 'SEO_CLASSES_INTERFACES'.

  CALL FUNCTION 'F4IF_GET_SHLP_DESCR'
    EXPORTING
      shlpname = lc_search_help
      shlptype = 'SH'
    IMPORTING
      shlp     = ls_shlp_descr.

  ls_shlp_descr-textsearch-fields = VALUE ddsh_textsearch_fields( ( CONV #( 'NAME' ) )
                                                                  ( CONV #( 'DESCRIPTION' ) ) ).

  ls_shlp_descr-textsearch-request = p_req.
  ls_shlp_descr-intdescr-fuzzy_search = abap_true.
  ls_shlp_descr-intdescr-fuzzy_similarity = '0.8'.

  CALL FUNCTION 'F4IF_SELECT_VALUES'
    EXPORTING
      shlp       = ls_shlp_descr
      maxrows    = 12
    TABLES
      record_tab = lt_values.

  cl_demo_output=&gt;display( lt_values ).</pre><p>Внутри вызывается движок SADL и преобразование к Native SQL следующего вида:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/sql_trace.png"><img loading="lazy" class="alignnone size-full wp-image-7272" src="https://abap-blog.ru/wp-content/uploads/2021/04/sql_trace.png" alt="" width="599" height="440" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/sql_trace.png 599w, https://abap-blog.ru/wp-content/uploads/2021/04/sql_trace-300x220.png 300w" sizes="(max-width: 599px) 100vw, 599px" /></a></p>
<p>Обратите внимание на режим поиска: similarCalculationMode=<strong>search</strong>. Позже рассмотрим этот и другие режимы когда будем рассматривать сопоставления строк.</p>
<h3>Синтаксис вызова Fuzzy Search в SQLScript</h3>
<p>Упрощённый синтаксис вызова Fuzzy Search в SQLScript выглядит следующим образом:</p><pre class="urvanov-syntax-highlighter-plain-tag">SELECT SCORE() AS score, *
FROM table_name
WHERE CONTAINS(column_name, '123', FUZZY(0.8))
ORDER BY score DESC;</pre><p>В данном запросе мы найдём все строки в таблице table_name, где для поля column_name будут найдены значения, уровень похожести которых на &#171;123&#187; будет более 0.8.</p>
<ul>
<li>Уровень похожести определяется числом от 0 до 1, где 1 &#8212; полное соответствие.</li>
<li>Значение 0.0 переданное в функцию FUZZY будет обозначать выборку всех значений &gt; 0.</li>
<li>Функция SCORE() выдаёт результат оценки похожести.</li>
</ul>
<p>Функция CONTAINS может быть использована для разного рода поиска, но в данном случае используется именно нечёткий поиск &#8212; функция FUZZY.</p>
<p>Функция FUZZY можно настраивать через передачу параметров:</p><pre class="urvanov-syntax-highlighter-plain-tag">SELECT SCORE() AS score, *
FROM table_name
WHERE CONTAINS(column_name, 'Значение', FUZZY(0.8, 'option1=value1, option2=value2'))
ORDER BY score DESC;</pre><p>Поиск может быть выполнен с учётом нескольких столбцов:</p><pre class="urvanov-syntax-highlighter-plain-tag">SELECT ... WHERE CONTAINS((col1, col2, col3), 'term1 term2 term3', FUZZY(0.7)) ...;</pre><p>Внутри функции CONTAINS можно использовать специальный синтаксис запросов включающий в себя зарезервированные слова и символы:</p>
<ul>
<li>CONTAINS(col, &#8216;sap OR hana&#8217;), где OR (чувствителен к регистру) обозначает ИЛИ, выбрать все значения где есть sap или hana.</li>
<li>CONTAINS(col, &#8216;sap -hana&#8217;), выбрать все значения где есть sap, но не hana.</li>
<li>CONTAINS(col, &#8216;&#187;sap hana&#187;&#8216;), если брать в двойных кавычках поиск будет по фразе целиком.</li>
<li>* (%) или ?, активируют поиск по шаблону, при этом нечёткий поиск выполняться не будет.</li>
</ul>
<p>Следует учитывать что при передаче параметров в функцию FUZZY одновременно с вышеуказанными параметрами CONTAINS запрос разбивается на подзапросы:</p><pre class="urvanov-syntax-highlighter-plain-tag">SELECT ... WHERE CONTAINS(col1, 'terma OR termb', FUZZY(0.7, 'opt1=val1, opt2=val2')) ...;
 
/* будет преобразован в два подзапроса */
SELECT ... WHERE (CONTAINS(col1, 'terma', FUZZY(0.7, 'opt1=val1, opt2=val2'))
              OR  CONTAINS(col1, 'termb', FUZZY(0.7, 'opt1=val1, opt2=val2'))) ...;
 
 
SELECT ... WHERE CONTAINS(col1, 'this is a "search term"', FUZZY(0.7, 'opt1=val1, opt2=val2')) ...;
 
/* Так же будет преобразован в несколько подзапросов */
SELECT ... WHERE (CONTAINS(col1, 'this is a', FUZZY(0.7, 'opt1=val1, opt2=val2'))
             AND  CONTAINS(col1, '"search term"', FUZZY(0.7, 'opt1=val1, opt2=val2'))) ...;</pre><p>Аналогичное поведение будет при использовании поиска по нескольким столбцам:</p><pre class="urvanov-syntax-highlighter-plain-tag">SELECT ... WHERE CONTAINS((col1, col2), 'terma termb', FUZZY((0.7, 'opt1=val1, opt2=val2'), (0.9, 'opt3=val3'))) ...;
 
/* Будет выполнено несколько подзапросов */
SELECT ... WHERE
 ( CONTAINS(col1, 'terma', FUZZY(0.7, 'opt1=val1, opt2=val2')) AND CONTAINS(col1, 'termb', FUZZY(0.7, 'opt1=val1, opt2=val2')) )
OR
 ( CONTAINS(col1, 'terma', FUZZY(0.7, 'opt1=val1, opt2=val2')) AND CONTAINS(col2, 'termb', FUZZY((0.9, 'opt3=val3')) )
OR
 ( CONTAINS(col2, 'terma', FUZZY((0.9, 'opt3=val3'))           AND CONTAINS(col1, 'termb', FUZZY(0.7, 'opt1=val1, opt2=val2')) )
OR
 ( CONTAINS(col2, 'terma', FUZZY((0.9, 'opt3=val3'))           AND CONTAINS(col2, 'termb', FUZZY((0.9, 'opt3=val3')) )
OR
 CONTAINS(col1, '"terma termb"', FUZZY(0.7, 'opt1=val1, opt2=val2'))
OR
 CONTAINS(col2, '"terma termb"', FUZZY((0.9, 'opt3=val3'))
...;</pre><p>Если внутри запроса используется поиск по нескольким полям, функция SCORE будет возвращать средневзвешенное значение по всем полям используемым в запросе:</p><pre class="urvanov-syntax-highlighter-plain-tag">SELECT SCORE(), col1, col2, ... FROM tab
WHERE CONTAINS(col1, 'x y z')
  AND CONTAINS(col2, 'a b c')
  AND ...
ORDER BY SCORE() DESC;</pre><p>Вес каждого поля по умолчанию равен 1 (т.е. при оценке они равны между собой), допускается ручное указание весов:</p><pre class="urvanov-syntax-highlighter-plain-tag">SELECT SCORE(), ... FROM tab
WHERE CONTAINS((col1, col2, col3), 'a b c', FUZZY(0.8), WEIGHT(1.0, 0.5, 0.5))
  AND CONTAINS(col4, 'x y z', FUZZY(0.7), WEIGHT(0.7))
  AND CONTAINS(col5, 'u v w', FUZZY(0.7))
  AND ...
ORDER BY SCORE() DESC;</pre><p></p>
<h3>Оценка похожести строк</h3>
<p>С помощью опции similarCalculationMode мы можем определить то, каким образом будет оцениваться похожесть строк.</p>
<p>Похожесть строки А (строка поиска) по отношению к строке Б (строка в таблице) оценивается на основании следующих критериев:</p>
<ul>
<li>общие символы в А и Б</li>
<li>дополнительные символы в строке А</li>
<li>дополнительные символы в строке Б</li>
<li>ошибочные символы (опечатки) в строке А</li>
</ul>
<p>По своей сути допустимые для выставления режимы сопоставления отличаются влиянием вышеуказанных критериев на результат:</p>

<div class="wpdt-c row wpDataTableContainerSimpleTable wpDataTables wpDataTablesWrapper
"
    >
        <table id="wpdtSimpleTable-1"
           class="wpdtSimpleTable wpDataTable"
           style="border-collapse:collapse;
                   border-spacing:0px;"
           data-column="4"
           data-rows="8"
           data-wpID="1"
           data-responsive="1"
           data-has-header="1">

                    <thead>        <tr class="wpdt-cell-row " >
                            <th class="wpdt-cell wpdt-bold wpdt-valign-middle"
                                    data-cell-id="A1"
                data-col-index="0"
                data-row-index="0"
                style=" width:25.170998632%;                padding:5px;
                "
                >
                                Режим                </th>
                                            <th class="wpdt-cell wpdt-bold wpdt-valign-middle"
                                    data-cell-id="B1"
                data-col-index="1"
                data-row-index="0"
                style=" width:19.9726402189%;                padding:5px;
                "
                >
                                Опечатки                </th>
                                            <th class="wpdt-cell wpdt-bold wpdt-valign-middle"
                                    data-cell-id="C1"
                data-col-index="2"
                data-row-index="0"
                style=" width:23.2558139535%;                padding:5px;
                "
                >
                                Доп. символы в А                </th>
                                            <th class="wpdt-cell wpdt-bold wpdt-valign-middle"
                                    data-cell-id="D1"
                data-col-index="3"
                data-row-index="0"
                style=" width:31.6005471956%;                padding:5px;
                "
                >
                                Доп. символы в Б                </th>
                                        </tr>
                    <tbody>        <tr class="wpdt-cell-row odd" >
                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="A2"
                data-col-index="0"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                compare (по умолчанию)                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="B2"
                data-col-index="1"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                среднее                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="C2"
                data-col-index="2"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                высокое                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="D2"
                data-col-index="3"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                высокое                </td>
                                        </tr>
                            <tr class="wpdt-cell-row even" >
                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="A3"
                data-col-index="0"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                search                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="B3"
                data-col-index="1"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                высокое                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="C3"
                data-col-index="2"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                высокое                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="D3"
                data-col-index="3"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                низкое                </td>
                                        </tr>
                            <tr class="wpdt-cell-row odd" >
                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="A4"
                data-col-index="0"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                searchCompare                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="B4"
                data-col-index="1"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                среднее/высокое                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="C4"
                data-col-index="2"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                высокое                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="D4"
                data-col-index="3"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                низкое                </td>
                                        </tr>
                            <tr class="wpdt-cell-row even" >
                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="A5"
                data-col-index="0"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                symmetricsearch                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="B5"
                data-col-index="1"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                высокое                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="C5"
                data-col-index="2"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                среднее                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="D5"
                data-col-index="3"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                среднее                </td>
                                        </tr>
                            <tr class="wpdt-cell-row odd" >
                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="A6"
                data-col-index="0"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                substringsearch                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="B6"
                data-col-index="1"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                высокое                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="C6"
                data-col-index="2"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                высокое                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="D6"
                data-col-index="3"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                низкое                </td>
                                        </tr>
                            <tr class="wpdt-cell-row even" >
                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="A7"
                data-col-index="0"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                typeAhead                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="B7"
                data-col-index="1"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                высокое                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="C7"
                data-col-index="2"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                очень высокое                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="D7"
                data-col-index="3"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                низкое                </td>
                                        </tr>
                            <tr class="wpdt-cell-row odd" >
                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="A8"
                data-col-index="0"
                data-row-index="7"
                style="                padding:5px;
                "
                >
                                flexible                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="B8"
                data-col-index="1"
                data-row-index="7"
                style="                padding:5px;
                "
                >
                                управляется параметром errorDevaluate                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="C8"
                data-col-index="2"
                data-row-index="7"
                style="                padding:5px;
                "
                >
                                очень высокое                </td>
                                            <td class="wpdt-cell wpdt-valign-middle"
                                    data-cell-id="D8"
                data-col-index="3"
                data-row-index="7"
                style="                padding:5px;
                "
                >
                                управляется параметром lengthTolerance                </td>
                                        </tr>
                    </table>
</div><style id='wpdt-custom-style-1'>
</style>

<p>Рассмотрим на примерах:</p>

<div class="wpdt-c row wpDataTableContainerSimpleTable wpDataTables wpDataTablesWrapper
"
    >
        <table id="wpdtSimpleTable-2"
           class="wpdtSimpleTable wpDataTable"
           style="border-collapse:collapse;
                   border-spacing:0px;"
           data-column="5"
           data-rows="7"
           data-wpID="2"
           data-responsive="1"
           data-has-header="1">

                    <thead>        <tr class="wpdt-cell-row " >
                            <th class="wpdt-cell wpdt-bold"
                                    data-cell-id="A1"
                data-col-index="0"
                data-row-index="0"
                style=" width:28.0487804878%;                padding:5px;
                "
                >
                                Строка А                </th>
                                            <th class="wpdt-cell wpdt-bold"
                                    data-cell-id="B1"
                data-col-index="1"
                data-row-index="0"
                style=" width:28.1842818428%;                padding:5px;
                "
                >
                                Строка Б                </th>
                                            <th class="wpdt-cell wpdt-bold"
                                    data-cell-id="C1"
                data-col-index="2"
                data-row-index="0"
                style=" width:13.5501355014%;                padding:5px;
                "
                >
                                compare                </th>
                                            <th class="wpdt-cell wpdt-bold"
                                    data-cell-id="D1"
                data-col-index="3"
                data-row-index="0"
                style=" width:13.5501355014%;                padding:5px;
                "
                >
                                typeAhead                </th>
                                            <th class="wpdt-cell wpdt-bold"
                                    data-cell-id="E1"
                data-col-index="4"
                data-row-index="0"
                style=" width:16.6666666667%;                padding:5px;
                "
                >
                                searchCompare                </th>
                                        </tr>
                    <tbody>        <tr class="wpdt-cell-row odd" >
                            <td class="wpdt-cell "
                                    data-cell-id="A2"
                data-col-index="0"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                search                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B2"
                data-col-index="1"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                searching                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C2"
                data-col-index="2"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                0.76                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D2"
                data-col-index="3"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                1.0                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E2"
                data-col-index="4"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                1.0                </td>
                                        </tr>
                            <tr class="wpdt-cell-row even" >
                            <td class="wpdt-cell "
                                    data-cell-id="A3"
                data-col-index="0"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                search                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B3"
                data-col-index="1"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                seerch                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C3"
                data-col-index="2"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                0.85                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D3"
                data-col-index="3"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                0.85                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E3"
                data-col-index="4"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                0.85                </td>
                                        </tr>
                            <tr class="wpdt-cell-row odd" >
                            <td class="wpdt-cell "
                                    data-cell-id="A4"
                data-col-index="0"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                search                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B4"
                data-col-index="1"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                searchingforextraterrestriallife                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C4"
                data-col-index="2"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                0.0                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D4"
                data-col-index="3"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                0.91                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E4"
                data-col-index="4"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                0.91                </td>
                                        </tr>
                            <tr class="wpdt-cell-row even" >
                            <td class="wpdt-cell "
                                    data-cell-id="A5"
                data-col-index="0"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                searchingforextraterrestriallife                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B5"
                data-col-index="1"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                searching                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C5"
                data-col-index="2"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                0.0                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D5"
                data-col-index="3"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                0                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E5"
                data-col-index="4"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                0                </td>
                                        </tr>
                            <tr class="wpdt-cell-row odd" >
                            <td class="wpdt-cell "
                                    data-cell-id="A6"
                data-col-index="0"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                searchingforextraterrestriallife                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B6"
                data-col-index="1"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                seerch                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C6"
                data-col-index="2"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                0.0                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D6"
                data-col-index="3"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                0                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E6"
                data-col-index="4"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                0                </td>
                                        </tr>
                            <tr class="wpdt-cell-row even" >
                            <td class="wpdt-cell "
                                    data-cell-id="A7"
                data-col-index="0"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                searchingforextraterrestriallife                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B7"
                data-col-index="1"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                searchingforthemeaningoflife                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C7"
                data-col-index="2"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                0.6                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D7"
                data-col-index="3"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                0.6                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E7"
                data-col-index="4"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                0.6                </td>
                                        </tr>
                    </table>
</div><style id='wpdt-custom-style-2'>
</style>


<div class="wpdt-c row wpDataTableContainerSimpleTable wpDataTables wpDataTablesWrapper
"
    >
        <table id="wpdtSimpleTable-3"
           class="wpdtSimpleTable wpDataTable"
           style="border-collapse:collapse;
                   border-spacing:0px;"
           data-column="5"
           data-rows="7"
           data-wpID="3"
           data-responsive="1"
           data-has-header="1">

                    <thead>        <tr class="wpdt-cell-row " >
                            <th class="wpdt-cell wpdt-bold"
                                    data-cell-id="A1"
                data-col-index="0"
                data-row-index="0"
                style=" width:31.9018404908%;                padding:5px;
                "
                >
                                Строка А                </th>
                                            <th class="wpdt-cell wpdt-bold"
                                    data-cell-id="B1"
                data-col-index="1"
                data-row-index="0"
                style=" width:31.9018404908%;                padding:5px;
                "
                >
                                Строка Б                </th>
                                            <th class="wpdt-cell wpdt-bold"
                                    data-cell-id="C1"
                data-col-index="2"
                data-row-index="0"
                style=" width:9.96932515337%;                padding:5px;
                "
                >
                                search                </th>
                                            <th class="wpdt-cell wpdt-bold"
                                    data-cell-id="D1"
                data-col-index="3"
                data-row-index="0"
                style=" width:13.6503067485%;                padding:5px;
                "
                >
                                symmetric                </th>
                                            <th class="wpdt-cell wpdt-bold"
                                    data-cell-id="E1"
                data-col-index="4"
                data-row-index="0"
                style=" width:12.5766871166%;                padding:5px;
                "
                >
                                substring                </th>
                                        </tr>
                    <tbody>        <tr class="wpdt-cell-row odd" >
                            <td class="wpdt-cell "
                                    data-cell-id="A2"
                data-col-index="0"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                search                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B2"
                data-col-index="1"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                searching                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C2"
                data-col-index="2"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                0.96                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D2"
                data-col-index="3"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                0.86                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E2"
                data-col-index="4"
                data-row-index="1"
                style="                padding:5px;
                "
                >
                                0.9                </td>
                                        </tr>
                            <tr class="wpdt-cell-row even" >
                            <td class="wpdt-cell "
                                    data-cell-id="A3"
                data-col-index="0"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                search                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B3"
                data-col-index="1"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                seerch                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C3"
                data-col-index="2"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                0.75                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D3"
                data-col-index="3"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                0.75                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E3"
                data-col-index="4"
                data-row-index="2"
                style="                padding:5px;
                "
                >
                                0.8                </td>
                                        </tr>
                            <tr class="wpdt-cell-row odd" >
                            <td class="wpdt-cell "
                                    data-cell-id="A4"
                data-col-index="0"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                search                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B4"
                data-col-index="1"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                searchingforextraterrestriallife                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C4"
                data-col-index="2"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                0.91                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D4"
                data-col-index="3"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                0.87                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E4"
                data-col-index="4"
                data-row-index="3"
                style="                padding:5px;
                "
                >
                                0.88                </td>
                                        </tr>
                            <tr class="wpdt-cell-row even" >
                            <td class="wpdt-cell "
                                    data-cell-id="A5"
                data-col-index="0"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                searchingforextraterrestriallife                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B5"
                data-col-index="1"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                searching                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C5"
                data-col-index="2"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                0.35                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D5"
                data-col-index="3"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                0.84                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E5"
                data-col-index="4"
                data-row-index="4"
                style="                padding:5px;
                "
                >
                                0                </td>
                                        </tr>
                            <tr class="wpdt-cell-row odd" >
                            <td class="wpdt-cell "
                                    data-cell-id="A6"
                data-col-index="0"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                searchingforextraterrestriallife                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B6"
                data-col-index="1"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                seerch                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C6"
                data-col-index="2"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                0.24                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D6"
                data-col-index="3"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                0.79                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E6"
                data-col-index="4"
                data-row-index="5"
                style="                padding:5px;
                "
                >
                                0                </td>
                                        </tr>
                            <tr class="wpdt-cell-row even" >
                            <td class="wpdt-cell "
                                    data-cell-id="A7"
                data-col-index="0"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                searchingforextraterrestriallife                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="B7"
                data-col-index="1"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                searchingforthemeaningoflife                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="C7"
                data-col-index="2"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                0.57                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="D7"
                data-col-index="3"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                0.6                </td>
                                            <td class="wpdt-cell "
                                    data-cell-id="E7"
                data-col-index="4"
                data-row-index="6"
                style="                padding:5px;
                "
                >
                                0                </td>
                                        </tr>
                    </table>
</div><style id='wpdt-custom-style-3'>
</style>

<p>Более подробное пояснение по каждому из режимов можно найти в <a href="https://help.sap.com/viewer/691cb949c1034198800afde3e5be6570/2.0.05/en-US/f3d72af569ab4360b347c73ed4806067.html" target="_blank" rel="noopener">официальной документации</a>.</p>
<h3>Вызов из ABAP</h3>
<p>Вызвать функционал сопоставления строк через Fuzzy Search можно в AMDP процедуре:</p><pre class="urvanov-syntax-highlighter-plain-tag">CLASS zcl_hdb_string_comparator DEFINITION
  PUBLIC
  FINAL
  CREATE PUBLIC.

  PUBLIC SECTION.
    CONSTANTS: BEGIN OF gc_search_modes,
                 compare         TYPE string VALUE 'compare',
                 search          TYPE string VALUE 'search',
                 searchcompare   TYPE string VALUE 'searchCompare',
                 symmetricsearch TYPE string VALUE 'symmetricsearch',
                 substringsearch TYPE string VALUE 'substringsearch',
                 typeahead       TYPE string VALUE 'typeAhead',
                 flexible        TYPE string VALUE 'flexible',
                 abap            TYPE string VALUE 'ABAP',
               END OF gc_search_modes.
    TYPES:
      ty_score TYPE p LENGTH 3 DECIMALS 4,

      BEGIN OF ts_score,
        score TYPE ty_score,
      END OF ts_score,

      tt_scores TYPE STANDARD TABLE OF ts_score WITH DEFAULT KEY.
    INTERFACES:
      if_amdp_marker_hdb.
    CLASS-METHODS:
      match IMPORTING iv_sub          TYPE string
                      iv_val          TYPE string
                      iv_fuzzy_score  TYPE ty_score   OPTIONAL
                      iv_search_mode  TYPE string     OPTIONAL
                      iv_flex_conf    TYPE string     OPTIONAL
            EXPORTING ev_fact_score   TYPE ty_score
            RETURNING VALUE(rv_score) TYPE ty_score.
  PRIVATE SECTION.
    CLASS-METHODS:
      match_int IMPORTING VALUE(iv_sub)         TYPE string
                          VALUE(iv_val)         TYPE string
                          VALUE(iv_search_mode) TYPE string
                          VALUE(iv_fuzzy_score) TYPE ty_score
                EXPORTING VALUE(et_scores)      TYPE tt_scores
                RAISING cx_amdp_error.
ENDCLASS.

CLASS zcl_hdb_string_comparator IMPLEMENTATION.
  METHOD match.
    DATA:
      lv_mode TYPE string.

    CLEAR ev_fact_score.

    IF iv_search_mode IS INITIAL.
      rv_score = ev_fact_score = COND #( WHEN iv_sub = iv_val THEN 1 ELSE 0 ).
      RETURN.
    ENDIF.

    IF iv_search_mode = gc_search_modes-abap.
      rv_score = ev_fact_score = ( 1 - distance( val1 = iv_sub val2 = iv_val ) / nmax( val1 = strlen( iv_sub ) val2 = strlen( iv_val ) ) ).
    ELSE.
      lv_mode = iv_search_mode.

      IF iv_flex_conf IS NOT INITIAL.
        lv_mode = lv_mode &amp;&amp; `, ` &amp;&amp; iv_flex_conf.
      ENDIF.

      TRY.
          match_int( EXPORTING iv_search_mode = lv_mode
                               iv_val         = iv_val
                               iv_sub         = iv_sub
                               iv_fuzzy_score = 0
                     IMPORTING et_scores = DATA(lt_scores) ).

          rv_score = ev_fact_score = VALUE #( lt_scores[ 1 ]-score OPTIONAL ).
        CATCH cx_amdp_error.
          RETURN.
      ENDTRY.
    ENDIF.

    rv_score = COND #( WHEN rv_score &gt;= iv_fuzzy_score THEN rv_score ELSE 0 ).
  ENDMETHOD.

  METHOD match_int BY DATABASE PROCEDURE
                   FOR HDB LANGUAGE SQLSCRIPT
                   OPTIONS READ-ONLY.

    DECLARE lt_search_tab TABLE ( col_search NVARCHAR(1000));
    lt_search_tab[1] = :iv_val;

    et_scores = SELECT SCORE() AS score
      FROM :lt_search_tab
        WHERE CONTAINS( col_search, :iv_sub, FUZZY( :iv_fuzzy_score, :iv_search_mode ) );
  ENDMETHOD.

ENDCLASS.</pre><p>В классе можно воспользоваться как ABAP режимом сопоставления через функцию distance, так и прочими режимами рассмотренными ранее.</p>
<p>Программа для тестирования сопоставлений:</p><pre class="urvanov-syntax-highlighter-plain-tag">PARAMETERS:
  p_1    TYPE text1024,
  p_2    TYPE text1024,
  p_m    TYPE text1024 DEFAULT 'COMPARE',
  p_sc   TYPE zcl_hdb_string_comparator=&gt;ty_score DEFAULT '0.5',
  p_flex TYPE text1024.

TYPES:
  BEGIN OF ts_modes,
    mode TYPE char100,
  END OF ts_modes,
  tt_modes TYPE STANDARD TABLE OF ts_modes WITH EMPTY KEY.

DATA lt_return_table  TYPE STANDARD TABLE OF ddshretval.

AT SELECTION-SCREEN ON VALUE-REQUEST FOR p_m.
  DATA(lt_modes) = VALUE tt_modes( FOR &lt;ls&gt; IN
    CAST cl_abap_structdescr(
      CAST cl_abap_classdescr( cl_abap_classdescr=&gt;describe_by_name( 'ZCL_HDB_STRING_COMPARATOR' )
        )-&gt;get_attribute_type( 'GC_SEARCH_MODES' )
          )-&gt;get_components( ) ( mode = &lt;ls&gt;-name ) ).

  CALL FUNCTION 'F4IF_INT_TABLE_VALUE_REQUEST'
    EXPORTING
      retfield   = 'MODE'
      value_org  = 'S'
    TABLES
      value_tab  = lt_modes
      return_tab = lt_return_table.

  p_m = VALUE #( lt_return_table[ 1 ]-fieldval OPTIONAL ).

START-OF-SELECTION.
  zcl_hdb_string_comparator=&gt;match(
    EXPORTING
      iv_sub         = CONV #( p_1 )
      iv_val         = CONV #( p_2 )
      iv_fuzzy_score = p_sc
      iv_search_mode = CONV #( p_m )
      iv_flex_conf   = CONV #( p_flex )
    RECEIVING
      rv_score       = DATA(rv_score) ).

  WRITE: 'Оценка: ', rv_score.

INITIALIZATION.
  %_p_1_%_app_%-text    = 'Что ищем (строка А)'.
  %_p_2_%_app_%-text    = 'Где ищем (строка Б)'.
  %_p_m_%_app_%-text    = 'Режим сопоставления'.
  %_p_sc_%_app_%-text   = 'Минимальный порог'.
  %_p_flex_%_app_%-text = 'Доп. параметры к гибкому режиму'.</pre><p>&nbsp;</p><p>The post <a href="https://abap-blog.ru/hana/hana-fuzzy-search/">Оценка похожести строк через Fuzzy Search</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></content:encoded>
					
					<wfw:commentRss>https://abap-blog.ru/hana/hana-fuzzy-search/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>SXPG Framework</title>
		<link>https://abap-blog.ru/others/sxpg_framework/</link>
					<comments>https://abap-blog.ru/others/sxpg_framework/#respond</comments>
		
		<dc:creator><![CDATA[Astrafox]]></dc:creator>
		<pubDate>Sun, 25 Apr 2021 09:23:40 +0000</pubDate>
				<category><![CDATA[Прочее]]></category>
		<guid isPermaLink="false">https://abap-blog.ru/?p=7234</guid>

					<description><![CDATA[<p>Некоторые задачи невозможно или очень сложно решить только средствами языка ABAP (работа с архивами, криптографией и т.п.), в таких случаях мы можем воспользоваться внешними программами либо через их вызов на сервере представления, либо на сервере приложений. Взаимодействие с сервером представления уже было ранее описано в блоге. В данной статье рассмотрим возможности вызова команд на стороне [&#8230;]</p>
<p>The post <a href="https://abap-blog.ru/others/sxpg_framework/">SXPG Framework</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></description>
										<content:encoded><![CDATA[<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/bash_36261.png"><img loading="lazy" class="wp-image-7237 alignleft" src="https://abap-blog.ru/wp-content/uploads/2021/04/bash_36261.png" alt="" width="285" height="285" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/bash_36261.png 512w, https://abap-blog.ru/wp-content/uploads/2021/04/bash_36261-300x300.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/bash_36261-150x150.png 150w" sizes="(max-width: 285px) 100vw, 285px" /></a></p>
<p>Некоторые задачи невозможно или очень сложно решить только средствами языка ABAP (работа с архивами, криптографией и т.п.), в таких случаях мы можем воспользоваться внешними программами либо через их вызов на сервере представления, либо на сервере приложений.</p>
<p><a href="https://abap-blog.ru/osnovy-abap/frontend/" target="_blank" rel="noopener">Взаимодействие с сервером представления</a> уже было ранее описано в блоге. В данной статье рассмотрим возможности вызова команд на стороне сервера приложений.</p>
<p>Существует как минимум три возможности вызова команд на сервере приложений:</p>
<ul>
<li>Использование дополнения <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abapopen_dataset_os_addition.htm" target="_blank" rel="noopener">FILTER</a> в OPEN DATASET</li>
<li>Использование команды <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abapcall-.htm" target="_blank" rel="noopener">CALL &#8216;SYSTEM&#8217;</a></li>
<li>Вызов команд через <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abenabap_system_commands_appl_sxpg.htm" target="_blank" rel="noopener">SXPG</a> фреймворк</li>
</ul>
<p>Первые два способа официально <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abenabap_system_commands_appl_depr.htm" target="_blank" rel="noopener">не рекомендуется использовать</a>, по следующим причинам:</p>
<ul>
<li>Нет централизованной проверки полномочий</li>
<li>Платформенная зависимость должна быть обработана на уровне ABAP кода</li>
<li>Отсутствие возможности обработки исключительных ситуаций</li>
<li>Возможны <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abensys_comm_injections_scrty.htm" target="_blank" rel="noopener">вредоносные внедрения системных команд</a></li>
</ul>
<p>Рассмотрим третий вариант.</p>
<p><span id="more-7234"></span></p>
<p>SXPG Framework по своей сути представляет доступ к заранее определённым и разрешённым командам и их вызовам через функциональные модули с префиксом SXPG_*. Список разрешённых команд определяется в транзакции <strong>SM69 (SM49)</strong>.</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/sm69.png"><img loading="lazy" class="alignnone size-full wp-image-7243" src="https://abap-blog.ru/wp-content/uploads/2021/04/sm69.png" alt="" width="868" height="414" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/sm69.png 868w, https://abap-blog.ru/wp-content/uploads/2021/04/sm69-300x143.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/sm69-768x366.png 768w" sizes="(max-width: 868px) 100vw, 868px" /></a></p>
<p>SAP заранее уже определил ряд команд, которые можно переиспользовать для своих нужд, вместо заведения их аналогов. Команды ведутся в разрезе платформ, на которых они могут быть запущены &#8212; UNIX, WINDOWS и т.п. Соответственно при запуске команд сначала определяется в рамках какой ОС работает сервер приложений и уже потом происходит вызов команды относительно типа платформы.</p>
<p>Пользователь, под которым выполняются команды обычно имеет имя <strong>&lt;sid&gt;adm</strong>.</p>
<h3>Создание и тестирование</h3>
<p>Команды определяемые клиентом должны начинаться с <strong>Z*</strong> или <strong>Y*</strong>.</p>
<p>Создадим новую команду:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/create-1.png"><img loading="lazy" class="alignnone size-full wp-image-7252" src="https://abap-blog.ru/wp-content/uploads/2021/04/create-1.png" alt="" width="596" height="50" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/create-1.png 596w, https://abap-blog.ru/wp-content/uploads/2021/04/create-1-300x25.png 300w" sizes="(max-width: 596px) 100vw, 596px" /></a></p>
<p>Определим её следующим образом:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/ls.png"><img loading="lazy" class="alignnone size-full wp-image-7245" src="https://abap-blog.ru/wp-content/uploads/2021/04/ls.png" alt="" width="607" height="352" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/ls.png 607w, https://abap-blog.ru/wp-content/uploads/2021/04/ls-300x174.png 300w" sizes="(max-width: 607px) 100vw, 607px" /></a></p>
<p>Команда <a href="https://ru.wikipedia.org/wiki/Ls" target="_blank" rel="noopener">ls</a> в UNIX системах позволяет вывести содержимое каталога.</p>
<p>Параметры команды могут быть заданы статически в определении команды или динамически передаваться через интерфейс SXPG. Чтобы иметь возможность задавать параметры команды динамически, необходимо включить галочку <strong>Additional parameters allowed</strong>.</p>
<p>Если требуется перед выполнением выполнить какую-либо валидацию команды (например доп. проверку полномочий), реализовать это можно указав в поле Check Module собственный ФМ, интерфейс которого будет аналогичен стандартному ФМ-у: <strong>SXPG_DUMMY_COMMAND_CHECK</strong>.</p>
<p>Протестировать команду можно там же в SM69 по F8. Зададим дополнительный параметр -a для вывода всех файлов:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/ls-execute.png"><img loading="lazy" class="alignnone size-full wp-image-7246" src="https://abap-blog.ru/wp-content/uploads/2021/04/ls-execute.png" alt="" width="599" height="458" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/ls-execute.png 599w, https://abap-blog.ru/wp-content/uploads/2021/04/ls-execute-300x229.png 300w" sizes="(max-width: 599px) 100vw, 599px" /></a></p>
<p>При выполнении в <strong>Execution Target</strong> можно определить на каком сервере приложений её необходимо вызывать.</p>
<p>Результат выполнения команды:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/ls_result.png"><img loading="lazy" class="alignnone size-full wp-image-7247" src="https://abap-blog.ru/wp-content/uploads/2021/04/ls_result.png" alt="" width="684" height="612" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/ls_result.png 684w, https://abap-blog.ru/wp-content/uploads/2021/04/ls_result-300x268.png 300w" sizes="(max-width: 684px) 100vw, 684px" /></a></p>
<p>Статус выполнения команды можно оценить по полям <strong>EXIT Code</strong> и <strong>EXIT Status</strong>. Статус О говорит об успешном выполнении команды, статус Е об ошибке при выполнении. Более подробное описание для UNIX систем описано в ноте: <a href="https://launchpad.support.sap.com/#/notes/1128667" target="_blank" rel="noopener">1128667 &#8212; SXPG_COMMAND_EXECUTE: Parameters STATUS and EXITCODE</a>.</p>
<h3>Выполнение внешних команд</h3>
<p>Перед выполнением любой команды происходит проверка полномочий по стандартному объекту полномочий &#8212; <span class="fontstyle0"><strong>S_LOG_COM</strong>, его параметры:</span></p>
<ul>
<li><span class="fontstyle2">COMMAND &#8212; определяет имя команды</span></li>
<li><span class="fontstyle2">OPSYSTEM &#8212; ОС</span></li>
<li><span class="fontstyle2">HOST &#8212; имя сервера приложений</span></li>
</ul>
<p>Вызов команд из ABAP кода происходит через вызов ФМ:</p>
<ul class="disc">
<li><strong><span class="lnkgrey"><span class="qtext400">SXPG_CALL_SYSTEM</span></span> </strong>для выполнения на текущем сервере приложений</li>
<li><strong><span class="lnkgrey"><span class="qtext400">SXPG_COMMAND_EXECUTE</span></span> </strong>для выполнения на заданном сервере приложений</li>
<li><strong><span class="lnkgrey"><span class="qtext400">SXPG_COMMAND_EXECUTE_LONG</span></span></strong>, аналогичен предыдущему, с возможностью передачи более длинного списка параметров для выполнения команды.</li>
</ul>
<p>Данные ФМ-ы можно вызывать через RFC интерфейс.</p>
<p>Внешние команды могут быть частью фонового задания, как один из его шагов (определение команды в транзакции <strong>SM36</strong>):</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/sm36.png"><img loading="lazy" class="alignnone size-full wp-image-7248" src="https://abap-blog.ru/wp-content/uploads/2021/04/sm36.png" alt="" width="920" height="499" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/sm36.png 920w, https://abap-blog.ru/wp-content/uploads/2021/04/sm36-300x163.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/sm36-768x417.png 768w" sizes="(max-width: 920px) 100vw, 920px" /></a></p>
<h3>Пример вызова в ABAP</h3>
<p></p><pre class="urvanov-syntax-highlighter-plain-tag">DATA: lv_parameters TYPE sxpgcolist-parameters VALUE '-a',
        lt_result     TYPE TABLE OF btcxpm WITH EMPTY KEY.

  CALL FUNCTION 'SXPG_CALL_SYSTEM'
    EXPORTING
      commandname           = 'ZLS'
      additional_parameters = lv_parameters
    TABLES
      exec_protocol         = lt_result
    EXCEPTIONS
      no_permission         = 1
      command_not_found     = 2
      security_risk         = 3
      OTHERS                = 4.

  IF sy-subrc = 0.
    cl_demo_output=&gt;display( lt_result ).
  ELSE.
    cl_demo_output=&gt;display( |Error, return code { sy-subrc }| ).
  ENDIF.</pre><p>Результат:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/ls_result_abap.png"><img loading="lazy" class="alignnone size-full wp-image-7249" src="https://abap-blog.ru/wp-content/uploads/2021/04/ls_result_abap.png" alt="" width="281" height="297" /></a></p><p>The post <a href="https://abap-blog.ru/others/sxpg_framework/">SXPG Framework</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></content:encoded>
					
					<wfw:commentRss>https://abap-blog.ru/others/sxpg_framework/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Запуск транзакций из сообщений</title>
		<link>https://abap-blog.ru/osnovy-abap/call_transaction_se91_documentation/</link>
					<comments>https://abap-blog.ru/osnovy-abap/call_transaction_se91_documentation/#respond</comments>
		
		<dc:creator><![CDATA[Astrafox]]></dc:creator>
		<pubDate>Thu, 22 Apr 2021 09:17:05 +0000</pubDate>
				<category><![CDATA[SAP Dynpro]]></category>
		<category><![CDATA[Основы ABAP]]></category>
		<guid isPermaLink="false">https://abap-blog.ru/?p=7192</guid>

					<description><![CDATA[<p>В подробных текстах сообщений (тр. SE91) или в документации (тр. SO10) мы кроме непосредственно описания можем так же вставлять ссылки на транзакции или отчёты для их запуска, что позволяет упростить жизнь пользователям. Однако у стандартной реализации данного механизма есть ряд ограничений: Длинна ссылки ограничена, из-за чего передать все необходимые параметры для запуска транзакции может не [&#8230;]</p>
<p>The post <a href="https://abap-blog.ru/osnovy-abap/call_transaction_se91_documentation/">Запуск транзакций из сообщений</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></description>
										<content:encoded><![CDATA[<p>В подробных текстах сообщений (тр. <strong>SE91</strong>) или в документации (тр. <strong>SO10</strong>) мы кроме непосредственно описания можем так же вставлять ссылки на транзакции или отчёты для их запуска, что позволяет упростить жизнь пользователям.</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/run_report.png"><img loading="lazy" class="alignnone size-full wp-image-7224" src="https://abap-blog.ru/wp-content/uploads/2021/04/run_report.png" alt="" width="424" height="179" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/run_report.png 424w, https://abap-blog.ru/wp-content/uploads/2021/04/run_report-300x127.png 300w" sizes="(max-width: 424px) 100vw, 424px" /></a></p>
<p>Однако у стандартной реализации данного механизма есть ряд ограничений:</p>
<ul>
<li>Длинна ссылки ограничена, из-за чего передать все необходимые параметры для запуска транзакции может не получиться.</li>
<li>Нет возможности вставки интернет-ссылок более 70 символов (ограничение стандарта).</li>
<li>Нет возможности запуска отчёта с параметрами (только запуск с вариантом).</li>
</ul>
<p>В статье рассмотрим каким образом можно расширить стандартные возможности чтобы избежать вышеуказанных ограничений.</p>
<p><span id="more-7192"></span></p>
<p>Для того чтобы вставить ссылку в подробном тексте сообщения, необходимо перейти в меню:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/insert_link.png"><img loading="lazy" class="alignnone size-full wp-image-7215" src="https://abap-blog.ru/wp-content/uploads/2021/04/insert_link.png" alt="" width="604" height="287" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/insert_link.png 604w, https://abap-blog.ru/wp-content/uploads/2021/04/insert_link-300x143.png 300w" sizes="(max-width: 604px) 100vw, 604px" /></a></p>
<p>При активации может возникнуть сообщение об ошибке, следует нажать кнопку игнорировать.</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/ignore_activation.png"><img loading="lazy" class="alignnone size-full wp-image-7216" src="https://abap-blog.ru/wp-content/uploads/2021/04/ignore_activation.png" alt="" width="475" height="147" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/ignore_activation.png 475w, https://abap-blog.ru/wp-content/uploads/2021/04/ignore_activation-300x93.png 300w" sizes="(max-width: 475px) 100vw, 475px" /></a></p>
<p>Для корректного отображения вставляемых ссылок следует отключить графический редактор:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/disable_graphical_editor.png"><img loading="lazy" class="alignnone size-full wp-image-7217" src="https://abap-blog.ru/wp-content/uploads/2021/04/disable_graphical_editor.png" alt="" width="611" height="349" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/disable_graphical_editor.png 611w, https://abap-blog.ru/wp-content/uploads/2021/04/disable_graphical_editor-300x171.png 300w" sizes="(max-width: 611px) 100vw, 611px" /></a></p>
<p>Существует несколько стандартных возможности по вставке ссылок на транзакции/отчёты, разберём на примере запуска транзакции просмотра журнала (тр. <strong>SLG1</strong>) и отчёта автоматического поиска нот (тр. <strong>ANST</strong>):</p>
<ul>
<li><strong>Запуск транзакции без пропуска экрана (связь с транзакцией&#8230;)</strong>: &lt;DS:TRAN.SLG1(BALOBJ.&amp;V1&amp;)(BALSUBOBJ.&amp;V2&amp;)&gt;Open SLG1&lt;/&gt;</li>
<li><strong>Запуск транзакции с пропуском экрана</strong>: &lt;DS:TRAS.SLG1(BALOBJ.&amp;V1&amp;)&gt;Run SLG1&lt;/&gt;</li>
<li><strong>Запуск отчёта (диалоговое выполнение отчёта&#8230;)</strong>: &lt;DS:REPO.ANST_SEARCH_TOOL.&amp;V3&amp;&gt;Open ANST Report&lt;/&gt;</li>
<li>Есть и другие варианты, например &#8212; немедленное планирование отчёта в фоне, но логика обработки там аналогичная.</li>
</ul>
<p>BALOBJ и BALSUBOBJ это ID параметров, которые можно передавать через память при запуске транзакции (SET MEMORY ID&#8230;):</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/memory_id.png"><img loading="lazy" class="alignnone size-full wp-image-7219" src="https://abap-blog.ru/wp-content/uploads/2021/04/memory_id.png" alt="" width="705" height="426" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/memory_id.png 705w, https://abap-blog.ru/wp-content/uploads/2021/04/memory_id-300x181.png 300w" sizes="(max-width: 705px) 100vw, 705px" /></a></p>
<p>При запуске диалогового выполнения отчёта мы указываем имя варианта. Во всех случаях для большей гибкости параметры передаются из программы через параметры к сообщению (хотя можно задавать и статически).</p>
<p>Пример вызова сообщения:</p><pre class="urvanov-syntax-highlighter-plain-tag">START-OF-SELECTION.   
  MESSAGE i000(zsm_mess) WITH 'ANST_TESTING' 'ANST_TESTING_AT_REC' 'VAR'.</pre><p>Стандартная реализация обработки таких ссылок лежит в классе <strong>CL_EPSS_SAPEVENT</strong>, а вызов его происходит по настройке в ракурсе <strong>EPSSA2</strong>. Чтобы создать свой обработчик для своих типов ссылок, следует создать наследуемый от вышеуказанного класс и добавить запись в ракурс через тр. <strong>SM30</strong>:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/new_epssa2.png"><img loading="lazy" class="alignnone size-full wp-image-7220" src="https://abap-blog.ru/wp-content/uploads/2021/04/new_epssa2.png" alt="" width="588" height="259" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/new_epssa2.png 588w, https://abap-blog.ru/wp-content/uploads/2021/04/new_epssa2-300x132.png 300w" sizes="(max-width: 588px) 100vw, 588px" /></a></p>
<p>При этом стандартную запись следует удалить, чтобы обеспечить корректность порядка вызовов (если этого не сделать, придётся вносить типы ссылок в настройку TDCLD). В наследуемом классе мы переопределим для Custom типов ссылок поведения обработчика &#8212; метод RESOLVE_LINK, для всех прочих типов ссылок будет отрабатывать стандартная логика.</p>
<p>Полный код нового класса:</p><pre class="urvanov-syntax-highlighter-plain-tag">CLASS zcl_epss_sapevent DEFINITION
  PUBLIC
  INHERITING FROM cl_epss_sapevent
  FINAL
  CREATE PUBLIC.
  PUBLIC SECTION.

    TYPES:
      tt_report_parameters TYPE STANDARD TABLE OF rsparamsl_255 .

    CLASS-METHODS set_report_parameters
      IMPORTING
        !it_parameters TYPE tt_report_parameters .

    METHODS resolve_link
        REDEFINITION .
  PROTECTED SECTION.
  PRIVATE SECTION.

    CONSTANTS:
      BEGIN OF gc_link_types,
        zrep TYPE string VALUE 'ZREP',
        zurl TYPE string VALUE 'ZURL',
      END OF gc_link_types .
    DATA mv_doc_link TYPE string.
    CLASS-DATA gt_report_parameters TYPE tt_report_parameters .

    METHODS process_report .
    METHODS process_url .
ENDCLASS.

CLASS zcl_epss_sapevent IMPLEMENTATION.

  METHOD process_report.
    " Пример: &lt;DS:ZREP.ANST_SEARCH_TOOL&gt;Open ANST&lt;/&gt;

    SPLIT mv_doc_link+8 AT '.' INTO TABLE DATA(lt_parts).
    DATA(lv_prog) = VALUE sy-cprog( lt_parts[ 1 ] OPTIONAL ).

    IF lv_prog IS INITIAL.
      CLEAR: gt_report_parameters.
      RETURN.
    ENDIF.

    SUBMIT (lv_prog)
      VIA SELECTION-SCREEN
      AND RETURN
      WITH SELECTION-TABLE gt_report_parameters.

    CLEAR: gt_report_parameters.
  ENDMETHOD.

  METHOD process_url.
    " Пример: &lt;DS:ZURL.http://abap-blog.ru&gt;Open ABAP Blog&lt;/&gt;
    DATA:
      lv_url TYPE bxmnodes-url.

    lv_url = mv_doc_link+8.

    CALL FUNCTION 'CALL_BROWSER'
      EXPORTING
        url    = lv_url
      EXCEPTIONS
        OTHERS = 0.
  ENDMETHOD.

  METHOD resolve_link.
    mv_doc_link = doc_link.

    CASE mv_doc_link+3(4).
      WHEN gc_link_types-zrep.
        process_report( ).
      WHEN gc_link_types-zurl.
        process_url( ).
      WHEN OTHERS.
        super-&gt;resolve_link(
          EXPORTING
            doc_link         = doc_link
            epss_html_viewer = epss_html_viewer
            help_info        = help_info ).
    ENDCASE.
  ENDMETHOD.

  METHOD set_report_parameters.
    gt_report_parameters = it_parameters.
  ENDMETHOD.
ENDCLASS.</pre><p>Новые типы ссылок:</p>
<ul>
<li><strong>Запуск URL</strong>: &lt;DS:ZURL.http://abap-blog.ru&gt;Open ABAP Blog&lt;/&gt;</li>
<li><strong>Запуск отчёта с заданными параметрами экрана</strong>: &lt;DS:ZREP.ANST_SEARCH_TOOL&gt;Open ANST&lt;/&gt;</li>
</ul>
<p>Для запуска отчёта мы предварительно заполняем параметры отчёта:</p><pre class="urvanov-syntax-highlighter-plain-tag">START-OF-SELECTION.
  zcl_epss_sapevent=&gt;set_report_parameters(
    it_parameters = VALUE #( ( selname = 'P_TRANS' kind = 'P' option = 'EQ' low = 'SE24' ) ) ).

  MESSAGE i000(zsm_mess) WITH 'ANST_TESTING' 'ANST_TESTING_AT_REC' 'VAR'.</pre><p>Подводя итог можно сказать что таким образом мы можем реализовать как собственные типы ссылок, так и расширять функционал стандартных.</p><p>The post <a href="https://abap-blog.ru/osnovy-abap/call_transaction_se91_documentation/">Запуск транзакций из сообщений</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></content:encoded>
					
					<wfw:commentRss>https://abap-blog.ru/osnovy-abap/call_transaction_se91_documentation/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Запуск транзакций из SBWP</title>
		<link>https://abap-blog.ru/osnovy-abap/call_transaction_sbwp/</link>
					<comments>https://abap-blog.ru/osnovy-abap/call_transaction_sbwp/#respond</comments>
		
		<dc:creator><![CDATA[Astrafox]]></dc:creator>
		<pubDate>Wed, 21 Apr 2021 04:48:16 +0000</pubDate>
				<category><![CDATA[Основы ABAP]]></category>
		<guid isPermaLink="false">https://abap-blog.ru/?p=7156</guid>

					<description><![CDATA[<p>Иногда нам необходимо оповестить пользователя о каком-либо событии по внутренней почте, с возможностью его перехода к заданной транзакции и с учётом контекста оповещения, т.е. с заполнением параметров актуальных для данного оповещения. Во внутренней почте мы можем сформировать ссылку на бизнес объект (транзакция SWO1), а уже у бизнес объекта реализовать метод display для запуска нужной нам [&#8230;]</p>
<p>The post <a href="https://abap-blog.ru/osnovy-abap/call_transaction_sbwp/">Запуск транзакций из SBWP</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></description>
										<content:encoded><![CDATA[<p>Иногда нам необходимо оповестить пользователя о каком-либо событии по внутренней почте, с возможностью его перехода к заданной транзакции и с учётом контекста оповещения, т.е. с заполнением параметров актуальных для данного оповещения.</p>
<p>Во внутренней почте мы можем сформировать ссылку на бизнес объект (транзакция <strong>SWO1</strong>), а уже у бизнес объекта реализовать метод <strong>display</strong> для запуска нужной нам транзакции.</p>
<p>Давайте разберёмся как это сделать.</p>
<p><span id="more-7156"></span></p>
<p>Для начала переходим в транзакцию <strong>SWO1</strong> и создаём новый объект &#8212; ZSMTRCALL:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/1swo_create.png"><img loading="lazy" class="alignnone size-full wp-image-7157" src="https://abap-blog.ru/wp-content/uploads/2021/04/1swo_create.png" alt="" width="415" height="226" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/1swo_create.png 415w, https://abap-blog.ru/wp-content/uploads/2021/04/1swo_create-300x163.png 300w" sizes="(max-width: 415px) 100vw, 415px" /></a></p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/2swo_create-1.png"><img loading="lazy" class="alignnone size-full wp-image-7160" src="https://abap-blog.ru/wp-content/uploads/2021/04/2swo_create-1.png" alt="" width="453" height="228" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/2swo_create-1.png 453w, https://abap-blog.ru/wp-content/uploads/2021/04/2swo_create-1-300x151.png 300w" sizes="(max-width: 453px) 100vw, 453px" /></a></p>
<p>Для запуска транзакции определим ключевое поле &#8212; ид. транзакции:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/3key_field.png"><img loading="lazy" class="alignnone size-full wp-image-7162" src="https://abap-blog.ru/wp-content/uploads/2021/04/3key_field.png" alt="" width="453" height="211" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/3key_field.png 453w, https://abap-blog.ru/wp-content/uploads/2021/04/3key_field-300x140.png 300w" sizes="(max-width: 453px) 100vw, 453px" /></a></p>
<p>Можно определить на базе стандартной таблицы TSTC:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/3tid_key.png"><img loading="lazy" class="alignnone size-full wp-image-7167" src="https://abap-blog.ru/wp-content/uploads/2021/04/3tid_key.png" alt="" width="587" height="165" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/3tid_key.png 587w, https://abap-blog.ru/wp-content/uploads/2021/04/3tid_key-300x84.png 300w" sizes="(max-width: 587px) 100vw, 587px" /></a></p>
<p>При запуске необходимо каким-то образом определять контекст запуска, для этого у нашего бизнес объекта определим ключевое поле в виде GUID-a:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/3key_description.png"><img loading="lazy" class="alignnone size-full wp-image-7163" src="https://abap-blog.ru/wp-content/uploads/2021/04/3key_description.png" alt="" width="594" height="161" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/3key_description.png 594w, https://abap-blog.ru/wp-content/uploads/2021/04/3key_description-300x81.png 300w" sizes="(max-width: 594px) 100vw, 594px" /></a></p>
<p>Переопределим метод <strong>display</strong>:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/4display.png"><img loading="lazy" class="alignnone size-full wp-image-7164" src="https://abap-blog.ru/wp-content/uploads/2021/04/4display.png" alt="" width="745" height="324" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/4display.png 745w, https://abap-blog.ru/wp-content/uploads/2021/04/4display-300x130.png 300w" sizes="(max-width: 745px) 100vw, 745px" /></a></p>
<p>И перейдём к коду:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/4display_change-1.png"><img loading="lazy" class="alignnone size-full wp-image-7166" src="https://abap-blog.ru/wp-content/uploads/2021/04/4display_change-1.png" alt="" width="704" height="324" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/4display_change-1.png 704w, https://abap-blog.ru/wp-content/uploads/2021/04/4display_change-1-300x138.png 300w" sizes="(max-width: 704px) 100vw, 704px" /></a></p>
<p>Код реализации метода display:</p><pre class="urvanov-syntax-highlighter-plain-tag">begin_method display changing container.
DATA:
  lt_params TYPE STANDARD TABLE OF tpara.

lt_params = VALUE #( ( paramid = 'ZSMGUID' partext = object-key-guid22 ) ).

CALL FUNCTION 'CC_CALL_TRANSACTION_NEW_TASK' DESTINATION 'NONE' STARTING NEW TASK space
  EXPORTING
    transaction       = CONV sy-tcode( object-key-transactioncode )
    skip_first_screen = abap_true
  TABLES
    paramtab          = lt_params
  EXCEPTIONS
    error             = 1
    OTHERS            = 2.
IF sy-subrc &lt;&gt; 0.
  MESSAGE ID sy-msgid TYPE sy-msgty NUMBER sy-msgno
    WITH sy-msgv1 sy-msgv2 sy-msgv3 sy-msgv4.
ENDIF.
end_method.</pre><p>Переведём статус БО (implemented затем released):</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/6release-1.png"><img loading="lazy" class="alignnone size-full wp-image-7171" src="https://abap-blog.ru/wp-content/uploads/2021/04/6release-1.png" alt="" width="970" height="327" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/6release-1.png 970w, https://abap-blog.ru/wp-content/uploads/2021/04/6release-1-300x101.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/6release-1-768x259.png 768w" sizes="(max-width: 970px) 100vw, 970px" /></a></p>
<p>И сгенерируем нажав на красную кнопку генерации.</p>
<p>Исходя из кода, в запускаемой транзакции должен быть SET/GET параметр с ID контекста, назовём его <!--StartFragment -->ZSMGUID, перейдём в SE80 и создадим параметр:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/5spa.png"><img loading="lazy" class="alignnone size-full wp-image-7168" src="https://abap-blog.ru/wp-content/uploads/2021/04/5spa.png" alt="" width="844" height="489" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/5spa.png 844w, https://abap-blog.ru/wp-content/uploads/2021/04/5spa-300x174.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/5spa-768x445.png 768w" sizes="(max-width: 844px) 100vw, 844px" /></a></p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/5spa_save.png"><img loading="lazy" class="alignnone size-full wp-image-7169" src="https://abap-blog.ru/wp-content/uploads/2021/04/5spa_save.png" alt="" width="449" height="184" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/5spa_save.png 449w, https://abap-blog.ru/wp-content/uploads/2021/04/5spa_save-300x123.png 300w" sizes="(max-width: 449px) 100vw, 449px" /></a></p>
<p>В транзакции относительно значения параметра привязанного к SET/GET параметру будет считываться контекст запуска (значения экрана выбора как правило).</p>
<p>Само сохранение и чтение контекста может быть реализовано множеством способов:</p>
<ul>
<li>своя Z таблица с хранением значений экрана выбора,</li>
<li>сохранение варианта в программе, тогда логичнее будет сделать не CALL TRANSACTION, а SUBMIT и ID контекста заменить на ID варианта,</li>
<li>сохранение в INDX таблице или подобной,</li>
<li>использовать какое-либо другое стандартное решение.</li>
</ul>
<p>В данном примере мы только выведем ID контекста, код программы:</p><pre class="urvanov-syntax-highlighter-plain-tag">REPORT zsm_demo_call.

PARAMETERS:
  p_guid TYPE swu_form-guid MEMORY ID zsmguid.

START-OF-SELECTION.
  WRITE: `Context ID: `, p_guid.</pre><p>Создадим транзакцию к программе &#8212; ZSM_CALL_DEMO</p>
<p>Уже сейчас мы можем протестировать наш БО, передав в него ключ в виде Транзакции и ID контекста, после чего вызвать метод display:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/7test.png"><img loading="lazy" class="alignnone size-full wp-image-7172" src="https://abap-blog.ru/wp-content/uploads/2021/04/7test.png" alt="" width="683" height="206" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/7test.png 683w, https://abap-blog.ru/wp-content/uploads/2021/04/7test-300x90.png 300w" sizes="(max-width: 683px) 100vw, 683px" /></a></p>
<p>Если всё сделано правильно, отобразиться наш отчёт с выводом GUID-a контекста.</p>
<blockquote><p>Если Вам достаточно лишь запустить транзакцию, необходимости в создании своего БО нет, т.к. есть несколько уже существующих, например: <strong>CUST_TRAN</strong>.</p></blockquote>
<p>Далее воспользуемся тестовой программой отправки письма в SBWP чтобы убедиться в корректном запуске транзакции из внутренней почты:</p><pre class="urvanov-syntax-highlighter-plain-tag">DATA:
  lv_transaction TYPE sy-tcode VALUE 'ZSM_CALL_DEMO',
  lv_guid        TYPE guid_22 VALUE '123',
  lv_object_key  TYPE string.

TRY.
    DATA(lo_msg) = NEW cl_bcs_message( ).
    lo_msg-&gt;set_subject( 'Тест отправки письма'  ).

    lo_msg-&gt;add_recipient(
      EXPORTING
        iv_address      = 'DEVELOPER'
        iv_commtype     = 'USR' ).

    CONCATENATE lv_transaction lv_guid INTO lv_object_key RESPECTING BLANKS.
    lv_object_key = shift_right( lv_object_key ).
    lv_object_key = replace( val = lv_object_key regex = '\s' with = '%20' occ = 0 ).

    lo_msg-&gt;set_main_doc(
      EXPORTING
        iv_contents_txt = |&lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;br/&gt;&lt;b&gt;Тестовое сообщение&lt;/b&gt;&lt;br/&gt;&lt;br/&gt;| &amp;&amp;
                          |&lt;A HREF="sap-object://ZSMTRCALL { lv_object_key }"&gt;| &amp;&amp;
                          |Call transaction ZSM_CALL_DEMO&lt;/A&gt;&lt;/body&gt;&lt;/html&gt;|
        iv_doctype      = 'htm' ).

    lo_msg-&gt;set_send_immediately( abap_true ).
    lo_msg-&gt;send( ).
  CATCH cx_bcs_send INTO DATA(lx_ex).
    MESSAGE lx_ex-&gt;get_text( ) TYPE 'E'.
ENDTRY.</pre><p>В программе отправки мы формируем HTML письмо со ссылкой на SAP объект с помощью специального префикса <strong>sap-object</strong>. После запуска Вы можете зайти в SBWP и убедиться в том, что ссылка работает.</p>
<h4>Альтернативное решение</h4>
<p>Если Вам не требуется формировать ссылку непосредственно в тексте письма, можно не создавать бизнес объект, а вместо этого сформировать вложение в виде ярлыка для запуска транзакции следующим образом:</p><pre class="urvanov-syntax-highlighter-plain-tag">TRY.
    DATA(lo_msg) = NEW cl_bcs_message( ).
    lo_msg-&gt;set_subject( 'Тест отправки письма'  ).

    lo_msg-&gt;add_recipient(
      EXPORTING
        iv_address      = 'DEVELOPER'
        iv_commtype     = 'USR' ).

    NEW cl_nwbc_sapgui_shortcut( 
      iv_transaction_code    = 'ZSM_CALL_DEMO'
      iv_skip_initial_screen = abap_true
      iv_gui_size            = cl_nwbc_sapgui_shortcut=&gt;sc_gui_size_maximized
      it_parameters          = VALUE #( ( name = 'p_guid' value = '123' ) ) 
    )-&gt;get_shortcut(
      IMPORTING
        et_shortcut = DATA(lt_shortcut) ).

    lo_msg-&gt;add_attachment(
      EXPORTING
        iv_description  = 'Open transaction'
        iv_filename     = 'transaction.sap'
        iv_contents_txt = concat_lines_of( table = lt_shortcut 
                                           sep   = cl_abap_char_utilities=&gt;cr_lf ) ).

    lo_msg-&gt;set_main_doc(
      EXPORTING
        iv_contents_txt = |'Shortcut sample|
        iv_doctype      = 'htm' ).

    lo_msg-&gt;set_send_immediately( abap_true ).
    lo_msg-&gt;send( ).
  CATCH cx_bcs_send INTO DATA(lx_ex).
    MESSAGE lx_ex-&gt;get_text( ) TYPE 'E'.
ENDTRY.</pre><p>&nbsp;</p><p>The post <a href="https://abap-blog.ru/osnovy-abap/call_transaction_sbwp/">Запуск транзакций из SBWP</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></content:encoded>
					
					<wfw:commentRss>https://abap-blog.ru/osnovy-abap/call_transaction_sbwp/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Developing and Extending SAP Fiori Elements Apps</title>
		<link>https://abap-blog.ru/network/developing-and-extending-sap-fiori-elements-apps/</link>
					<comments>https://abap-blog.ru/network/developing-and-extending-sap-fiori-elements-apps/#respond</comments>
		
		<dc:creator><![CDATA[Astrafox]]></dc:creator>
		<pubDate>Tue, 20 Apr 2021 17:54:59 +0000</pubDate>
				<category><![CDATA[UI5 & Fiori]]></category>
		<category><![CDATA[Сетевые технологии]]></category>
		<guid isPermaLink="false">https://abap-blog.ru/?p=7180</guid>

					<description><![CDATA[<p>На OpenSAP анонсировали курс посвящённый разработке и расширению приложений на базе Fiori Elements, темы курса: Week 1: Introducing SAP Fiori Elements Week 2: Building Your First SAP Fiori Elements App Week 3: Using More SAP Fiori Elements Capabilities Week 4: Extending a Standard SAP Fiori App Week 5: Final Exam</p>
<p>The post <a href="https://abap-blog.ru/network/developing-and-extending-sap-fiori-elements-apps/">Developing and Extending SAP Fiori Elements Apps</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></description>
										<content:encoded><![CDATA[<p>На OpenSAP анонсировали <a href="https://open.sap.com/courses/fiori-ea1" target="_blank" rel="noopener">курс</a> посвящённый разработке и расширению приложений на базе Fiori Elements, темы курса:</p>
<ul>
<li>Week 1: Introducing SAP Fiori Elements</li>
<li>Week 2: Building Your First SAP Fiori Elements App</li>
<li>Week 3: Using More SAP Fiori Elements Capabilities</li>
<li>Week 4: Extending a Standard SAP Fiori App</li>
<li>Week 5: Final Exam</li>
</ul><p>The post <a href="https://abap-blog.ru/network/developing-and-extending-sap-fiori-elements-apps/">Developing and Extending SAP Fiori Elements Apps</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></content:encoded>
					
					<wfw:commentRss>https://abap-blog.ru/network/developing-and-extending-sap-fiori-elements-apps/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
		<item>
		<title>Внутренние таблицы как источник в SQL запросах</title>
		<link>https://abap-blog.ru/osnovy-abap/internal-table-as-data-source-select/</link>
					<comments>https://abap-blog.ru/osnovy-abap/internal-table-as-data-source-select/#comments</comments>
		
		<dc:creator><![CDATA[Astrafox]]></dc:creator>
		<pubDate>Tue, 13 Apr 2021 17:58:58 +0000</pubDate>
				<category><![CDATA[Основы ABAP]]></category>
		<category><![CDATA[Работа с БД]]></category>
		<guid isPermaLink="false">https://abap-blog.ru/?p=7127</guid>

					<description><![CDATA[<p>В релизе ABAP 7.52 стало возможным использование внутренних таблиц как источника данных в ABAP SQL: [crayon-618a0830655ed496846839/] Существует два сценария выполнения таких запросов: Для выполнения SQL запроса не требуется переноса содержимого внутренней таблицы на уровень СУБД. В таком случае обработка запроса осуществляется непосредственно на сервере приложений, по аналогии с табличным буфером. Для выполнения SQL запроса требуется [&#8230;]</p>
<p>The post <a href="https://abap-blog.ru/osnovy-abap/internal-table-as-data-source-select/">Внутренние таблицы как источник в SQL запросах</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></description>
										<content:encoded><![CDATA[<p>В релизе ABAP 7.52 стало возможным использование внутренних таблиц как <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abapselect_itab.htm" target="_blank" rel="noopener">источника данных</a> в ABAP SQL:</p><pre class="urvanov-syntax-highlighter-plain-tag">SELECT FROM ...@itab AS table_alias...</pre><p>Существует два сценария выполнения таких запросов:</p>
<ul>
<li>Для выполнения SQL запроса не требуется переноса содержимого внутренней таблицы на уровень СУБД. В таком случае обработка запроса осуществляется непосредственно на сервере приложений, по аналогии с табличным буфером.</li>
<li>Для выполнения SQL запроса требуется перенести содержимое внутренней таблицы во временную таблицу на уровень СУБД. Этот сценарий поддерживается не всеми СУБД и чтобы статический анализ кода не ругался, следует использовать прагму: <strong>##itab_db_select</strong>. При отсутствии поддержки система выдаст исключение в runtime &#8212; CX_SY_SQL_UNSUPPORTED_FEATURE.</li>
</ul>
<p>Разберём текущие особенности использования этих сценариев.</p>
<p><span id="more-7127"></span></p>
<p>Основным предназначением данного синтаксиса безусловно является использование внутренней таблицы и JOIN её данных с данными в СУБД. По сути это еще одна альтернатива<strong> FOR ALL ENTRIES</strong>, но без тех ограничений что есть в <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abenwhere_all_entries.htm" target="_blank" rel="noopener">FAE</a>.</p>
<p>Использовать этот синтаксис как замену операций READ TABLE и LOOP в первом сценарии допустимо, но как правило выполняться это будет медленнее. Говоря о первом сценарии следует упомянуть что <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abenbuffer_restrictions.htm" target="_blank" rel="noopener">условия</a>, по которым система решает следует ли переносить таблицу на уровень СУБД аналогичны тем условиям, что используются для определения необходимости обращения к СУБД при использовании буферизированных таблиц. Таким образом таблица будет переносится на уровень СУБД если:</p>
<ul>
<li>Используются агрегатные функции,</li>
<li>Используется DISTINCT,</li>
<li>Используются JOIN-ы,</li>
<li>Используется WITH,</li>
<li>Используются SQL выражения не из <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abenbuffer_expressions.htm" target="_blank" rel="noopener">списка совместимых</a>,</li>
<li>Множество других ограничений&#8230;</li>
</ul>
<p>Убедиться в том что таблица переносится в СУБД можно посмотрев трассировку запроса, выглядеть это будет примерно следующим образом:<a href="https://abap-blog.ru/wp-content/uploads/2021/04/fda_write.png"><img loading="lazy" class="alignnone size-full wp-image-7131" src="https://abap-blog.ru/wp-content/uploads/2021/04/fda_write.png" alt="" width="1114" height="445" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/fda_write.png 1114w, https://abap-blog.ru/wp-content/uploads/2021/04/fda_write-300x120.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/fda_write-1024x409.png 1024w, https://abap-blog.ru/wp-content/uploads/2021/04/fda_write-768x307.png 768w" sizes="(max-width: 1114px) 100vw, 1114px" /></a></p>
<p>Есть ряд особенностей SQL запросов с внутренней таблицей как источником данных:</p>
<ul>
<li>Нельзя указать более одной таблицы в SQL запросе, JOIN двух внутренних таблиц сделать не выйдет. Нельзя использовать одну и ту же таблицу в запросе несколько раз, например с дополнением WITH.</li>
<li>Обязательно требуется указание псевдонима для внутренней таблицы через дополнение AS.</li>
<li>Тип строки таблицы может быть как элементарным, так и структурным:
<ul>
<li>Если строка элементарного типа, обращаться к столбцу этой таблицы можно через <strong>table_line</strong>. В списке полей для table_line можно задать псевдоним через AS. Тип таблицы в данном случае не может быть строкой (допустимо использование строк ссылающихся на словарный тип SSTRING) или ссылочным типом.</li>
<li>Если строка структурного типа, недопустимо обращение в SQL запросе к полям являющимися вложенными структурами, строками или таблицами.</li>
</ul>
</li>
<li>Если используется дополнение <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abaporderby_clause.htm#!ABAP_ALTERNATIVE_1@1@" target="_blank" rel="noopener">ORDER BY PRIMARY KEY</a> во внутренней таблице обязательно должен быть указан <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abenprimary_table_key_glosry.htm" target="_blank" rel="noopener">primary key</a>.</li>
<li>Нельзя при статическом указании таблицы во FROM использовать обобщённые типы таблиц (вроде INDEX TABLE). Обобщённые типы могут быть использованы при динамическом FROM. Пример:<br />
<pre class="urvanov-syntax-highlighter-plain-tag">CLASS lcl_test DEFINITION.
  PUBLIC SECTION.
    CLASS-METHODS:
      start,
      test IMPORTING it_table TYPE INDEX TABLE.
ENDCLASS.

CLASS lcl_test IMPLEMENTATION.

  METHOD test.
    DATA:
      lt_keys TYPE STANDARD TABLE OF sflight.

    SELECT connid, price, carrid
      FROM ('@it_table') AS sflight_tab
        INTO CORRESPONDING FIELDS OF TABLE @lt_keys.

    cl_demo_output=&gt;display( lt_keys ).
  ENDMETHOD.

ENDCLASS.</pre>
</li>
<li>Внутренняя таблица не может содержать столбцов со ссылкой на устаревшие типы данных: DF16_SCL и DF34_SCL.</li>
<li>Если внутренняя таблица имеет элементарный тип, при использовании <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abencommon_table_expression_glosry.htm" target="_blank" rel="noopener">CTE</a>, после WITH нельзя указывать поля через * или data_source~*.</li>
<li>Для внутренней таблицы необходимо указывать primary key явным образом, при использовании стандартного ключа (with default key) система выдаст предупреждение.</li>
</ul>
<p>Даже если таблица не будет перенесена на уровень СУБД, данные в ней обрабатываются так как же как и в СУБД:</p>
<ul>
<li>Строки со ссылкой на SSTRING обрабатываются как строки с фиксированной длинной и игнорированием завершающих пробелов.</li>
<li>SQL выражения работают таким же образом, как если бы они работали на уровне СУБД:
<ul>
<li>DIV и MOD могут выдавать отличные от аналогичных в ABAP результаты</li>
<li>Обработка NULL значений аналогична тому как это работает в SQL запросах.</li>
</ul>
</li>
<li>Таблица всегда рассматривается как независимая от манданта.</li>
</ul>
<h3>Примеры</h3>
<p>Следующий пример демонстрирует типичный случай использования внутренних таблиц как источника данных, а именно перенос таблицы на уровень СУБД и выполнение JOIN:</p><pre class="urvanov-syntax-highlighter-plain-tag">DATA lt_itab TYPE HASHED TABLE OF scarr
                 WITH UNIQUE KEY mandt carrid.

    IF NOT cl_abap_dbfeatures=&gt;use_features(
             EXPORTING
               requested_features =
                 VALUE #( ( cl_abap_dbfeatures=&gt;itabs_in_from_clause ) ) ).
      cl_demo_output=&gt;display(
        `Система не поддерживает внутренние таблицы как источник данных` ).
      RETURN.
    ENDIF.

    lt_itab =  VALUE #( ( carrid = 'LH' carrname = 'L.H.' )
                        ( carrid = 'UA' carrname = 'U.A.' ) ).

    SELECT scarr~carrid, scarr~carrname, spfli~connid
           FROM @lt_itab AS scarr
             INNER JOIN spfli ON scarr~carrid = spfli~carrid
           INTO TABLE @DATA(lt_result)
           ##db_feature_mode[itabs_in_from_clause] ##itab_db_select.</pre><p>Пример в котором не происходит обращения к СУБД:</p><pre class="urvanov-syntax-highlighter-plain-tag">TYPES:
      BEGIN OF ts_line,
        id     TYPE c LENGTH 1,
        number TYPE i,
      END OF ts_line.

    DATA lt_itab TYPE HASHED TABLE OF ts_line
                 WITH UNIQUE KEY id.

    DATA(lo_rnd) = cl_abap_random_int=&gt;create( seed = CONV i( sy-uzeit ) min = 1 max = 100 ).

    lt_itab = VALUE #(
      FOR i = 1 UNTIL i &gt; 25
      ( id = substring( val = sy-abcde off = i len = 1 )
        number = lo_rnd-&gt;get_next( ) ) ).

    SELECT *
      FROM @lt_itab AS numbers
      WHERE number &gt; 50
      ORDER BY id
      INTO TABLE @DATA(lt_result)
      ##db_feature_mode[itabs_in_from_clause] ##itab_db_select.

    cl_demo_output=&gt;display( lt_result ).</pre><p>Формирование результата элементарного типа (lt_result1) и структурного (lt_result2):</p><pre class="urvanov-syntax-highlighter-plain-tag">DATA lt_itab TYPE SORTED TABLE OF i WITH UNIQUE KEY table_line.
lt_itab =  VALUE #( ( 1 )
                    ( 2 )
                    ( 3 ) ).

DATA lt_result1 LIKE lt_itab.

SELECT table_line
       FROM @lt_itab AS numbers
       INTO TABLE @lt_result1.

cl_demo_output=&gt;write( lt_result1 ).

SELECT table_line AS number
       FROM @lt_itab AS numbers
       INTO TABLE @DATA(lt_result2).

cl_demo_output=&gt;display( lt_result2 ).</pre><p></p>
<h3>Производительность</h3>
<p>Если сравнивать скорость выполнения FAE с FDA и JOIN с внутренней таблицей, скорость работы <a href="https://blogs.sap.com/2019/03/31/compare-performance-between-select-for-all-entries-and-amdp/" target="_blank" rel="noopener">практически не отличается</a>, оба сценария выигрывают у сценария переноса внутренней таблицы через AMDP.</p>
<h3>Итого</h3>
<p>Подводя итоги, данный механизм выглядит вполне привлекательной заменой использования запросов с FOR ALL ENTRIES, если сравнивать с точки зрения накладываемых в обоих случаях ограничений и безопасности в части необходимости доп. проверок в коде при использовании FAE.</p><p>The post <a href="https://abap-blog.ru/osnovy-abap/internal-table-as-data-source-select/">Внутренние таблицы как источник в SQL запросах</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></content:encoded>
					
					<wfw:commentRss>https://abap-blog.ru/osnovy-abap/internal-table-as-data-source-select/feed/</wfw:commentRss>
			<slash:comments>1</slash:comments>
		
		
			</item>
		<item>
		<title>Динамические журнальные точки</title>
		<link>https://abap-blog.ru/osnovy-abap/dinamicheskie-zhurnalnye-tochki/</link>
					<comments>https://abap-blog.ru/osnovy-abap/dinamicheskie-zhurnalnye-tochki/#respond</comments>
		
		<dc:creator><![CDATA[Astrafox]]></dc:creator>
		<pubDate>Thu, 08 Apr 2021 13:52:18 +0000</pubDate>
				<category><![CDATA[Основы ABAP]]></category>
		<guid isPermaLink="false">https://abap-blog.ru/?p=7082</guid>

					<description><![CDATA[<p>В ABAP довольно таки давно существует функционал журнальных точек, который позволяет активировать запись в журнал (в тр. SAAB) определённых данных из программы. Для этого необходимо завести ключ (ID группы контрольных точек) и в коде использовать оператор LOG-POINT. Но что если необходимо поместить в журнал некоторые данные при выполнении программы, а менять код нельзя? Или необходимо [&#8230;]</p>
<p>The post <a href="https://abap-blog.ru/osnovy-abap/dinamicheskie-zhurnalnye-tochki/">Динамические журнальные точки</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></description>
										<content:encoded><![CDATA[<p>В ABAP довольно таки давно существует функционал журнальных точек, который позволяет активировать запись в журнал (в тр. SAAB) определённых данных из программы. Для этого необходимо завести ключ (ID группы контрольных точек) и в коде использовать оператор <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abaplog-point.htm" target="_blank" rel="noopener">LOG-POINT.</a></p>
<p>Но что если необходимо поместить в журнал некоторые данные при выполнении программы, а менять код нельзя? Или необходимо понять откуда конкретно вызывается анализируемый код?</p>
<p>Для этих целей начиная с ABAP 7.5 ввели так называемые динамические журнальные точки, которые позволяют:</p>
<ul>
<li>Сохранять значения переменных по определённым условиям</li>
<li>Записывать стек вызовов, чтобы понять откуда происходит вызов того или иного кода</li>
<li>Выполнять анализ выполнения отдельного SQL выражения</li>
<li>Активировать запись SQL трассировки для заданного выражения оп указанному условию</li>
<li>Активировать трассировку использования табличного буфера заданного SQL выражения для анализа потребляемой памяти</li>
</ul>
<p>Создавать или модифицировать журнальные точки можно либо через ADT (Eclipse), либо через транзакцию <strong>SDLP</strong>.</p>
<p>Далее на простых примерах рассмотрим вариант использования.</p>
<p><span id="more-7082"></span></p>
<h3>Полномочия</h3>
<p>Для работы с динамическими точками нужно иметь соответствующие полномочия &#8212; объект <strong>S_DYNLGPTS</strong>.</p>
<h3>Логирование простых переменных</h3>
<p>Под логированием простых переменных понимается возможность сохранения в журнал значений переменных элементарного типа (не ссылок, не структур и не табличных значений).</p>
<p>Рассмотрим пример кода:</p><pre class="urvanov-syntax-highlighter-plain-tag">START-OF-SELECTION.
  DATA(lo_rnd) = cl_abap_random_int=&gt;create( seed = CONV #( sy-uzeit )
                                             min  = 10
                                             max  = 100 ).

  DO 10 TIMES.
    DATA(lv_random_value) = lo_rnd-&gt;get_next( ).
  ENDDO.</pre><p>Каждый раз запуская отчёт генерируется произвольное значение. Зайдём в Eclipse и создадим точку, для этого перейдём на нужную нам строку кода и правой кнопкой по столбцу с номерами строк вызовем контекстное меню:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/create_log_pont.png"><img loading="lazy" class="alignnone size-full wp-image-7085" src="https://abap-blog.ru/wp-content/uploads/2021/04/create_log_pont.png" alt="" width="621" height="359" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/create_log_pont.png 621w, https://abap-blog.ru/wp-content/uploads/2021/04/create_log_pont-300x173.png 300w" sizes="(max-width: 621px) 100vw, 621px" /></a></p>
<p>Откроется экран создания (по умолчанию логирование простых переменных):</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/log_simple_variable_values.png"><img loading="lazy" class="alignnone size-full wp-image-7086" src="https://abap-blog.ru/wp-content/uploads/2021/04/log_simple_variable_values.png" alt="" width="537" height="662" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/log_simple_variable_values.png 537w, https://abap-blog.ru/wp-content/uploads/2021/04/log_simple_variable_values-243x300.png 243w" sizes="(max-width: 537px) 100vw, 537px" /></a></p>
<p><strong>Основные настройки</strong></p>
<ul>
<li>В разделе <strong>Location</strong> можно убедиться в корректности определения места вызова.</li>
<li>В разделе <strong>Activity</strong> нас интересует тип точки: <strong>Log Simple Variable Values</strong>.</li>
<li>В разделе<strong> Variable(s)</strong> можно определить набор переменных значения которых нужно записать в журнал. Имена переменных можно перечислить через запятую.</li>
<li>В разделе <strong>Conditions</strong> определяются условия запуска.</li>
<li>В разделе <strong>Description</strong> определяется имя журнальной точки.</li>
<li>В разделе <strong>Activation</strong> определяется:
<ul>
<li>Статус &#8212; по умолчанию активно</li>
<li>Для какого пользователя должна срабатывать точка</li>
<li>На каких серверах</li>
<li>Предел по времени, после которого точка деактивируется</li>
<li>Время хранения журналов</li>
<li>Максимальное число срабатывания на сессию</li>
</ul>
</li>
</ul>
<p>В разделе <strong>Optional Conditions</strong> можно задать простые условия для срабатывания точек:</p>
<div id="wrapper">
<div id="container">
<div class="body conbody">
<ul id="loioe5a4d03ceaa0419e9f1f075af0af6b9a__ul_rkc_sh5_fq" class="ul">
<li class="li">Стандартные операторы сравнения: <strong class="ph b"> EQ,=,NE,&lt;&gt;,&gt;&lt;,&lt;,LT,&gt;,GT,&lt;=,=&lt;,LE,&gt;=,=&lt;,GE</strong></li>
<li class="li">Операторы для анализа строк: <strong class="ph b">CO,CN,CA,NA,CS,NS,CP,NP</strong></li>
<li class="li">Унарные операторы: <strong class="ph b">IS INITIAL, IS BOUND, IS ASSIGNED</strong></li>
</ul>
<p>Примеры:</p><pre class="urvanov-syntax-highlighter-plain-tag">sy-subrc &lt;&gt; 0
" Или	
oref IS BOUND and oref-&gt;attr = `abc`
" Или	
( itab[1]-string IS INITIAL OR NOT itab[1]-string CO `0123456789` ) AND
( itab[2]-string IS INITIAL OR NOT itab[2]-string CO `0123456789` )</pre><p>Как видно из последнего примера, условия можно группировать используя скобки.</p>
</div>
</div>
</div>
<p>Созданная активная точка сразу же отображается (по аналогии с точкой прерывания) в редакторе кода:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/active_log_point.png"><img loading="lazy" class="alignnone size-full wp-image-7087" src="https://abap-blog.ru/wp-content/uploads/2021/04/active_log_point.png" alt="" width="601" height="126" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/active_log_point.png 601w, https://abap-blog.ru/wp-content/uploads/2021/04/active_log_point-300x63.png 300w" sizes="(max-width: 601px) 100vw, 601px" /></a></p>
<p>Так же во View <strong>Logpoints</strong>:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/logpoints_view.png"><img loading="lazy" class="alignnone size-full wp-image-7088" src="https://abap-blog.ru/wp-content/uploads/2021/04/logpoints_view.png" alt="" width="1360" height="158" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/logpoints_view.png 1360w, https://abap-blog.ru/wp-content/uploads/2021/04/logpoints_view-300x35.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/logpoints_view-1024x119.png 1024w, https://abap-blog.ru/wp-content/uploads/2021/04/logpoints_view-768x89.png 768w" sizes="(max-width: 1360px) 100vw, 1360px" /></a></p>
<p>И там и там она может быть удалена/активирована/изменена/деактивирована. Там же можно сбросить/очистить журнал.</p>
<p>Посмотреть журнал после выполнения отчёта можно в том же View, нажав на столбец <strong>Log Events </strong>предварительно обновив (по кнопке или нажав F5):</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/simple_view.png"><img loading="lazy" class="alignnone size-full wp-image-7089" src="https://abap-blog.ru/wp-content/uploads/2021/04/simple_view.png" alt="" width="1103" height="274" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/simple_view.png 1103w, https://abap-blog.ru/wp-content/uploads/2021/04/simple_view-300x75.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/simple_view-1024x254.png 1024w, https://abap-blog.ru/wp-content/uploads/2021/04/simple_view-768x191.png 768w" sizes="(max-width: 1103px) 100vw, 1103px" /></a></p>
<p>В качестве ключа журнальной точки у нас выступает значение переменной, как видно на картинке, значение 74 у нас было присвоено переменной два раза. Если в журнальной точке будет несколько переменных, в качестве ключа уже будет составной ключ из их значений:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/combined_key.png"><img loading="lazy" class="alignnone size-full wp-image-7099" src="https://abap-blog.ru/wp-content/uploads/2021/04/combined_key.png" alt="" width="660" height="253" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/combined_key.png 660w, https://abap-blog.ru/wp-content/uploads/2021/04/combined_key-300x115.png 300w" sizes="(max-width: 660px) 100vw, 660px" /></a></p>
<h3>Сохранение стека вызовов</h3>
<p>Иногда полезно узнать откуда был вызван тот или иной код, например: когда статически это выявить невозможно (динамические вызовы ФМ-ов или методов). Для этих целей служит следующий тип журнальных точек &#8212; <strong>Log Call Stack</strong>.</p>
<p>В качестве примера выставим такую точку в конструкторе ALV cl_gui_alv_grid:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/alv_call_stack.png"><img loading="lazy" class="alignnone size-full wp-image-7092" src="https://abap-blog.ru/wp-content/uploads/2021/04/alv_call_stack.png" alt="" width="736" height="552" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/alv_call_stack.png 736w, https://abap-blog.ru/wp-content/uploads/2021/04/alv_call_stack-300x225.png 300w" sizes="(max-width: 736px) 100vw, 736px" /></a></p>
<p>И откроем несколько раз SE16 и SE11 с просмотром данных в ALV. Журнал будет выглядеть примерно следующим образом:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/log_stack.png"><img loading="lazy" class="alignnone size-full wp-image-7093" src="https://abap-blog.ru/wp-content/uploads/2021/04/log_stack.png" alt="" width="1153" height="244" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/log_stack.png 1153w, https://abap-blog.ru/wp-content/uploads/2021/04/log_stack-300x63.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/log_stack-1024x217.png 1024w, https://abap-blog.ru/wp-content/uploads/2021/04/log_stack-768x163.png 768w" sizes="(max-width: 1153px) 100vw, 1153px" /></a></p>
<p>Я вызывал просмотр из SE16 и SE11 &#8212; два вызова, но запись одна.</p>
<p>Обратите внимание на ключ &#8212; в данном случае для каждого уникального стека вызовов генерируется хэш стека (функция STACK_HASH) и записывается в качестве ключа. Несмотря на запуск просмотра данных из SE16 и SE11 обе транзакции стартуют внутри себя просмотр через одну и ту же сгенерированную программу, именно её <a href="https://help.sap.com/doc/abapdocu_latest_index_htm/latest/en-US/abeninternal_session.htm" target="_blank" rel="noopener">internal session</a> стек и будет записан в журнал.</p>
<h3>Определяемые пользователем журнальные точки</h3>
<p>Наиболее гибким вариантом журнальных точек являются &#8212; <strong>User Defined Logging</strong>.</p>
<p>Основные отличия:</p>
<ul>
<li>Возможность определения ключа для журнала (при одинаковом значении ключа в журнале отображается последняя запись)</li>
<li>Возможность записи в журнал не только элементарных типов, но и структур и таблиц (не полностью).</li>
</ul>
<p>В качестве ключа не следует использовать таблицы, ссылочные переменные или глубокие структуры, т.к. они не могут быть преобразованы к типу string, который используется как тип ключа.</p>
<p>Допустим мы захотели записать в журнал данные по всем отображаемым в ALV таблицам, для этого перейдём в ФМ REUSE_ALV_GRID_DISPLAY и сразу на входе создадим следующую журнальную точку:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/user_defined_logs.png"><img loading="lazy" class="alignnone size-full wp-image-7101" src="https://abap-blog.ru/wp-content/uploads/2021/04/user_defined_logs.png" alt="" width="511" height="609" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/user_defined_logs.png 511w, https://abap-blog.ru/wp-content/uploads/2021/04/user_defined_logs-252x300.png 252w" sizes="(max-width: 511px) 100vw, 511px" /></a></p>
<p>Запустим например в SE11 на просмотр таблицу SBOOK и SFLIGHT, после чего в журнале обнаружим следующий результат:</p>
<p><a href="https://abap-blog.ru/wp-content/uploads/2021/04/table_rows.png"><img loading="lazy" class="alignnone size-full wp-image-7102" src="https://abap-blog.ru/wp-content/uploads/2021/04/table_rows.png" alt="" width="1024" height="373" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/table_rows.png 1024w, https://abap-blog.ru/wp-content/uploads/2021/04/table_rows-300x109.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/table_rows-768x280.png 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<p>В данной точке мы использовали встроенные функции для формирования ключа:</p>
<ul>
<li><strong>REQ_TYPE</strong> &#8212; позволяет определить тип входной точки (RFC, SUBMIT, HTTP запрос и т.п.)</li>
<li><strong>REQ_ENTRYPOINT</strong> &#8212; имя входной точки (отчёт, RFC модуль и т.п.)</li>
<li><strong>LINES</strong> &#8212; подсчёт количества строк в таблице</li>
</ul>
<p>В качестве значения пожелали увидеть значения в таблице. Но т.к. размер хранимых значений ограничен базисным параметром <strong>abap/aab_log_field_size_limit</strong>, строки вывелись не все.</p>
<h3>SQL трассировка</h3>
<p>Для того чтобы снять трассировку нужного запроса с возможностью определения условий можно воспользоваться отдельным типом журнальных точек &#8212; <strong>SQL Trace For Current Statement</strong>.</p>
<p>Как понятно из названия, необходимо выставить данный тип точки на SQL запросе и в момент его обработки будет включена трассировка в транзакции ST05 после выполнения автоматически отключена.</p>
<p>После формирования журнала двойной щелчок по нему приведёт к открытию транзакции ST05.</p>
<h3>Встроенные функции</h3>
<p>Ранее мы уже рассмотрели ряд встроенных функций в управление журнальными точками, рассмотрим кратко другие:</p>
<div id="wrapper">
<div id="container">
<div class="body refbody">
<div class="section">
<ul>
<li class="p"><strong>INEXACT_DF</strong>() &#8212; предоставляет информацию о точности выполнения арифметической операции с типами DECFLOAT16/34 (Не представляю чтобы мне это понадобилось <img src="https://s.w.org/images/core/emoji/13.1.0/72x72/1f601.png" alt="😁" class="wp-smiley" style="height: 1em; max-height: 1em;" />)</li>
<li class="p"><strong>SQL_TRACE</strong>( StackOn|StackOff ) &#8212; позволяет активировать в указанной точке SQL трассировку либо с записью ABAP стека, либо без. После прохода выражения на котором выставляется трейс (SQL запроса) запись трассировки отключается. Результат можно посмотреть в транзакции ST05.</li>
<li class="p"><strong>STACK</strong>( ) &#8212; получает стек в виде строки</li>
<li class="p"><strong>STACK_HASH</strong>( ) &#8212; получает base64 от стека в виде строки</li>
<li class="p"><strong>STRLEN</strong>( &lt;arg&gt; ) &#8212; размер строки</li>
<li class="p"><strong>SYSTEM_INFO</strong>( ) &#8212; получение системной информации. В качестве аргументов могут быть:
<ul>
<li>&#8216;A&#8217; : Имя текущего сервера приложений</li>
<li>&#8216;T&#8217; : Полный UTC Time stamp</li>
<li>&#8216;t&#8217; : Сокращённый UTS Time stamp</li>
</ul>
</li>
<li><strong>TABLEBUF_TRACE</strong>( StackOn|StackOff ) &#8212; Аналогичен SQL_TRACE но для трассировки использования табличного буфера</li>
<li><strong>XSTRLEN</strong>( &lt;arg&gt; ) &#8212; размер строки для XSTRING и X</li>
<li class="p"><strong>_DEBUG_INFO</strong>() &#8212; для внутреннего использования SAP-ом, выдаёт всякую интересную информацию:<a href="https://abap-blog.ru/wp-content/uploads/2021/04/debug_info.png"><img loading="lazy" class="alignnone size-full wp-image-7103" src="https://abap-blog.ru/wp-content/uploads/2021/04/debug_info.png" alt="" width="1164" height="584" srcset="https://abap-blog.ru/wp-content/uploads/2021/04/debug_info.png 1164w, https://abap-blog.ru/wp-content/uploads/2021/04/debug_info-300x151.png 300w, https://abap-blog.ru/wp-content/uploads/2021/04/debug_info-1024x514.png 1024w, https://abap-blog.ru/wp-content/uploads/2021/04/debug_info-768x385.png 768w" sizes="(max-width: 1164px) 100vw, 1164px" /></a></li>
<li class="p"><strong>_SET_DEVTRACE</strong>(&lt;trace_activation&gt;) &#8212; опять же для внутреннего использования, управляет параметрами <strong>rdisp/TRACE</strong> и <strong>rdisp/TRACE_COMPS</strong></li>
</ul>
</div>
</div>
</div>
</div>
<p>Более подробную документацию по каждой функции вы можете найти в документации к ADT (Eclipse).</p>
<h3>Дополнительно</h3>
<ul>
<li>Отчёт<strong> RS_DLP_ANALYZE_CONDITION_LOAD</strong> &#8212; позволяет проверить условия на ошибки (если в ADT не ясно с чем связана ошибка проверки условия), проанализировать LOAD существующего в БД или введенного вручную условия.</li>
<li>Проверка на авторизацию осуществляется в классе <strong>CL_DLP_AUTHORITY</strong>, на случай если хотите пропустить.</li>
</ul><p>The post <a href="https://abap-blog.ru/osnovy-abap/dinamicheskie-zhurnalnye-tochki/">Динамические журнальные точки</a> first appeared on <a href="https://abap-blog.ru">ABAP Blog</a>.</p>]]></content:encoded>
					
					<wfw:commentRss>https://abap-blog.ru/osnovy-abap/dinamicheskie-zhurnalnye-tochki/feed/</wfw:commentRss>
			<slash:comments>0</slash:comments>
		
		
			</item>
	</channel>
</rss>
